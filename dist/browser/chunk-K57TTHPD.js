import{a as n}from"./chunk-E6ENPQNB.js";import{v as c}from"./chunk-6CPQKJQE.js";import{Y as r,aa as a,ga as l,p as i}from"./chunk-BTAKDWI7.js";import{g as o}from"./chunk-TSRGIXR5.js";var g=(()=>{class s{constructor(){this._httpClient=l(c),this._sessionToken=null}getSessionToken(){return this._sessionToken||(this._sessionToken=localStorage.getItem("sessionToken")),this._sessionToken}setSessionToken(e){this._sessionToken=e,localStorage.setItem("sessionToken",e)}clearSessionToken(){this._sessionToken=null,localStorage.removeItem("sessionToken")}createSession(e){return this._httpClient.post(`${n.apiUrl}/api/sessions`,e).pipe(r(t=>{t&&t.data&&t.data.token&&(this.setSessionToken(t.data.token),console.log("Session token stored:",t.data.token.substring(0,20)+"..."))}))}getPublicKey(e){return this._httpClient.get(`${n.apiUrl}/api/sessions/yek-cilbup`,{params:e})}decryptContent(e){return this._httpClient.post(`${n.apiUrl}/api/sessions/decrypt-content`,e)}generateSessionIdentifier(){let e=Date.now(),t=Math.random().toString(36).substring(2,9);return`session_${e}_${t}`}hasSessionToken(){return!!this.getSessionToken()}initializePaymentSession(){return o(this,null,function*(){if(this.hasSessionToken())return console.log("Existing session token found"),null;try{let e=this.generateSessionIdentifier();console.log("Creating new session with identifier:",e);let t=yield i(this.createSession({identifier:e,isWebExtension:!1,type:"general"}));return console.log("Session created:",t),t||null}catch(e){return console.error("Failed to create session:",e),null}})}static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275prov=a({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{g as a};
