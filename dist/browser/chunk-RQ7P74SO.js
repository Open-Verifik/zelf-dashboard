import{v as Bo,y as Io}from"./chunk-PJUNJER2.js";import{aa as Eo,fa as vo}from"./chunk-UOZRKCH4.js";import{a as ue,b as gt,d as ei,g as I}from"./chunk-TSRGIXR5.js";var Te=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function c0(n,e){return e.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(t){if(t!=="default"&&!(t in n)){var i=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return r[t]}})}})}),Object.freeze(n)}var Gr=Symbol("doneWritingPromise"),ac=Symbol("doneWritingResolve"),oc=Symbol("doneWritingReject"),hn=Symbol("readingIndex"),nt=class n extends Array{constructor(){super(),Object.setPrototypeOf(this,n.prototype),this[Gr]=new Promise((e,r)=>{this[ac]=e,this[oc]=r}),this[Gr].catch(()=>{})}};function Ee(n){return n&&n.getReader&&Array.isArray(n)}function kn(n){if(!Ee(n)){let e=n.getWriter(),r=e.releaseLock;return e.releaseLock=()=>{e.closed.catch(function(){}),r.call(e)},e}this.stream=n}function Ye(n){if(Ee(n))return"array";if(Te.ReadableStream&&Te.ReadableStream.prototype.isPrototypeOf(n))return"web";if(n&&!(Te.ReadableStream&&n instanceof Te.ReadableStream)&&typeof n._read=="function"&&typeof n._readableState=="object")throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!n||!n.getReader)&&"web-like"}function ls(n){return Uint8Array.prototype.isPrototypeOf(n)}function cc(n){if(n.length===1)return n[0];let e=0;for(let i=0;i<n.length;i++){if(!ls(n[i]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");e+=n[i].length}let r=new Uint8Array(e),t=0;return n.forEach(function(i){r.set(i,t),t+=i.length}),r}nt.prototype.getReader=function(){return this[hn]===void 0&&(this[hn]=0),{read:()=>I(this,null,function*(){return yield this[Gr],this[hn]===this.length?{value:void 0,done:!0}:{value:this[this[hn]++],done:!1}})}},nt.prototype.readToEnd=function(n){return I(this,null,function*(){yield this[Gr];let e=n(this.slice(this[hn]));return this.length=0,e})},nt.prototype.clone=function(){let n=new nt;return n[Gr]=this[Gr].then(()=>{n.push(...this)}),n},kn.prototype.write=function(n){return I(this,null,function*(){this.stream.push(n)})},kn.prototype.close=function(){return I(this,null,function*(){this.stream[ac]()})},kn.prototype.abort=function(n){return I(this,null,function*(){return this.stream[oc](n),n})},kn.prototype.releaseLock=function(){},typeof Te.process=="object"&&Te.process.versions;var So=new WeakSet,ae=Symbol("externalBuffer");function At(n){if(this.stream=n,n[ae]&&(this[ae]=n[ae].slice()),Ee(n)){let r=n.getReader();return this._read=r.read.bind(r),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(Ye(n)){let r=n.getReader();return this._read=r.read.bind(r),this._releaseLock=()=>{r.closed.catch(function(){}),r.releaseLock()},void(this._cancel=r.cancel.bind(r))}let e=!1;this._read=()=>I(this,null,function*(){return e||So.has(n)?{value:void 0,done:!0}:(e=!0,{value:n,done:!1})}),this._releaseLock=()=>{if(e)try{So.add(n)}catch{}}}function Za(n){return Ye(n)?n:new ReadableStream({start(e){e.enqueue(n),e.close()}})}function uc(n){if(Ye(n))return n;let e=new nt;return I(null,null,function*(){let r=st(e);yield r.write(n),yield r.close()}),e}function $e(n){return n.some(e=>Ye(e)&&!Ee(e))?function(e){e=e.map(Za);let r=fc(function(s){return I(this,null,function*(){yield Promise.all(i.map(a=>na(a,s)))})}),t=Promise.resolve(),i=e.map((s,a)=>Dr(s,(o,c)=>(t=t.then(()=>en(o,r.writable,{preventClose:a!==e.length-1})),t)));return r.readable}(n):n.some(e=>Ee(e))?function(e){let r=new nt,t=Promise.resolve();return e.forEach((i,s)=>(t=t.then(()=>en(i,r,{preventClose:s!==e.length-1})),t)),r}(n):typeof n[0]=="string"?n.join(""):cc(n)}function en(s,a){return I(this,arguments,function*(n,e,{preventClose:r=!1,preventAbort:t=!1,preventCancel:i=!1}={}){if(Ye(n)&&!Ee(n)){n=Za(n);try{if(n[ae]){let f=st(e);for(let h=0;h<n[ae].length;h++)yield f.ready,yield f.write(n[ae][h]);f.releaseLock()}yield n.pipeTo(e,{preventClose:r,preventAbort:t,preventCancel:i})}catch{}return}let o=Gt(n=uc(n)),c=st(e);try{for(;;){yield c.ready;let{done:f,value:h}=yield o.read();if(f){r||(yield c.close());break}yield c.write(h)}}catch(f){t||(yield c.abort(f))}finally{o.releaseLock(),c.releaseLock()}})}function hc(n,e){let r=new TransformStream(e);return en(n,r.writable),r.readable}function fc(n){let e,r,t,i=!1,s=!1;return{readable:new ReadableStream({start(o){t=o},pull(){e?e():i=!0},cancel(o){return I(this,null,function*(){s=!0,n&&(yield n(o)),r&&r(o)})}},{highWaterMark:0}),writable:new WritableStream({write:function(o){return I(this,null,function*(){if(s)throw Error("Stream is cancelled");t.enqueue(o),i?i=!1:(yield new Promise((c,f)=>{e=c,r=f}),e=null,r=null)})},close:t.close.bind(t),abort:t.error.bind(t)})}}function me(n,e=()=>{},r=()=>{}){if(Ee(n)){let a=new nt;return I(null,null,function*(){let o=st(a);try{let c=yield De(n),f=e(c),h=r(),u;u=f!==void 0&&h!==void 0?$e([f,h]):f!==void 0?f:h,yield o.write(u),yield o.close()}catch(c){yield o.abort(c)}}),a}if(Ye(n))return hc(n,{transform(a,o){return I(this,null,function*(){try{let c=yield e(a);c!==void 0&&o.enqueue(c)}catch(c){o.error(c)}})},flush(a){return I(this,null,function*(){try{let o=yield r();o!==void 0&&a.enqueue(o)}catch(o){a.error(o)}})}});let t=e(n),i=r();return t!==void 0&&i!==void 0?$e([t,i]):t!==void 0?t:i}function Dr(n,e){if(Ye(n)&&!Ee(n)){let t,i=new TransformStream({start(o){t=o}}),s=en(n,i.writable),a=fc(function(o){return I(this,null,function*(){t.error(o),yield s,yield new Promise(setTimeout)})});return e(i.readable,a.writable),a.readable}n=uc(n);let r=new nt;return e(n,r),r}function Ja(n,e){let r,t=Dr(n,(i,s)=>{let a=Gt(i);a.remainder=()=>(a.releaseLock(),en(i,s),t),r=e(a)});return r}function Rn(n){if(Ee(n))return n.clone();if(Ye(n)){let e=function(r){if(Ee(r))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(Ye(r)){let t=Za(r).tee();return t[0][ae]=t[1][ae]=r[ae],t}return[Pe(r),Pe(r)]}(n);return lc(n,e[0]),e[1]}return Pe(n)}function xn(n){return Ee(n)?Rn(n):Ye(n)?new ReadableStream({start(e){let r=Dr(n,(t,i)=>I(null,null,function*(){let s=Gt(t),a=st(i);try{for(;;){yield a.ready;let{done:o,value:c}=yield s.read();if(o){try{e.close()}catch{}return void(yield a.close())}try{e.enqueue(c)}catch{}yield a.write(c)}}catch(o){e.error(o),yield a.abort(o)}}));lc(n,r)}}):Pe(n)}function lc(n,e){Object.entries(Object.getOwnPropertyDescriptors(n.constructor.prototype)).forEach(([r,t])=>{r!=="constructor"&&(t.value?t.value=t.value.bind(e):t.get=t.get.bind(e),Object.defineProperty(n,r,t))})}function Pe(n,e=0,r=1/0){if(Ee(n))throw Error("Not implemented");if(Ye(n)){if(e>=0&&r>=0){let t=0;return hc(n,{transform(i,s){t<r?(t+i.length>=e&&s.enqueue(Pe(i,Math.max(e-t,0),r-t)),t+=i.length):s.terminate()}})}if(e<0&&(r<0||r===1/0)){let t=[];return me(n,i=>{i.length>=-e?t=[i]:t.push(i)},()=>Pe($e(t),e,r))}if(e===0&&r<0){let t;return me(n,i=>{let s=t?$e([t,i]):i;if(s.length>=-r)return t=Pe(s,r),Pe(s,e,r);t=s})}return console.warn(`stream.slice(input, ${e}, ${r}) not implemented efficiently.`),xr(()=>I(null,null,function*(){return Pe(yield De(n),e,r)}))}return n[ae]&&(n=$e(n[ae].concat([n]))),ls(n)?n.subarray(e,r===1/0?n.length:r):n.slice(e,r)}function De(r){return I(this,arguments,function*(n,e=$e){return Ee(n)?n.readToEnd(e):Ye(n)?Gt(n).readToEnd(e):n})}function na(n,e){return I(this,null,function*(){if(Ye(n)){if(n.cancel){let r=yield n.cancel(e);return yield new Promise(setTimeout),r}if(n.destroy)return n.destroy(e),yield new Promise(setTimeout),e}})}function xr(n){let e=new nt;return I(null,null,function*(){let r=st(e);try{yield r.write(yield n()),yield r.close()}catch(t){yield r.abort(t)}}),e}function Gt(n){return new At(n)}function st(n){return new kn(n)}At.prototype.read=function(){return I(this,null,function*(){return this[ae]&&this[ae].length?{done:!1,value:this[ae].shift()}:this._read()})},At.prototype.releaseLock=function(){this[ae]&&(this.stream[ae]=this[ae]),this._releaseLock()},At.prototype.cancel=function(n){return this._cancel(n)},At.prototype.readLine=function(){return I(this,null,function*(){let n,e=[];for(;!n;){let{done:r,value:t}=yield this.read();if(t+="",r)return e.length?$e(e):void 0;let i=t.indexOf(`
`)+1;i&&(n=$e(e.concat(t.substr(0,i))),e=[]),i!==t.length&&e.push(t.substr(i))}return this.unshift(...e),n})},At.prototype.readByte=function(){return I(this,null,function*(){let{done:n,value:e}=yield this.read();if(n)return;let r=e[0];return this.unshift(Pe(e,1)),r})},At.prototype.readBytes=function(n){return I(this,null,function*(){let e=[],r=0;for(;;){let{done:t,value:i}=yield this.read();if(t)return e.length?$e(e):void 0;if(e.push(i),r+=i.length,r>=n){let s=$e(e);return this.unshift(Pe(s,n)),Pe(s,0,n)}}})},At.prototype.peekBytes=function(n){return I(this,null,function*(){let e=yield this.readBytes(n);return this.unshift(e),e})},At.prototype.unshift=function(...n){this[ae]||(this[ae]=[]),n.length===1&&ls(n[0])&&this[ae].length&&n[0].length&&this[ae][0].byteOffset>=n[0].length?this[ae][0]=new Uint8Array(this[ae][0].buffer,this[ae][0].byteOffset-n[0].length,this[ae][0].byteLength+n[0].length):this[ae].unshift(...n.filter(e=>e&&e.length))},At.prototype.readToEnd=function(){return I(this,arguments,function*(n=$e){let e=[];for(;;){let{done:r,value:t}=yield this.read();if(r)break;e.push(t)}return n(e)})};var fn=Symbol("byValue"),l={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(n,e){if(typeof e=="number"&&(e=this.read(n,e)),n[e]!==void 0)return n[e];throw Error("Invalid enum value.")},read:function(n,e){if(n[fn]||(n[fn]=[],Object.entries(n).forEach(([r,t])=>{n[fn][t]=r})),n[fn][e]!==void 0)return n[fn][e];throw Error("Invalid enum value.")}},q={preferredHashAlgorithm:l.hash.sha512,preferredSymmetricAlgorithm:l.symmetric.aes256,preferredCompressionAlgorithm:l.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:l.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:l.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([l.symmetric.aes128,l.symmetric.aes192,l.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,enforceGrammar:!0,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.2.2",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([l.hash.md5,l.hash.ripemd]),rejectMessageHashAlgorithms:new Set([l.hash.md5,l.hash.ripemd,l.hash.sha1]),rejectPublicKeyAlgorithms:new Set([l.publicKey.elgamal,l.publicKey.dsa]),rejectCurves:new Set([l.curve.secp256k1])},Ko=(()=>{try{return!1}catch{}return!1})(),d={isString:function(n){return typeof n=="string"||n instanceof String},nodeRequire:()=>{},isArray:function(n){return n instanceof Array},isUint8Array:ls,isStream:Ye,getNobleCurve:(n,e)=>I(null,null,function*(){if(!q.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");let{nobleCurves:r}=yield Promise.resolve().then(function(){return Xu});switch(n){case l.publicKey.ecdh:case l.publicKey.ecdsa:{let t=r.get(e);if(!t)throw Error("Unsupported curve");return t}case l.publicKey.x448:return r.get("x448");case l.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}}),readNumber:function(n){let e=0;for(let r=0;r<n.length;r++)e+=256**r*n[n.length-1-r];return e},writeNumber:function(n,e){let r=new Uint8Array(e);for(let t=0;t<e;t++)r[t]=n>>8*(e-t-1)&255;return r},readDate:function(n){let e=d.readNumber(n);return new Date(1e3*e)},writeDate:function(n){let e=Math.floor(n.getTime()/1e3);return d.writeNumber(e,4)},normalizeDate:function(n=Date.now()){return n===null||n===1/0?n:new Date(1e3*Math.floor(+n/1e3))},readMPI:function(n){let e=(n[0]<<8|n[1])+7>>>3;return d.readExactSubarray(n,2,2+e)},readExactSubarray:function(n,e,r){if(n.length<r-e)throw Error("Input array too short");return n.subarray(e,r)},leftPad(n,e){if(n.length>e)throw Error("Input array too long");let r=new Uint8Array(e),t=e-n.length;return r.set(n,t),r},uint8ArrayToMPI:function(n){let e=d.uint8ArrayBitLength(n);if(e===0)throw Error("Zero MPI");let r=n.subarray(n.length-Math.ceil(e/8)),t=new Uint8Array([(65280&e)>>8,255&e]);return d.concatUint8Array([t,r])},uint8ArrayBitLength:function(n){let e;for(e=0;e<n.length&&n[e]===0;e++);if(e===n.length)return 0;let r=n.subarray(e);return 8*(r.length-1)+d.nbits(r[0])},hexToUint8Array:function(n){let e=new Uint8Array(n.length>>1);for(let r=0;r<n.length>>1;r++)e[r]=parseInt(n.substr(r<<1,2),16);return e},uint8ArrayToHex:function(n){let e="0123456789abcdef",r="";return n.forEach(t=>{r+=e[t>>4]+e[15&t]}),r},stringToUint8Array:function(n){return me(n,e=>{if(!d.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");let r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r})},uint8ArrayToString:function(n){let e=[],t=(n=new Uint8Array(n)).length;for(let i=0;i<t;i+=16384)e.push(String.fromCharCode.apply(String,n.subarray(i,i+16384<t?i+16384:t)));return e.join("")},encodeUTF8:function(n){let e=new TextEncoder("utf-8");function r(t,i=!1){return e.encode(t,{stream:!i})}return me(n,r,()=>r("",!0))},decodeUTF8:function(n){let e=new TextDecoder("utf-8");function r(t,i=!1){return e.decode(t,{stream:!i})}return me(n,r,()=>r(new Uint8Array,!0))},concat:$e,concatUint8Array:cc,equalsUint8Array:function(n,e){if(!d.isUint8Array(n)||!d.isUint8Array(e))throw Error("Data must be in the form of a Uint8Array");if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(n[r]!==e[r])return!1;return!0},findLastIndex:function(n,e){for(let r=n.length;r>=0;r--)if(e(n[r],r,n))return r;return-1},writeChecksum:function(n){let e=0;for(let r=0;r<n.length;r++)e=e+n[r]&65535;return d.writeNumber(e,2)},printDebug:function(n){Ko&&console.log("[OpenPGP.js debug]",n)},printDebugError:function(n){Ko&&console.error("[OpenPGP.js debug]",n)},nbits:function(n){let e=1,r=n>>>16;return r!==0&&(n=r,e+=16),r=n>>8,r!==0&&(n=r,e+=8),r=n>>4,r!==0&&(n=r,e+=4),r=n>>2,r!==0&&(n=r,e+=2),r=n>>1,r!==0&&(n=r,e+=1),e},double:function(n){let e=new Uint8Array(n.length),r=n.length-1;for(let t=0;t<r;t++)e[t]=n[t]<<1^n[t+1]>>7;return e[r]=n[r]<<1^135*(n[0]>>7),e},shiftRight:function(n,e){if(e)for(let r=n.length-1;r>=0;r--)n[r]>>=e,r>0&&(n[r]|=n[r-1]<<8-e);return n},getWebCrypto:function(){let n=Te!==void 0&&Te.crypto&&Te.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!n)throw Error("The WebCrypto API is not available");return n},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(n){return d.isString(n)?/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(n):!1},canonicalizeEOL:function(n){let e=!1;return me(n,r=>{let t;e&&(r=d.concatUint8Array([new Uint8Array([13]),r])),r[r.length-1]===13?(e=!0,r=r.subarray(0,-1)):e=!1;let i=[];for(let o=0;t=r.indexOf(10,o)+1,t;o=t)r[t-2]!==13&&i.push(t);if(!i.length)return r;let s=new Uint8Array(r.length+i.length),a=0;for(let o=0;o<i.length;o++){let c=r.subarray(i[o-1]||0,i[o]);s.set(c,a),a+=c.length,s[a-1]=13,s[a]=10,a++}return s.set(r.subarray(i[i.length-1]||0),a),s},()=>e?new Uint8Array([13]):void 0)},nativeEOL:function(n){let e=!1;return me(n,r=>{let t;(r=e&&r[0]!==10?d.concatUint8Array([new Uint8Array([13]),r]):new Uint8Array(r))[r.length-1]===13?(e=!0,r=r.subarray(0,-1)):e=!1;let i=0;for(let s=0;s!==r.length;s=t){t=r.indexOf(13,s)+1,t||(t=r.length);let a=t-(r[t]===10?1:0);s&&r.copyWithin(i,s,a),i+=a-s}return r.subarray(0,i)},()=>e?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(n){return n.split(`
`).map(e=>{let r=e.length-1;for(;r>=0&&(e[r]===" "||e[r]==="	"||e[r]==="\r");r--);return e.substr(0,r+1)}).join(`
`)},wrapError:function(n,e){if(!e)return n instanceof Error?n:Error(n);if(n instanceof Error){try{n.message+=": "+e.message,n.cause=e}catch{}return n}return Error(n+": "+e.message,{cause:e})},constructAllowedPackets:function(n){let e={};return n.forEach(r=>{if(!r.tag)throw Error("Invalid input: expected a packet class");e[r.tag]=r}),e},anyPromise:function(n){return new Promise((e,r)=>I(null,null,function*(){let t;yield Promise.all(n.map(i=>I(null,null,function*(){try{e(yield i)}catch(s){t=s}}))),r(t)}))},selectUint8Array:function(n,e,r){let t=Math.max(e.length,r.length),i=new Uint8Array(t),s=0;for(let a=0;a<i.length;a++)i[a]=e[a]&256-n|r[a]&255+n,s+=n&a<e.length|1-n&a<r.length;return i.subarray(0,s)},selectUint8:function(n,e,r){return e&256-n|r&255+n},isAES:function(n){return n===l.symmetric.aes128||n===l.symmetric.aes192||n===l.symmetric.aes256}},Cs=d.getNodeBuffer(),Ii,Si;function Mt(n){let e=new Uint8Array;return me(n,r=>{e=d.concatUint8Array([e,r]);let t=[],i=Math.floor(e.length/45),s=45*i,a=Ii(e.subarray(0,s));for(let o=0;o<i;o++)t.push(a.substr(60*o,60)),t.push(`
`);return e=e.subarray(s),t.join("")},()=>e.length?Ii(e)+`
`:"")}function yc(n){let e="";return me(n,r=>{e+=r;let t=0,i=[" ","	","\r",`
`];for(let o=0;o<i.length;o++){let c=i[o];for(let f=e.indexOf(c);f!==-1;f=e.indexOf(c,f+1))t++}let s=e.length;for(;s>0&&(s-t)%4!=0;s--)i.includes(e[s])&&t--;let a=Si(e.substr(0,s));return e=e.substr(s),a},()=>Si(e))}function Ge(n){return yc(n.replace(/-/g,"+").replace(/_/g,"/"))}function Ue(n,e){let r=Mt(n).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function u0(n){let e=n.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!e)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(e[1])?l.armor.multipartSection:/MESSAGE, PART \d+/.test(e[1])?l.armor.multipartLast:/SIGNED MESSAGE/.test(e[1])?l.armor.signed:/MESSAGE/.test(e[1])?l.armor.message:/PUBLIC KEY BLOCK/.test(e[1])?l.armor.publicKey:/PRIVATE KEY BLOCK/.test(e[1])?l.armor.privateKey:/SIGNATURE/.test(e[1])?l.armor.signature:void 0}function lr(n,e){let r="";return e.showVersion&&(r+="Version: "+e.versionString+`
`),e.showComment&&(r+="Comment: "+e.commentString+`
`),n&&(r+="Comment: "+n+`
`),r+=`
`,r}function yr(n){let e=function(r){let t=13501623;return me(r,i=>{let s=h0?Math.floor(i.length/4):0,a=new Uint32Array(i.buffer,i.byteOffset,s);for(let o=0;o<s;o++)t^=a[o],t=Ke[0][t>>24&255]^Ke[1][t>>16&255]^Ke[2][t>>8&255]^Ke[3][255&t];for(let o=4*s;o<i.length;o++)t=t>>8^Ke[0][255&t^i[o]]},()=>new Uint8Array([t,t>>8,t>>16]))}(n);return Mt(e)}Cs?(Ii=n=>Cs.from(n).toString("base64"),Si=n=>{let e=Cs.from(n,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}):(Ii=n=>btoa(d.uint8ArrayToString(n)),Si=n=>d.stringToUint8Array(atob(n)));var Ke=[Array(255),Array(255),Array(255),Array(255)];for(let n=0;n<=255;n++){let e=n<<16;for(let r=0;r<8;r++)e=e<<1^(8388608&e?8801531:0);Ke[0][n]=(16711680&e)>>16|65280&e|(255&e)<<16}for(let n=0;n<=255;n++)Ke[1][n]=Ke[0][n]>>8^Ke[0][255&Ke[0][n]];for(let n=0;n<=255;n++)Ke[2][n]=Ke[1][n]>>8^Ke[0][255&Ke[1][n]];for(let n=0;n<=255;n++)Ke[3][n]=Ke[2][n]>>8^Ke[0][255&Ke[2][n]];var h0=function(){let n=new ArrayBuffer(2);return new DataView(n).setInt16(0,255,!0),new Int16Array(n)[0]===255}();function Co(n){for(let e=0;e<n.length;e++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(n[e])||d.printDebugError(Error("Improperly formatted armor header: "+n[e])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(n[e])||d.printDebugError(Error("Unknown header: "+n[e]))}function f0(n){let e=n,r=n.lastIndexOf("=");return r>=0&&r!==n.length-1&&(e=n.slice(0,r)),e}function Xa(n){return new Promise((e,r)=>I(null,null,function*(){try{let t=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/,s,a=[],o,c,f=a,h=[],u=yc(Dr(n,(y,g)=>I(null,null,function*(){let p=Gt(y);try{for(;;){let A=yield p.readLine();if(A===void 0)throw Error("Misformed armored text");if(A=d.removeTrailingSpaces(A.replace(/[\r\n]/g,"")),s)if(o)c||s!==l.armor.signed||(t.test(A)?(h=h.join(`\r
`),c=!0,Co(f),f=[],o=!1):h.push(A.replace(/^- /,"")));else if(t.test(A)&&r(Error("Mandatory blank line missing between armor headers and armor data")),i.test(A)){if(Co(f),o=!0,c||s!==l.armor.signed){e({text:h,data:u,headers:a,type:s});break}}else f.push(A);else t.test(A)&&(s=u0(A))}}catch(A){return void r(A)}let w=st(g);try{for(;;){yield w.ready;let{done:A,value:k}=yield p.read();if(A)throw Error("Misformed armored text");let S=k+"";if(S.indexOf("=")!==-1||S.indexOf("-")!==-1){let m=yield p.readToEnd();m.length||(m=""),m=S+m,m=d.removeTrailingSpaces(m.replace(/\r/g,""));let E=m.split(t);if(E.length===1)throw Error("Misformed armored text");let D=f0(E[0].slice(0,-1));yield w.write(D);break}yield w.write(S)}yield w.ready,yield w.close()}catch(A){yield w.abort(A)}})))}catch(t){r(t)}})).then(e=>I(null,null,function*(){return Ee(e.data)&&(e.data=yield De(e.data)),e}))}function Yn(n,e,r,t,i,s=!1,a=q){let o,c;n===l.armor.signed&&(o=e.text,c=e.hash,e=e.data);let f=s&&xn(e),h=[];switch(n){case l.armor.multipartSection:h.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+t+`-----
`),h.push(lr(i,a)),h.push(Mt(e)),f&&h.push("=",yr(f)),h.push("-----END PGP MESSAGE, PART "+r+"/"+t+`-----
`);break;case l.armor.multipartLast:h.push("-----BEGIN PGP MESSAGE, PART "+r+`-----
`),h.push(lr(i,a)),h.push(Mt(e)),f&&h.push("=",yr(f)),h.push("-----END PGP MESSAGE, PART "+r+`-----
`);break;case l.armor.signed:h.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),h.push(c?`Hash: ${c}

`:`
`),h.push(o.replace(/^-/gm,"- -")),h.push(`
-----BEGIN PGP SIGNATURE-----
`),h.push(lr(i,a)),h.push(Mt(e)),f&&h.push("=",yr(f)),h.push(`-----END PGP SIGNATURE-----
`);break;case l.armor.message:h.push(`-----BEGIN PGP MESSAGE-----
`),h.push(lr(i,a)),h.push(Mt(e)),f&&h.push("=",yr(f)),h.push(`-----END PGP MESSAGE-----
`);break;case l.armor.publicKey:h.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),h.push(lr(i,a)),h.push(Mt(e)),f&&h.push("=",yr(f)),h.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case l.armor.privateKey:h.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),h.push(lr(i,a)),h.push(Mt(e)),f&&h.push("=",yr(f)),h.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case l.armor.signature:h.push(`-----BEGIN PGP SIGNATURE-----
`),h.push(lr(i,a)),h.push(Mt(e)),f&&h.push("=",yr(f)),h.push(`-----END PGP SIGNATURE-----
`)}return d.concat(h)}var Ve=BigInt(0),Jr=BigInt(1);function Z(n){let e="0123456789ABCDEF",r="";return n.forEach(t=>{r+=e[t>>4]+e[15&t]}),BigInt("0x0"+r)}function te(n,e){let r=n%e;return r<Ve?r+e:r}function Ce(n,e,r){if(r===Ve)throw Error("Modulo cannot be zero");if(r===Jr)return BigInt(0);if(e<Ve)throw Error("Unsopported negative exponent");let t=e,i=n;i%=r;let s=BigInt(1);for(;t>Ve;){let a=t&Jr;t>>=Jr,s=a?s*i%r:s,i=i*i%r}return s}function Uo(n){return n>=Ve?n:-n}function tn(n,e){let{gcd:r,x:t}=function(i,s){let a=BigInt(0),o=BigInt(1),c=BigInt(1),f=BigInt(0),h=Uo(i),u=Uo(s),y=i<Ve,g=s<Ve;for(;u!==Ve;){let p=h/u,w=a;a=c-p*a,c=w,w=o,o=f-p*o,f=w,w=u,u=h%u,h=w}return{x:y?-c:c,y:g?-f:f,gcd:h}}(n,e);if(r!==Jr)throw Error("Inverse does not exist");return te(t+e,e)}function ia(n){let e=Number(n);if(e>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return e}function l0(n,e){return(n>>BigInt(e)&Jr)===Ve?0:1}function Xr(n){let e=n<Ve?BigInt(-1):Ve,r=1,t=n;for(;(t>>=Jr)!==e;)r++;return r}function qe(n){let e=n<Ve?BigInt(-1):Ve,r=BigInt(8),t=1,i=n;for(;(i>>=r)!==e;)t++;return t}function ke(n,e="be",r){let t=n.toString(16);t.length%2==1&&(t="0"+t);let i=t.length/2,s=new Uint8Array(r||i),a=r?r-i:0,o=0;for(;o<i;)s[o+a]=parseInt(t.slice(2*o,2*o+2),16),o++;return e!=="be"&&s.reverse(),s}var y0=d.getNodeCrypto();function Me(n){let e=typeof crypto<"u"?crypto:y0?.webcrypto;if(e?.getRandomValues){let r=new Uint8Array(n);return e.getRandomValues(r)}throw Error("No secure random number generator available.")}function cr(n,e){if(e<n)throw Error("Illegal parameter value: max <= min");let r=e-n;return te(Z(Me(qe(r)+8)),r)+n}var mt=BigInt(1);function Po(n,e,r){let t=BigInt(30),i=mt<<BigInt(n-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2],a=cr(i,i<<mt),o=ia(te(a,t));do a+=BigInt(s[o]),o=(o+s[o])%s.length,Xr(a)>n&&(a=te(a,i<<mt),a+=i,o=ia(te(a,t)));while(!gc(a,e,r));return a}function gc(n,e,r){return(!e||function(t,i){let s=t,a=i;for(;a!==Ve;){let o=a;a=s%a,s=o}return s}(n-mt,e)===mt)&&!!function(t){let i=BigInt(0);return g0.every(s=>te(t,s)!==i)}(n)&&!!function(t,i=BigInt(2)){return Ce(i,t-mt,t)===mt}(n)&&!!function(t,i){let s=Xr(t);i||(i=Math.max(1,s/48|0));let a=t-mt,o=0;for(;!l0(a,o);)o++;let c=t>>BigInt(o);for(;i>0;i--){let f,h=Ce(cr(BigInt(2),a),c,t);if(h!==mt&&h!==a){for(f=1;f<o;f++){if(h=te(h*h,t),h===mt)return!1;if(h===a)break}if(f===o)return!1}}return!0}(n,r)}var g0=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(n=>BigInt(n)),Do=d.getWebCrypto(),Ki=d.getNodeCrypto(),p0=Ki&&Ki.getHashes();function jt(n){if(Ki&&p0.includes(n))return function(e){return I(this,null,function*(){let r=Ki.createHash(n);return me(e,t=>{r.update(t)},()=>new Uint8Array(r.digest()))})}}function Vt(n,e){let r=()=>I(null,null,function*(){let{nobleHashes:t}=yield Promise.resolve().then(function(){return uh}),i=t.get(n);if(!i)throw Error("Unsupported hash");return i});return function(t){return I(this,null,function*(){if(Ee(t)&&(t=yield De(t)),d.isStream(t)){let i=(yield r()).create();return me(t,s=>{i.update(s)},()=>i.digest())}return Do&&e?new Uint8Array(yield Do.digest(e,t)):(yield r())(t)})}}var d0=jt("md5")||Vt("md5"),A0=jt("sha1")||Vt("sha1","SHA-1"),w0=jt("sha224")||Vt("sha224"),m0=jt("sha256")||Vt("sha256","SHA-256"),b0=jt("sha384")||Vt("sha384","SHA-384"),k0=jt("sha512")||Vt("sha512","SHA-512"),E0=jt("ripemd160")||Vt("ripemd160"),v0=jt("sha3-256")||Vt("sha3_256"),B0=jt("sha3-512")||Vt("sha3_512");function Ut(n,e){switch(n){case l.hash.md5:return d0(e);case l.hash.sha1:return A0(e);case l.hash.ripemd:return E0(e);case l.hash.sha256:return m0(e);case l.hash.sha384:return b0(e);case l.hash.sha512:return k0(e);case l.hash.sha224:return w0(e);case l.hash.sha3_256:return v0(e);case l.hash.sha3_512:return B0(e);default:throw Error("Unsupported hash function")}}function ve(n){switch(n){case l.hash.md5:return 16;case l.hash.sha1:case l.hash.ripemd:return 20;case l.hash.sha256:return 32;case l.hash.sha384:return 48;case l.hash.sha512:return 64;case l.hash.sha224:return 28;case l.hash.sha3_256:return 32;case l.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}var bt=[];function pc(n,e){let r=n.length;if(r>e-11)throw Error("Message too long");let t=function(s){let a=new Uint8Array(s),o=0;for(;o<s;){let c=Me(s-o);for(let f=0;f<c.length;f++)c[f]!==0&&(a[o++]=c[f])}return a}(e-r-3),i=new Uint8Array(e);return i[1]=2,i.set(t,2),i.set(n,e-r),i}function dc(n,e){let r=2,t=1;for(let o=r;o<n.length;o++)t&=n[o]!==0,r+=t;let i=r-2,s=n.subarray(r+1),a=n[0]===0&n[1]===2&i>=8&!t;if(e)return d.selectUint8Array(a,s,e);if(a)return s;throw Error("Decryption error")}function Ac(n,e,r){let t;if(e.length!==ve(n))throw Error("Invalid hash length");let i=new Uint8Array(bt[n].length);for(t=0;t<bt[n].length;t++)i[t]=bt[n][t];let s=i.length+e.length;if(r<s+11)throw Error("Intended encoded message length too short");let a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(i,r-s),o.set(e,r-e.length),o}bt[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],bt[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],bt[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],bt[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],bt[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],bt[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],bt[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];var rn=d.getWebCrypto(),Ir=d.getNodeCrypto(),ur=BigInt(1);function I0(n,e,r,t,i,s,a,o,c){return I(this,null,function*(){if(ve(n)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(e&&!d.isStream(e)){if(d.getWebCrypto())try{return yield function(f,h,u,y,g,p,w,A){return I(this,null,function*(){let k=yield sa(u,y,g,p,w,A),S={name:"RSASSA-PKCS1-v1_5",hash:{name:f}},m=yield rn.importKey("jwk",k,S,!1,["sign"]);return new Uint8Array(yield rn.sign("RSASSA-PKCS1-v1_5",m,h))})}(l.read(l.webHash,n),e,r,t,i,s,a,o)}catch(f){d.printDebugError(f)}else if(d.getNodeCrypto())return function(f,h,u,y,g,p,w,A){return I(this,null,function*(){let k=Ir.createSign(l.read(l.hash,f));k.write(h),k.end();let S=yield sa(u,y,g,p,w,A);return new Uint8Array(k.sign({key:S,format:"jwk",type:"pkcs1"}))})}(n,e,r,t,i,s,a,o)}return function(f,h,u,y){return I(this,null,function*(){h=Z(h);let g=Z(Ac(f,y,qe(h)));return u=Z(u),ke(Ce(g,u,h),"be",qe(h))})}(n,r,i,c)})}function S0(n,e,r,t,i,s){return I(this,null,function*(){if(e&&!d.isStream(e)){if(d.getWebCrypto())try{return yield function(a,o,c,f,h){return I(this,null,function*(){let u=aa(f,h),y=yield rn.importKey("jwk",u,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["verify"]);return rn.verify("RSASSA-PKCS1-v1_5",y,c,o)})}(l.read(l.webHash,n),e,r,t,i)}catch(a){d.printDebugError(a)}else if(d.getNodeCrypto())return function(a,o,c,f,h){return I(this,null,function*(){let u=aa(f,h),y={key:u,format:"jwk",type:"pkcs1"},g=Ir.createVerify(l.read(l.hash,a));g.write(o),g.end();try{return g.verify(y,c)}catch{return!1}})}(n,e,r,t,i)}return function(a,o,c,f,h){return I(this,null,function*(){if(c=Z(c),o=Z(o),f=Z(f),o>=c)throw Error("Signature size cannot exceed modulus size");let u=ke(Ce(o,f,c),"be",qe(c)),y=Ac(a,h,qe(c));return d.equalsUint8Array(u,y)})}(n,r,t,i,s)})}function K0(n,e,r){return I(this,null,function*(){return d.getNodeCrypto()?function(t,i,s){return I(this,null,function*(){let a=aa(i,s),o={key:a,format:"jwk",type:"pkcs1",padding:Ir.constants.RSA_PKCS1_PADDING};return new Uint8Array(Ir.publicEncrypt(o,t))})}(n,e,r):function(t,i,s){return I(this,null,function*(){if(i=Z(i),t=Z(pc(t,qe(i))),s=Z(s),t>=i)throw Error("Message size cannot exceed modulus size");return ke(Ce(t,s,i),"be",qe(i))})}(n,e,r)})}function C0(n,e,r,t,i,s,a,o){return I(this,null,function*(){if(d.getNodeCrypto()&&!o)try{return yield function(c,f,h,u,y,g,p){return I(this,null,function*(){let w=yield sa(f,h,u,y,g,p),A={key:w,format:"jwk",type:"pkcs1",padding:Ir.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Ir.privateDecrypt(A,c))}catch{throw Error("Decryption error")}})}(n,e,r,t,i,s,a)}catch(c){d.printDebugError(c)}return function(c,f,h,u,y,g,p,w){return I(this,null,function*(){if(c=Z(c),f=Z(f),h=Z(h),u=Z(u),y=Z(y),g=Z(g),p=Z(p),c>=f)throw Error("Data too large.");let A=te(u,g-ur),k=te(u,y-ur),S=cr(BigInt(2),f),m=Ce(tn(S,f),h,f);c=te(c*m,f);let E=Ce(c,k,y),D=Ce(c,A,g),U=te(p*(D-E),g)*y+E;return U=te(U*S,f),dc(ke(U,"be",qe(f)),w)})}(n,e,r,t,i,s,a,o)})}function sa(n,e,r,t,i,s){return I(this,null,function*(){let a=Z(t),o=Z(i),c=Z(r),f=te(c,o-ur),h=te(c,a-ur);return h=ke(h),f=ke(f),{kty:"RSA",n:Ue(n),e:Ue(e),d:Ue(r),p:Ue(i),q:Ue(t),dp:Ue(f),dq:Ue(h),qi:Ue(s),ext:!0}})}function aa(n,e){return{kty:"RSA",n:Ue(n),e:Ue(e),ext:!0}}function xo(n,e){return{n:Ge(n.n),e:ke(e),d:Ge(n.d),p:Ge(n.q),q:Ge(n.p),u:Ge(n.qi)}}var ir=BigInt(1),U0={"2a8648ce3d030107":l.curve.nistP256,"2b81040022":l.curve.nistP384,"2b81040023":l.curve.nistP521,"2b8104000a":l.curve.secp256k1,"2b06010401da470f01":l.curve.ed25519Legacy,"2b060104019755010501":l.curve.curve25519Legacy,"2b2403030208010107":l.curve.brainpoolP256r1,"2b240303020801010b":l.curve.brainpoolP384r1,"2b240303020801010d":l.curve.brainpoolP512r1},Ot=class n{constructor(e){if(e instanceof n)this.oid=e.oid;else if(d.isArray(e)||d.isUint8Array(e)){if((e=new Uint8Array(e))[0]===6){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){let r=e[0];if(e.length>=1+r)return this.oid=e.subarray(1,1+r),1+this.oid.length}throw Error("Invalid oid")}write(){return d.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return d.uint8ArrayToHex(this.oid)}getName(){let e=U0[this.toHex()];if(!e)throw Error("Unknown curve object identifier.");return e}};function wc(n){let e,r=0,t=n[0];return t<192?([r]=n,e=1):t<255?(r=(n[0]-192<<8)+n[1]+192,e=2):t===255&&(r=d.readNumber(n.subarray(1,5)),e=5),{len:r,offset:e}}function ys(n){return n<192?new Uint8Array([n]):n>191&&n<8384?new Uint8Array([192+(n-192>>8),n-192&255]):d.concatUint8Array([new Uint8Array([255]),d.writeNumber(n,4)])}function P0(n){if(n<0||n>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+n])}function Ci(n){return new Uint8Array([192|n])}function Qo(n,e){return d.concatUint8Array([Ci(n),ys(e)])}function pi(n){return[l.packet.literalData,l.packet.compressedData,l.packet.symmetricallyEncryptedData,l.packet.symEncryptedIntegrityProtectedData,l.packet.aeadEncryptedData].includes(n)}function D0(n,e,r){return I(this,null,function*(){let t,i;try{let s=yield n.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");let a=yield n.readByte(),o,c,f=-1,h=-1;h=0,64&a&&(h=1),h?f=63&a:(f=(63&a)>>2,c=3&a);let u=pi(f),y,g=null;if(e&&u){if(e==="array"){let p=new nt;t=st(p),g=p}else{let p=new TransformStream;t=st(p.writable),g=p.readable}i=r({tag:f,packet:g})}else g=[];do{if(h){let p=yield n.readByte();if(y=!1,p<192)o=p;else if(p>=192&&p<224)o=(p-192<<8)+(yield n.readByte())+192;else if(p>223&&p<255){if(o=1<<(31&p),y=!0,!u)throw new TypeError("This packet type does not support partial lengths.")}else o=(yield n.readByte())<<24|(yield n.readByte())<<16|(yield n.readByte())<<8|(yield n.readByte())}else switch(c){case 0:o=yield n.readByte();break;case 1:o=(yield n.readByte())<<8|(yield n.readByte());break;case 2:o=(yield n.readByte())<<24|(yield n.readByte())<<16|(yield n.readByte())<<8|(yield n.readByte());break;default:o=1/0}if(o>0){let p=0;for(;;){t&&(yield t.ready);let{done:w,value:A}=yield n.read();if(w){if(o===1/0)break;throw Error("Unexpected end of packet")}let k=o===1/0?A:A.subarray(0,o-p);if(t?yield t.write(k):g.push(k),p+=A.length,p>=o){n.unshift(A.subarray(o-p+A.length));break}}}}while(y);t?(yield t.ready,yield t.close()):(g=d.concatUint8Array(g),yield r({tag:f,packet:g}))}catch(s){if(t)return yield t.abort(s),!0;throw s}finally{t&&(yield i)}})}var ie=class n extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.name="UnsupportedError"}},Wr=class extends ie{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,ie),this.name="UnknownPacketError"}},Qn=class extends ie{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,ie),this.name="MalformedPacketError"}},Tn=class{constructor(e,r){this.tag=e,this.rawContent=r}write(){return this.rawContent}};function Wa(n){return I(this,null,function*(){switch(n){case l.publicKey.ed25519:try{let e=d.getWebCrypto(),r=yield e.generateKey("Ed25519",!0,["sign","verify"]).catch(s=>{if(s.name==="OperationError"){let a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw s}),t=yield e.exportKey("jwk",r.privateKey),i=yield e.exportKey("jwk",r.publicKey);return{A:new Uint8Array(Ge(i.x)),seed:Ge(t.d)}}catch(e){if(e.name!=="NotSupportedError")throw e;let{default:r}=yield Promise.resolve().then(function(){return Mr}),t=Me(gs(n)),{publicKey:i}=r.sign.keyPair.fromSeed(t);return{A:i,seed:t}}case l.publicKey.ed448:{let e=yield d.getNobleCurve(l.publicKey.ed448),{secretKey:r,publicKey:t}=e.keygen();return{A:t,seed:r}}default:throw Error("Unsupported EdDSA algorithm")}})}function $a(n,e,r,t,i,s){return I(this,null,function*(){if(ve(e)<ve(ps(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case l.publicKey.ed25519:try{let a=d.getWebCrypto(),o=mc(n,t,i),c=yield a.importKey("jwk",o,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(yield a.sign("Ed25519",c,s))}}catch(a){if(a.name!=="NotSupportedError")throw a;let{default:o}=yield Promise.resolve().then(function(){return Mr}),c=d.concatUint8Array([i,t]);return{RS:o.sign.detached(s,c)}}case l.publicKey.ed448:return{RS:(yield d.getNobleCurve(l.publicKey.ed448)).sign(s,i)};default:throw Error("Unsupported EdDSA algorithm")}})}function eo(a,o,c,f,h,u){return I(this,arguments,function*(n,e,{RS:r},t,i,s){if(ve(e)<ve(ps(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case l.publicKey.ed25519:try{let y=d.getWebCrypto(),g=ro(n,i),p=yield y.importKey("jwk",g,"Ed25519",!1,["verify"]);return yield y.verify("Ed25519",p,r,s)}catch(y){if(y.name!=="NotSupportedError")throw y;let{default:g}=yield Promise.resolve().then(function(){return Mr});return g.sign.detached.verify(s,r,i)}case l.publicKey.ed448:return(yield d.getNobleCurve(l.publicKey.ed448)).verify(r,s,i);default:throw Error("Unsupported EdDSA algorithm")}})}function to(n,e,r){return I(this,null,function*(){switch(n){case l.publicKey.ed25519:try{let t=d.getWebCrypto(),i=mc(n,e,r),s=ro(n,e),a=yield t.importKey("jwk",i,"Ed25519",!1,["sign"]),o=yield t.importKey("jwk",s,"Ed25519",!1,["verify"]),c=Me(8),f=new Uint8Array(yield t.sign("Ed25519",a,c));return yield t.verify("Ed25519",o,f,c)}catch(t){if(t.name!=="NotSupportedError")return!1;let{default:i}=yield Promise.resolve().then(function(){return Mr}),{publicKey:s}=i.sign.keyPair.fromSeed(r);return d.equalsUint8Array(e,s)}case l.publicKey.ed448:{let t=(yield d.getNobleCurve(l.publicKey.ed448)).getPublicKey(r);return d.equalsUint8Array(e,t)}default:return!1}})}function gs(n){switch(n){case l.publicKey.ed25519:return 32;case l.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function ps(n){switch(n){case l.publicKey.ed25519:return l.hash.sha256;case l.publicKey.ed448:return l.hash.sha512;default:throw Error("Unknown EdDSA algo")}}var ro=(n,e)=>{if(n===l.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:Ue(e),ext:!0};throw Error("Unsupported EdDSA algorithm")},mc=(n,e,r)=>{if(n===l.publicKey.ed25519){let t=ro(n,e);return t.d=Ue(r),t}throw Error("Unsupported EdDSA algorithm")},x0=Object.freeze({__proto__:null,generate:Wa,getPayloadSize:gs,getPreferredHashAlgo:ps,sign:$a,validateParams:to,verify:eo});function bc(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function ye(n,...e){if(!bc(n))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw Error("Uint8Array expected of length "+e+", got length="+n.length)}function Ui(n,e=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(e&&n.finished)throw Error("Hash#digest() has already been called")}function kc(n,e){ye(n);let r=e.outputLen;if(n.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function no(n){return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}function oe(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function Fe(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function ds(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}var Q0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Mn(n){if(typeof n=="string")n=function(e){if(typeof e!="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(n);else{if(!bc(n))throw Error("Uint8Array expected, got "+typeof n);n=je(n)}return n}function Ec(n,e){return n.buffer===e.buffer&&n.byteOffset<e.byteOffset+e.byteLength&&e.byteOffset<n.byteOffset+n.byteLength}function oa(n,e){if(Ec(n,e)&&n.byteOffset<e.byteOffset)throw Error("complex overlap of input and output is not supported")}function vc(n,e){if(n.length!==e.length)return!1;let r=0;for(let t=0;t<n.length;t++)r|=n[t]^e[t];return r===0}var Zn=(n,e)=>{function r(t,...i){if(ye(t),!Q0)throw Error("Non little-endian hardware is not yet supported");if(n.nonceLength!==void 0){let f=i[0];if(!f)throw Error("nonce / iv required");n.varSizeNonce?ye(f):ye(f,n.nonceLength)}let s=n.tagLength;s&&i[1]!==void 0&&ye(i[1]);let a=e(t,...i),o=(f,h)=>{if(h!==void 0){if(f!==2)throw Error("cipher output not supported");ye(h)}},c=!1;return{encrypt(f,h){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,ye(f),o(a.encrypt.length,h),a.encrypt(f,h)},decrypt(f,h){if(ye(f),s&&f.length<s)throw Error("invalid ciphertext length: smaller than tagLength="+s);return o(a.decrypt.length,h),a.decrypt(f,h)}}}return Object.assign(r,n),r};function Fn(n,e,r=!0){if(e===void 0)return new Uint8Array(n);if(e.length!==n)throw Error("invalid output length, expected "+n+", got: "+e.length);if(r&&!it(e))throw Error("invalid output, must be aligned");return e}function ca(n,e,r,t){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,r,t);let i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s);n.setUint32(e+0,a,t),n.setUint32(e+4,o,t)}function it(n){return n.byteOffset%4==0}function je(n){return Uint8Array.from(n)}var Ft=16,io=new Uint8Array(16),Et=oe(io),rt=n=>(n>>>0&255)<<24|(n>>>8&255)<<16|(n>>>16&255)<<8|n>>>24&255,Pi=class{constructor(e,r){this.blockLen=Ft,this.outputLen=Ft,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,ye(e=Mn(e),16);let t=ds(e),i=t.getUint32(0,!1),s=t.getUint32(4,!1),a=t.getUint32(8,!1),o=t.getUint32(12,!1),c=[];for(let S=0;S<128;S++)c.push({s0:rt(i),s1:rt(s),s2:rt(a),s3:rt(o)}),{s0:i,s1:s,s2:a,s3:o}={s3:(u=a)<<31|(y=o)>>>1,s2:(h=s)<<31|u>>>1,s1:(f=i)<<31|h>>>1,s0:f>>>1^225<<24&-(1&y)};var f,h,u,y;let g=(p=r||1024)>65536?8:p>1024?4:2;var p;if(![1,2,4,8].includes(g))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=g;let w=128/g,A=this.windowSize=2**g,k=[];for(let S=0;S<w;S++)for(let m=0;m<A;m++){let E=0,D=0,R=0,U=0;for(let B=0;B<g;B++){if(!(m>>>g-B-1&1))continue;let{s0:b,s1:C,s2:v,s3:K}=c[g*S+B];E^=b,D^=C,R^=v,U^=K}k.push({s0:E,s1:D,s2:R,s3:U})}this.t=k}_updateBlock(e,r,t,i){e^=this.s0,r^=this.s1,t^=this.s2,i^=this.s3;let{W:s,t:a,windowSize:o}=this,c=0,f=0,h=0,u=0,y=(1<<s)-1,g=0;for(let p of[e,r,t,i])for(let w=0;w<4;w++){let A=p>>>8*w&255;for(let k=8/s-1;k>=0;k--){let S=A>>>s*k&y,{s0:m,s1:E,s2:D,s3:R}=a[g*o+S];c^=m,f^=E,h^=D,u^=R,g+=1}}this.s0=c,this.s1=f,this.s2=h,this.s3=u}update(e){Ui(this),ye(e=Mn(e));let r=oe(e),t=Math.floor(e.length/Ft),i=e.length%Ft;for(let s=0;s<t;s++)this._updateBlock(r[4*s+0],r[4*s+1],r[4*s+2],r[4*s+3]);return i&&(io.set(e.subarray(t*Ft)),this._updateBlock(Et[0],Et[1],Et[2],Et[3]),Fe(Et)),this}destroy(){let{t:e}=this;for(let r of e)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(e){Ui(this),kc(e,this),this.finished=!0;let{s0:r,s1:t,s2:i,s3:s}=this,a=oe(e);return a[0]=r,a[1]=t,a[2]=i,a[3]=s,e}digest(){let e=new Uint8Array(Ft);return this.digestInto(e),this.destroy(),e}},ua=class extends Pi{constructor(e,r){ye(e=Mn(e));let t=function(i){i.reverse();let s=1&i[15],a=0;for(let o=0;o<i.length;o++){let c=i[o];i[o]=c>>>1|a,a=(1&c)<<7}return i[0]^=225&-s,i}(je(e));super(t,r),Fe(t)}update(e){e=Mn(e),Ui(this);let r=oe(e),t=e.length%Ft,i=Math.floor(e.length/Ft);for(let s=0;s<i;s++)this._updateBlock(rt(r[4*s+3]),rt(r[4*s+2]),rt(r[4*s+1]),rt(r[4*s+0]));return t&&(io.set(e.subarray(i*Ft)),this._updateBlock(rt(Et[3]),rt(Et[2]),rt(Et[1]),rt(Et[0])),Fe(Et)),this}digestInto(e){Ui(this),kc(e,this),this.finished=!0;let{s0:r,s1:t,s2:i,s3:s}=this,a=oe(e);return a[0]=r,a[1]=t,a[2]=i,a[3]=s,e.reverse()}};function Bc(n){let e=(t,i)=>n(i,t.length).update(Mn(t)).digest(),r=n(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(t,i)=>n(t,i),e}var Ro=Bc((n,e)=>new Pi(n,e));Bc((n,e)=>new ua(n,e));var We=16,ti=new Uint8Array(We);function so(n){return n<<1^283&-(n>>7)}function jr(n,e){let r=0;for(;e>0;e>>=1)r^=n&-(1&e),n=so(n);return r}var ha=(()=>{let n=new Uint8Array(256);for(let r=0,t=1;r<256;r++,t^=so(t))n[r]=t;let e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let t=n[255-r];t|=t<<8,e[n[r]]=255&(t^t>>4^t>>5^t>>6^t>>7^99)}return Fe(n),e})(),R0=ha.map((n,e)=>ha.indexOf(e)),Us=n=>n<<8|n>>>24,To=n=>n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255;function Ic(n,e){if(n.length!==256)throw Error("Wrong sbox length");let r=new Uint32Array(256).map((f,h)=>e(n[h])),t=r.map(Us),i=t.map(Us),s=i.map(Us),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let f=0;f<256;f++)for(let h=0;h<256;h++){let u=256*f+h;a[u]=r[f]^t[h],o[u]=i[f]^s[h],c[u]=n[f]<<8|n[h]}return{sbox:n,sbox2:c,T0:r,T1:t,T2:i,T3:s,T01:a,T23:o}}var ao=Ic(ha,n=>jr(n,3)<<24|n<<16|n<<8|jr(n,2)),Sc=Ic(R0,n=>jr(n,11)<<24|jr(n,13)<<16|jr(n,9)<<8|jr(n,14)),T0=(()=>{let n=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=so(r))n[e]=r;return n})();function Qr(n){ye(n);let e=n.length;if(![16,24,32].includes(e))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+e);let{sbox2:r}=ao,t=[];it(n)||t.push(n=je(n));let i=oe(n),s=i.length,a=f=>Bt(r,f,f,f,f),o=new Uint32Array(e+28);o.set(i);for(let f=s;f<o.length;f++){let h=o[f-1];f%s==0?h=a((c=h)<<24|c>>>8)^T0[f/s-1]:s>6&&f%s==4&&(h=a(h)),o[f]=o[f-s]^h}var c;return Fe(...t),o}function oo(n){let e=Qr(n),r=e.slice(),t=e.length,{sbox2:i}=ao,{T0:s,T1:a,T2:o,T3:c}=Sc;for(let f=0;f<t;f+=4)for(let h=0;h<4;h++)r[f+h]=e[t-f-4+h];Fe(e);for(let f=4;f<t-4;f++){let h=r[f],u=Bt(i,h,h,h,h);r[f]=s[255&u]^a[u>>>8&255]^o[u>>>16&255]^c[u>>>24]}return r}function sr(n,e,r,t,i,s){return n[r<<8&65280|t>>>8&255]^e[i>>>8&65280|s>>>24&255]}function Bt(n,e,r,t,i){return n[255&e|65280&r]|n[t>>>16&255|i>>>16&65280]<<16}function yt(n,e,r,t,i){let{sbox2:s,T01:a,T23:o}=ao,c=0;e^=n[c++],r^=n[c++],t^=n[c++],i^=n[c++];let f=n.length/4-2;for(let h=0;h<f;h++){let u=n[c++]^sr(a,o,e,r,t,i),y=n[c++]^sr(a,o,r,t,i,e),g=n[c++]^sr(a,o,t,i,e,r),p=n[c++]^sr(a,o,i,e,r,t);e=u,r=y,t=g,i=p}return{s0:n[c++]^Bt(s,e,r,t,i),s1:n[c++]^Bt(s,r,t,i,e),s2:n[c++]^Bt(s,t,i,e,r),s3:n[c++]^Bt(s,i,e,r,t)}}function As(n,e,r,t,i){let{sbox2:s,T01:a,T23:o}=Sc,c=0;e^=n[c++],r^=n[c++],t^=n[c++],i^=n[c++];let f=n.length/4-2;for(let h=0;h<f;h++){let u=n[c++]^sr(a,o,e,i,t,r),y=n[c++]^sr(a,o,r,e,i,t),g=n[c++]^sr(a,o,t,r,e,i),p=n[c++]^sr(a,o,i,t,r,e);e=u,r=y,t=g,i=p}return{s0:n[c++]^Bt(s,e,i,t,r),s1:n[c++]^Bt(s,r,e,i,t),s2:n[c++]^Bt(s,t,r,e,i),s3:n[c++]^Bt(s,i,t,r,e)}}function Kc(n,e,r,t){ye(e,We),ye(r);let i=r.length;oa(r,t=Fn(i,t));let s=e,a=oe(s),{s0:o,s1:c,s2:f,s3:h}=yt(n,a[0],a[1],a[2],a[3]),u=oe(r),y=oe(t);for(let p=0;p+4<=u.length;p+=4){y[p+0]=u[p+0]^o,y[p+1]=u[p+1]^c,y[p+2]=u[p+2]^f,y[p+3]=u[p+3]^h;let w=1;for(let A=s.length-1;A>=0;A--)w=w+(255&s[A])|0,s[A]=255&w,w>>>=8;({s0:o,s1:c,s2:f,s3:h}=yt(n,a[0],a[1],a[2],a[3]))}let g=We*Math.floor(u.length/4);if(g<i){let p=new Uint32Array([o,c,f,h]),w=no(p);for(let A=g,k=0;A<i;A++,k++)t[A]=r[A]^w[k];Fe(p)}return t}function En(n,e,r,t,i){ye(r,We),ye(t),i=Fn(t.length,i);let s=r,a=oe(s),o=ds(s),c=oe(t),f=oe(i),h=e?0:12,u=t.length,y=o.getUint32(h,e),{s0:g,s1:p,s2:w,s3:A}=yt(n,a[0],a[1],a[2],a[3]);for(let S=0;S+4<=c.length;S+=4)f[S+0]=c[S+0]^g,f[S+1]=c[S+1]^p,f[S+2]=c[S+2]^w,f[S+3]=c[S+3]^A,y=y+1>>>0,o.setUint32(h,y,e),{s0:g,s1:p,s2:w,s3:A}=yt(n,a[0],a[1],a[2],a[3]);let k=We*Math.floor(c.length/4);if(k<u){let S=new Uint32Array([g,p,w,A]),m=no(S);for(let E=k,D=0;E<u;E++,D++)i[E]=t[E]^m[D];Fe(S)}return i}var M0=Zn({blockSize:16,nonceLength:16},function(n,e){function r(t,i){if(ye(t),i!==void 0&&(ye(i),!it(i)))throw Error("unaligned destination");let s=Qr(n),a=je(e),o=[s,a];it(t)||o.push(t=je(t));let c=Kc(s,a,t,i);return Fe(...o),c}return{encrypt:(t,i)=>r(t,i),decrypt:(t,i)=>r(t,i)}}),fa=Zn({blockSize:16,nonceLength:16},function(n,e,r={}){let t=!r.disablePadding;return{encrypt(i,s){let a=Qr(n),{b:o,o:c,out:f}=function(S,m,E){ye(S);let D=S.length,R=D%We;if(!m&&R!==0)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");it(S)||(S=je(S));let U=oe(S);if(m){let B=We-R;B||(B=We),D+=B}return oa(S,E=Fn(D,E)),{b:U,o:oe(E),out:E}}(i,t,s),h=e,u=[a];it(h)||u.push(h=je(h));let y=oe(h),g=y[0],p=y[1],w=y[2],A=y[3],k=0;for(;k+4<=o.length;)g^=o[k+0],p^=o[k+1],w^=o[k+2],A^=o[k+3],{s0:g,s1:p,s2:w,s3:A}=yt(a,g,p,w,A),c[k++]=g,c[k++]=p,c[k++]=w,c[k++]=A;if(t){let S=function(m){let E=new Uint8Array(16),D=oe(E);E.set(m);let R=We-m.length;for(let U=We-R;U<We;U++)E[U]=R;return D}(i.subarray(4*k));g^=S[0],p^=S[1],w^=S[2],A^=S[3],{s0:g,s1:p,s2:w,s3:A}=yt(a,g,p,w,A),c[k++]=g,c[k++]=p,c[k++]=w,c[k++]=A}return Fe(...u),f},decrypt(i,s){(function(A){if(ye(A),A.length%We!=0)throw Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size 16")})(i);let a=oo(n),o=e,c=[a];it(o)||c.push(o=je(o));let f=oe(o);s=Fn(i.length,s),it(i)||c.push(i=je(i)),oa(i,s);let h=oe(i),u=oe(s),y=f[0],g=f[1],p=f[2],w=f[3];for(let A=0;A+4<=h.length;){let k=y,S=g,m=p,E=w;y=h[A+0],g=h[A+1],p=h[A+2],w=h[A+3];let{s0:D,s1:R,s2:U,s3:B}=As(a,y,g,p,w);u[A++]=D^k,u[A++]=R^S,u[A++]=U^m,u[A++]=B^E}return Fe(...c),function(A,k){if(!k)return A;let S=A.length;if(!S)throw Error("aes/pcks5: empty ciphertext not allowed");let m=A[S-1];if(m<=0||m>16)throw Error("aes/pcks5: wrong padding");let E=A.subarray(0,-m);for(let D=0;D<m;D++)if(A[S-D-1]!==m)throw Error("aes/pcks5: wrong padding");return E}(s,t)}}}),Cc=Zn({blockSize:16,nonceLength:16},function(n,e){function r(t,i,s){ye(t);let a=t.length;if(Ec(t,s=Fn(a,s)))throw Error("overlapping src and dst not supported.");let o=Qr(n),c=e,f=[o];it(c)||f.push(c=je(c)),it(t)||f.push(t=je(t));let h=oe(t),u=oe(s),y=i?u:h,g=oe(c),p=g[0],w=g[1],A=g[2],k=g[3];for(let m=0;m+4<=h.length;){let{s0:E,s1:D,s2:R,s3:U}=yt(o,p,w,A,k);u[m+0]=h[m+0]^E,u[m+1]=h[m+1]^D,u[m+2]=h[m+2]^R,u[m+3]=h[m+3]^U,p=y[m++],w=y[m++],A=y[m++],k=y[m++]}let S=We*Math.floor(h.length/4);if(S<a){({s0:p,s1:w,s2:A,s3:k}=yt(o,p,w,A,k));let m=no(new Uint32Array([p,w,A,k]));for(let E=S,D=0;E<a;E++,D++)s[E]=t[E]^m[D];Fe(m)}return Fe(...f),s}return{encrypt:(t,i)=>r(t,!0,i),decrypt:(t,i)=>r(t,!1,i)}});function F0(n,e,r,t,i){let s=i?i.length:0,a=n.create(r,t.length+s);i&&a.update(i);let o=function(f,h,u){let y=new Uint8Array(16),g=ds(y);return ca(g,0,BigInt(h),u),ca(g,8,BigInt(f),u),y}(8*t.length,8*s,e);a.update(t),a.update(o);let c=a.digest();return Fe(o),c}var ri=Zn({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(n,e,r){if(e.length<8)throw Error("aes/gcm: invalid nonce length");function t(s,a,o){let c=F0(Ro,!1,s,o,r);for(let f=0;f<a.length;f++)c[f]^=a[f];return c}function i(){let s=Qr(n),a=ti.slice(),o=ti.slice();if(En(s,!1,o,o,a),e.length===12)o.set(e);else{let c=ti.slice();ca(ds(c),8,BigInt(8*e.length),!1);let f=Ro.create(a).update(e).update(c);f.digestInto(o),f.destroy()}return{xk:s,authKey:a,counter:o,tagMask:En(s,!1,o,ti)}}return{encrypt(s){let{xk:a,authKey:o,counter:c,tagMask:f}=i(),h=new Uint8Array(s.length+16),u=[a,o,c,f];it(s)||u.push(s=je(s)),En(a,!1,c,s,h.subarray(0,s.length));let y=t(o,f,h.subarray(0,h.length-16));return u.push(y),h.set(y,s.length),Fe(...u),h},decrypt(s){let{xk:a,authKey:o,counter:c,tagMask:f}=i(),h=[a,o,f,c];it(s)||h.push(s=je(s));let u=s.subarray(0,-16),y=s.subarray(-16),g=t(o,f,u);if(h.push(g),!vc(g,y))throw Error("aes/gcm: invalid ghash tag");let p=En(a,!1,c,u);return Fe(...h),p}}});function Uc(n){return n instanceof Uint32Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint32Array"}function Pc(n,e){if(ye(e,16),!Uc(n))throw Error("_encryptBlock accepts result of expandKeyLE");let r=oe(e),{s0:t,s1:i,s2:s,s3:a}=yt(n,r[0],r[1],r[2],r[3]);return r[0]=t,r[1]=i,r[2]=s,r[3]=a,e}function Dc(n,e){if(ye(e,16),!Uc(n))throw Error("_decryptBlock accepts result of expandKeyLE");let r=oe(e),{s0:t,s1:i,s2:s,s3:a}=As(n,r[0],r[1],r[2],r[3]);return r[0]=t,r[1]=i,r[2]=s,r[3]=a,e}var Mo={encrypt(n,e){if(e.length>=2**32)throw Error("plaintext should be less than 4gb");let r=Qr(n);if(e.length===16)Pc(r,e);else{let t=oe(e),i=t[0],s=t[1];for(let a=0,o=1;a<6;a++)for(let c=2;c<t.length;c+=2,o++){let{s0:f,s1:h,s2:u,s3:y}=yt(r,i,s,t[c],t[c+1]);i=f,s=h^To(o),t[c]=u,t[c+1]=y}t[0]=i,t[1]=s}r.fill(0)},decrypt(n,e){if(e.length-8>=2**32)throw Error("ciphertext should be less than 4gb");let r=oo(n),t=e.length/8-1;if(t===1)Dc(r,e);else{let i=oe(e),s=i[0],a=i[1];for(let o=0,c=6*t;o<6;o++)for(let f=2*t;f>=1;f-=2,c--){a^=To(c);let{s0:h,s1:u,s2:y,s3:g}=As(r,s,a,i[f],i[f+1]);s=h,a=u,i[f]=y,i[f+1]=g}i[0]=s,i[1]=a}r.fill(0)}},Fo=new Uint8Array(8).fill(166),xc=Zn({blockSize:8},n=>({encrypt(e){if(!e.length||e.length%8!=0)throw Error("invalid plaintext length");if(e.length===8)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");let r=function(...t){let i=0;for(let a=0;a<t.length;a++){let o=t[a];ye(o),i+=o.length}let s=new Uint8Array(i);for(let a=0,o=0;a<t.length;a++){let c=t[a];s.set(c,o),o+=c.length}return s}(Fo,e);return Mo.encrypt(n,r),r},decrypt(e){if(e.length%8!=0||e.length<24)throw Error("invalid ciphertext length");let r=je(e);if(Mo.decrypt(n,r),!vc(r.subarray(0,8),Fo))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}})),Lo={expandKeyLE:Qr,expandKeyDecLE:oo,encrypt:yt,decrypt:As,encryptBlock:Pc,decryptBlock:Dc,ctrCounter:Kc,ctr32:En};function Qc(n){return I(this,null,function*(){switch(n){case l.symmetric.aes128:case l.symmetric.aes192:case l.symmetric.aes256:throw Error("Not a legacy cipher");case l.symmetric.cast5:case l.symmetric.blowfish:case l.symmetric.twofish:case l.symmetric.tripledes:{let{legacyCiphers:e}=yield Promise.resolve().then(function(){return Ah}),r=l.read(l.symmetric,n),t=e.get(r);if(!t)throw Error("Unsupported cipher algorithm");return t}default:throw Error("Unsupported cipher algorithm")}})}function L0(n){switch(n){case l.symmetric.aes128:case l.symmetric.aes192:case l.symmetric.aes256:case l.symmetric.twofish:return 16;case l.symmetric.blowfish:case l.symmetric.cast5:case l.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function N0(n){switch(n){case l.symmetric.aes128:case l.symmetric.blowfish:case l.symmetric.cast5:return 16;case l.symmetric.aes192:case l.symmetric.tripledes:return 24;case l.symmetric.aes256:case l.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function he(n){return{keySize:N0(n),blockSize:L0(n)}}var $r=d.getWebCrypto();function la(n,e,r){return I(this,null,function*(){let{keySize:t}=he(n);if(!d.isAES(n)||e.length!==t)throw Error("Unexpected algorithm or key size");try{let i=yield $r.importKey("raw",e,{name:"AES-KW"},!1,["wrapKey"]),s=yield $r.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),a=yield $r.wrapKey("raw",s,i,{name:"AES-KW"});return new Uint8Array(a)}catch(i){if(i.name!=="NotSupportedError"&&(e.length!==24||i.name!=="OperationError"))throw i;d.printDebugError("Browser did not support operation: "+i.message)}return xc(e).encrypt(r)})}function ya(n,e,r){return I(this,null,function*(){let{keySize:t}=he(n);if(!d.isAES(n)||e.length!==t)throw Error("Unexpected algorithm or key size");let i;try{i=yield $r.importKey("raw",e,{name:"AES-KW"},!1,["unwrapKey"])}catch(s){if(s.name!=="NotSupportedError"&&(e.length!==24||s.name!=="OperationError"))throw s;return d.printDebugError("Browser did not support operation: "+s.message),xc(e).decrypt(r)}try{let s=yield $r.unwrapKey("raw",r,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(yield $r.exportKey("raw",s))}catch(s){throw s.name==="OperationError"?Error("Key Data Integrity failed"):s}})}function hr(n,e,r,t,i){return I(this,null,function*(){let s=d.getWebCrypto(),a=l.read(l.webHash,n);if(!a)throw Error("Hash algo not supported with HKDF");let o=yield s.importKey("raw",e,"HKDF",!1,["deriveBits"]),c=yield s.deriveBits({name:"HKDF",hash:a,salt:r,info:t},o,8*i);return new Uint8Array(c)})}var Di={x25519:d.encodeUTF8("OpenPGP X25519"),x448:d.encodeUTF8("OpenPGP X448")};function co(n){return I(this,null,function*(){switch(n){case l.publicKey.x25519:try{let e=d.getWebCrypto(),r=yield e.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(s=>{if(s.name==="OperationError"){let a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw s}),t=yield e.exportKey("jwk",r.privateKey),i=yield e.exportKey("jwk",r.publicKey);if(t.x!==i.x){let s=Error("Unexpected mismatching public point");throw s.name="NotSupportedError",s}return{A:new Uint8Array(Ge(i.x)),k:Ge(t.d)}}catch(e){if(e.name!=="NotSupportedError")throw e;let{default:r}=yield Promise.resolve().then(function(){return Mr}),{secretKey:t,publicKey:i}=r.box.keyPair();return{A:i,k:t}}case l.publicKey.x448:{let e=yield d.getNobleCurve(l.publicKey.x448),{secretKey:r,publicKey:t}=e.keygen();return{A:t,k:r}}default:throw Error("Unsupported ECDH algorithm")}})}function uo(n,e,r){return I(this,null,function*(){switch(n){case l.publicKey.x25519:try{let{ephemeralPublicKey:t,sharedSecret:i}=yield ms(n,e),s=yield bs(n,t,e,r);return d.equalsUint8Array(i,s)}catch{return!1}case l.publicKey.x448:{let t=(yield d.getNobleCurve(l.publicKey.x448)).getPublicKey(r);return d.equalsUint8Array(e,t)}default:return!1}})}function Rc(n,e,r){return I(this,null,function*(){let{ephemeralPublicKey:t,sharedSecret:i}=yield ms(n,r),s=d.concatUint8Array([t,r,i]);switch(n){case l.publicKey.x25519:{let a=l.symmetric.aes128,{keySize:o}=he(a),c=yield hr(l.hash.sha256,s,new Uint8Array,Di.x25519,o);return{ephemeralPublicKey:t,wrappedKey:yield la(a,c,e)}}case l.publicKey.x448:{let a=l.symmetric.aes256,{keySize:o}=he(l.symmetric.aes256),c=yield hr(l.hash.sha512,s,new Uint8Array,Di.x448,o);return{ephemeralPublicKey:t,wrappedKey:yield la(a,c,e)}}default:throw Error("Unsupported ECDH algorithm")}})}function Tc(n,e,r,t,i){return I(this,null,function*(){let s=yield bs(n,e,t,i),a=d.concatUint8Array([e,t,s]);switch(n){case l.publicKey.x25519:{let o=l.symmetric.aes128,{keySize:c}=he(o);return ya(o,yield hr(l.hash.sha256,a,new Uint8Array,Di.x25519,c),r)}case l.publicKey.x448:{let o=l.symmetric.aes256,{keySize:c}=he(l.symmetric.aes256);return ya(o,yield hr(l.hash.sha512,a,new Uint8Array,Di.x448,c),r)}default:throw Error("Unsupported ECDH algorithm")}})}function ws(n){switch(n){case l.publicKey.x25519:return 32;case l.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}function ms(n,e){return I(this,null,function*(){switch(n){case l.publicKey.x25519:try{let r=d.getWebCrypto(),t=yield r.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(c=>{if(c.name==="OperationError"){let f=Error("Unexpected key generation issue");throw f.name="NotSupportedError",f}throw c}),i=yield r.exportKey("jwk",t.publicKey);if((yield r.exportKey("jwk",t.privateKey)).x!==i.x){let c=Error("Unexpected mismatching public point");throw c.name="NotSupportedError",c}let s=ga(n,e),a=yield r.importKey("jwk",s,"X25519",!1,[]),o=yield r.deriveBits({name:"X25519",public:a},t.privateKey,8*ws(n));return{sharedSecret:new Uint8Array(o),ephemeralPublicKey:new Uint8Array(Ge(i.x))}}catch(r){if(r.name!=="NotSupportedError")throw r;let{default:t}=yield Promise.resolve().then(function(){return Mr}),{secretKey:i,publicKey:s}=t.box.keyPair(),a=t.scalarMult(i,e);return xi(a),{ephemeralPublicKey:s,sharedSecret:a}}case l.publicKey.x448:{let r=yield d.getNobleCurve(l.publicKey.x448),{secretKey:t,publicKey:i}=r.keygen(),s=r.getSharedSecret(t,e);return xi(s),{ephemeralPublicKey:i,sharedSecret:s}}default:throw Error("Unsupported ECDH algorithm")}})}function bs(n,e,r,t){return I(this,null,function*(){switch(n){case l.publicKey.x25519:try{let i=d.getWebCrypto(),s=function(h,u,y){if(h===l.publicKey.x25519){let g=ga(h,u);return g.d=Ue(y),g}throw Error("Unsupported ECDH algorithm")}(n,r,t),a=ga(n,e),o=yield i.importKey("jwk",s,"X25519",!1,["deriveKey","deriveBits"]),c=yield i.importKey("jwk",a,"X25519",!1,[]),f=yield i.deriveBits({name:"X25519",public:c},o,8*ws(n));return new Uint8Array(f)}catch(i){if(i.name!=="NotSupportedError")throw i;let{default:s}=yield Promise.resolve().then(function(){return Mr}),a=s.scalarMult(t,e);return xi(a),a}case l.publicKey.x448:{let i=(yield d.getNobleCurve(l.publicKey.x448)).getSharedSecret(t,e);return xi(i),i}default:throw Error("Unsupported ECDH algorithm")}})}function xi(n){let e=0;for(let r=0;r<n.length;r++)e|=n[r];if(e===0)throw Error("Unexpected low order point")}function ga(n,e){if(n===l.publicKey.x25519)return{kty:"OKP",crv:"X25519",x:Ue(e),ext:!0};throw Error("Unsupported ECDH algorithm")}var O0=Object.freeze({__proto__:null,decrypt:Tc,encrypt:Rc,generate:co,generateEphemeralEncryptionMaterial:ms,getPayloadSize:ws,recomputeSharedSecret:bs,validateParams:uo}),Ps=d.getWebCrypto(),Qi=d.getNodeCrypto(),Kt={[l.curve.nistP256]:"P-256",[l.curve.nistP384]:"P-384",[l.curve.nistP521]:"P-521"},Dt=Qi?Qi.getCurves():[],kt=Qi?{[l.curve.secp256k1]:Dt.includes("secp256k1")?"secp256k1":void 0,[l.curve.nistP256]:Dt.includes("prime256v1")?"prime256v1":void 0,[l.curve.nistP384]:Dt.includes("secp384r1")?"secp384r1":void 0,[l.curve.nistP521]:Dt.includes("secp521r1")?"secp521r1":void 0,[l.curve.ed25519Legacy]:Dt.includes("ED25519")?"ED25519":void 0,[l.curve.curve25519Legacy]:Dt.includes("X25519")?"X25519":void 0,[l.curve.brainpoolP256r1]:Dt.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[l.curve.brainpoolP384r1]:Dt.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[l.curve.brainpoolP512r1]:Dt.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},Mc={[l.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:kt[l.curve.nistP256],web:Kt[l.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[l.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:l.publicKey.ecdsa,hash:l.hash.sha384,cipher:l.symmetric.aes192,node:kt[l.curve.nistP384],web:Kt[l.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[l.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:l.publicKey.ecdsa,hash:l.hash.sha512,cipher:l.symmetric.aes256,node:kt[l.curve.nistP521],web:Kt[l.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[l.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:kt[l.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[l.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:l.publicKey.eddsaLegacy,hash:l.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[l.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:l.publicKey.ecdh,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[l.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:kt[l.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[l.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:l.publicKey.ecdsa,hash:l.hash.sha384,cipher:l.symmetric.aes192,node:kt[l.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[l.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:l.publicKey.ecdsa,hash:l.hash.sha512,cipher:l.symmetric.aes256,node:kt[l.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}},Ze=class{constructor(e){try{this.name=e instanceof Ot?e.getName():l.write(l.curve,e)}catch{throw new ie("Unknown curve")}let r=Mc[this.name];this.keyType=r.keyType,this.oid=r.oid,this.hash=r.hash,this.cipher=r.cipher,this.node=r.node,this.web=r.web,this.payloadSize=r.payloadSize,this.sharedSize=r.sharedSize,this.wireFormatLeadingByte=r.wireFormatLeadingByte,this.web&&d.getWebCrypto()?this.type="web":this.node&&d.getNodeCrypto()?this.type="node":this.name===l.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===l.curve.ed25519Legacy&&(this.type="ed25519Legacy")}genKeyPair(){return I(this,null,function*(){switch(this.type){case"web":try{return yield function(e,r){return I(this,null,function*(){let t=yield Ps.generateKey({name:"ECDSA",namedCurve:Kt[e]},!0,["sign","verify"]),i=yield Ps.exportKey("jwk",t.privateKey);return{publicKey:Nc(yield Ps.exportKey("jwk",t.publicKey),r),privateKey:Ge(i.d)}})}(this.name,this.wireFormatLeadingByte)}catch(e){return d.printDebugError("Browser did not support generating ec key "+e.message),No(this.name)}case"node":return function(e){return I(this,null,function*(){let r=Qi.createECDH(kt[e]);return yield r.generateKeys(),{publicKey:new Uint8Array(r.getPublicKey()),privateKey:new Uint8Array(r.getPrivateKey())}})}(this.name);case"curve25519Legacy":{let{k:e,A:r}=yield co(l.publicKey.x25519),t=e.slice().reverse();return t[0]=127&t[0]|64,t[31]&=248,{publicKey:d.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),r]),privateKey:t}}case"ed25519Legacy":{let{seed:e,A:r}=yield Wa(l.publicKey.ed25519);return{publicKey:d.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),r]),privateKey:e}}default:return No(this.name)}})}};function di(n){return I(this,null,function*(){let e=new Ze(n),{oid:r,hash:t,cipher:i}=e,s=yield e.genKeyPair();return{oid:r,Q:s.publicKey,secret:d.leftPad(s.privateKey,e.payloadSize),hash:t,cipher:i}})}function Fc(n){return Mc[n.getName()].hash}function Lc(n,e,r,t){return I(this,null,function*(){let i={[l.curve.nistP256]:!0,[l.curve.nistP384]:!0,[l.curve.nistP521]:!0,[l.curve.secp256k1]:!0,[l.curve.curve25519Legacy]:n===l.publicKey.ecdh,[l.curve.brainpoolP256r1]:!0,[l.curve.brainpoolP384r1]:!0,[l.curve.brainpoolP512r1]:!0},s=e.getName();if(!i[s])return!1;if(s===l.curve.curve25519Legacy){let o=t.slice().reverse();return!(r.length<1||r[0]!==64)&&uo(l.publicKey.x25519,r.subarray(1),o)}let a=(yield d.getNobleCurve(l.publicKey.ecdsa,s)).getPublicKey(t,!1);return!!d.equalsUint8Array(a,r)})}function Sr(n,e){let{payloadSize:r,wireFormatLeadingByte:t,name:i}=n,s=i===l.curve.curve25519Legacy||i===l.curve.ed25519Legacy?r:2*r;if(e[0]!==t||e.length!==s+1)throw Error("Invalid point encoding")}function No(n){return I(this,null,function*(){let e=yield d.getNobleCurve(l.publicKey.ecdsa,n),{secretKey:r}=e.keygen();return{publicKey:e.getPublicKey(r,!1),privateKey:r}})}function Nc(n,e){let r=Ge(n.x),t=Ge(n.y),i=new Uint8Array(r.length+t.length+1);return i[0]=e,i.set(r,1),i.set(t,r.length+1),i}function ks(n,e,r){let t=n,i=r.slice(1,t+1),s=r.slice(t+1,2*t+1);return{kty:"EC",crv:e,x:Ue(i),y:Ue(s),ext:!0}}function Oc(n,e,r,t){let i=ks(n,e,r);return i.d=Ue(t),i}var Ri=d.getWebCrypto(),Hc=d.getNodeCrypto();function pa(n,e,r,t,i,s){return I(this,null,function*(){let a=new Ze(n);if(Sr(a,t),r&&!d.isStream(r)){let c={publicKey:t,privateKey:i};switch(a.type){case"web":try{return yield function(f,h,u,y){return I(this,null,function*(){let g=f.payloadSize,p=Oc(f.payloadSize,Kt[f.name],y.publicKey,y.privateKey),w=yield Ri.importKey("jwk",p,{name:"ECDSA",namedCurve:Kt[f.name],hash:{name:l.read(l.webHash,f.hash)}},!1,["sign"]),A=new Uint8Array(yield Ri.sign({name:"ECDSA",namedCurve:Kt[f.name],hash:{name:l.read(l.webHash,h)}},w,u));return{r:A.slice(0,g),s:A.slice(g,g<<1)}})}(a,e,r,c)}catch(f){if(a.name!=="nistP521"&&(f.name==="DataError"||f.name==="OperationError"))throw f;d.printDebugError("Browser did not support signing: "+f.message)}break;case"node":return function(f,h,u,y){return I(this,null,function*(){let g=d.nodeRequire("eckey-utils"),p=d.getNodeBuffer(),{privateKey:w}=g.generateDer({curveName:kt[f.name],privateKey:p.from(y)}),A=Hc.createSign(l.read(l.hash,h));A.write(u),A.end();let k=new Uint8Array(A.sign({key:w,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),S=f.payloadSize;return{r:k.subarray(0,S),s:k.subarray(S,S<<1)}})}(a,e,r,i)}}let o=(yield d.getNobleCurve(l.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:ke(o.r,"be",a.payloadSize),s:ke(o.s,"be",a.payloadSize)}})}function da(n,e,r,t,i,s){return I(this,null,function*(){let a=new Ze(n);Sr(a,i);let o=()=>I(null,null,function*(){return s[0]===0&&Oo(a,r,s.subarray(1),i)});if(t&&!d.isStream(t))switch(a.type){case"web":try{return(yield function(w,A,k,S,m){return I(this,arguments,function*(f,h,{r:u,s:y},g,p){let E=ks(f.payloadSize,Kt[f.name],p),D=yield Ri.importKey("jwk",E,{name:"ECDSA",namedCurve:Kt[f.name],hash:{name:l.read(l.webHash,f.hash)}},!1,["verify"]),R=d.concatUint8Array([u,y]).buffer;return Ri.verify({name:"ECDSA",namedCurve:Kt[f.name],hash:{name:l.read(l.webHash,h)}},D,R,g)})}(a,e,r,t,i))||o()}catch(c){if(a.name!=="nistP521"&&(c.name==="DataError"||c.name==="OperationError"))throw c;d.printDebugError("Browser did not support verifying: "+c.message)}break;case"node":return(yield function(w,A,k,S,m){return I(this,arguments,function*(f,h,{r:u,s:y},g,p){let E=d.nodeRequire("eckey-utils"),D=d.getNodeBuffer(),{publicKey:R}=E.generateDer({curveName:kt[f.name],publicKey:D.from(p)}),U=Hc.createVerify(l.read(l.hash,h));U.write(g),U.end();let B=d.concatUint8Array([u,y]);try{return U.verify({key:R,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},B)}catch{return!1}})}(a,e,r,t,i))||o()}return(yield Oo(a,r,s,i))||o()})}function Oo(n,e,r,t){return I(this,null,function*(){return(yield d.getNobleCurve(l.publicKey.ecdsa,n.name)).verify(d.concatUint8Array([e.r,e.s]),r,t,{lowS:!1})})}var H0=Object.freeze({__proto__:null,sign:pa,validateParams:function(n,e,r){return I(this,null,function*(){let t=new Ze(n);if(t.keyType!==l.publicKey.ecdsa)return!1;switch(t.type){case"web":case"node":{let i=Me(8),s=l.hash.sha256,a=yield Ut(s,i);try{let o=yield pa(n,s,i,e,r,a);return yield da(n,s,o,i,e,a)}catch{return!1}}default:return Lc(l.publicKey.ecdsa,n,e,r)}})},verify:da});function zc(n,e,r,t,i,s){return I(this,null,function*(){if(Sr(new Ze(n),t),ve(e)<ve(l.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");let{RS:a}=yield $a(l.publicKey.ed25519,e,0,t.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}})}function Gc(o,c,f,h,u,y){return I(this,arguments,function*(n,e,{r,s:t},i,s,a){if(Sr(new Ze(n),s),ve(e)<ve(l.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");let g=d.concatUint8Array([r,t]);return eo(l.publicKey.ed25519,e,{RS:g},0,s.subarray(1),a)})}function jc(n,e,r){return I(this,null,function*(){return n.getName()===l.curve.ed25519Legacy&&!(e.length<1||e[0]!==64)&&to(l.publicKey.ed25519,e.subarray(1),r)})}var z0=Object.freeze({__proto__:null,sign:zc,validateParams:jc,verify:Gc});function G0(n){let e=n.length;if(e>0){let r=n[e-1];if(r>=1){let t=n.subarray(e-r),i=new Uint8Array(r).fill(r);if(d.equalsUint8Array(t,i))return n.subarray(0,e-r)}}throw Error("Invalid padding")}function Vc(n,e,r,t){return d.concatUint8Array([e.write(),new Uint8Array([n]),r.write(),d.stringToUint8Array("Anonymous Sender    "),t])}function qc(n,e,r,t,i=!1,s=!1){return I(this,null,function*(){let a;if(i){for(a=0;a<e.length&&e[a]===0;a++);e=e.subarray(a)}if(s){for(a=e.length-1;a>=0&&e[a]===0;a--);e=e.subarray(0,a+1)}return(yield Ut(n,d.concatUint8Array([new Uint8Array([0,0,0,1]),e,t]))).subarray(0,r)})}function j0(n,e){return I(this,null,function*(){switch(n.type){case"curve25519Legacy":{let{sharedSecret:r,ephemeralPublicKey:t}=yield ms(l.publicKey.x25519,e.subarray(1));return{publicKey:d.concatUint8Array([new Uint8Array([n.wireFormatLeadingByte]),t]),sharedKey:r}}case"web":if(n.web&&d.getWebCrypto())try{return yield function(r,t){return I(this,null,function*(){let i=d.getWebCrypto(),s=ks(r.payloadSize,r.web,t),a=i.generateKey({name:"ECDH",namedCurve:r.web},!0,["deriveKey","deriveBits"]),o=i.importKey("jwk",s,{name:"ECDH",namedCurve:r.web},!1,[]);[a,o]=yield Promise.all([a,o]);let c=i.deriveBits({name:"ECDH",namedCurve:r.web,public:o},a.privateKey,r.sharedSize),f=i.exportKey("jwk",a.publicKey);[c,f]=yield Promise.all([c,f]);let h=new Uint8Array(c);return{publicKey:new Uint8Array(Nc(f,r.wireFormatLeadingByte)),sharedKey:h}})}(n,e)}catch(r){return d.printDebugError(r),zo(n,e)}break;case"node":return function(r,t){return I(this,null,function*(){let i=d.getNodeCrypto(),s=i.createECDH(r.node);s.generateKeys();let a=new Uint8Array(s.computeSecret(t));return{publicKey:new Uint8Array(s.getPublicKey()),sharedKey:a}})}(n,e);default:return zo(n,e)}})}function _c(n,e,r,t,i){return I(this,null,function*(){let s=function(y){let g=8-y.length%8,p=new Uint8Array(y.length+g).fill(g);return p.set(y),p}(r),a=new Ze(n);Sr(a,t);let{publicKey:o,sharedKey:c}=yield j0(a,t),f=Vc(l.publicKey.ecdh,n,e,i),{keySize:h}=he(e.cipher),u=yield qc(e.hash,c,h,f);return{publicKey:o,wrappedKey:yield la(e.cipher,u,s)}})}function V0(n,e,r,t){return I(this,null,function*(){if(t.length!==n.payloadSize){let i=new Uint8Array(n.payloadSize);i.set(t,n.payloadSize-t.length),t=i}switch(n.type){case"curve25519Legacy":{let i=t.slice().reverse();return{secretKey:i,sharedKey:yield bs(l.publicKey.x25519,e.subarray(1),r.subarray(1),i)}}case"web":if(n.web&&d.getWebCrypto())try{return yield function(i,s,a,o){return I(this,null,function*(){let c=d.getWebCrypto(),f=Oc(i.payloadSize,i.web,a,o),h=c.importKey("jwk",f,{name:"ECDH",namedCurve:i.web},!0,["deriveKey","deriveBits"]),u=ks(i.payloadSize,i.web,s),y=c.importKey("jwk",u,{name:"ECDH",namedCurve:i.web},!0,[]);[h,y]=yield Promise.all([h,y]);let g=c.deriveBits({name:"ECDH",namedCurve:i.web,public:y},h,i.sharedSize),p=c.exportKey("jwk",h);[g,p]=yield Promise.all([g,p]);let w=new Uint8Array(g);return{secretKey:Ge(p.d),sharedKey:w}})}(n,e,r,t)}catch(i){return d.printDebugError(i),Ho(n,e,t)}break;case"node":return function(i,s,a){return I(this,null,function*(){let o=d.getNodeCrypto(),c=o.createECDH(i.node);c.setPrivateKey(a);let f=new Uint8Array(c.computeSecret(s));return{secretKey:new Uint8Array(c.getPrivateKey()),sharedKey:f}})}(n,e,t);default:return Ho(n,e,t)}})}function Yc(n,e,r,t,i,s,a){return I(this,null,function*(){let o=new Ze(n);Sr(o,i),Sr(o,r);let{sharedKey:c}=yield V0(o,r,i,s),f=Vc(l.publicKey.ecdh,n,e,a),{keySize:h}=he(e.cipher),u;for(let y=0;y<3;y++)try{let g=yield qc(e.hash,c,h,f,y===1,y===2);return G0(yield ya(e.cipher,g,t))}catch(g){u=g}throw u})}function Ho(n,e,r){return I(this,null,function*(){return{secretKey:r,sharedKey:(yield d.getNobleCurve(l.publicKey.ecdh,n.name)).getSharedSecret(r,e).subarray(1)}})}function zo(n,e){return I(this,null,function*(){let r=yield d.getNobleCurve(l.publicKey.ecdh,n.name),{publicKey:t,privateKey:i}=yield n.genKeyPair();return{publicKey:t,sharedKey:r.getSharedSecret(i,e).subarray(1)}})}var q0=Object.freeze({__proto__:null,CurveWithOID:Ze,ecdh:Object.freeze({__proto__:null,decrypt:Yc,encrypt:_c,validateParams:function(n,e,r){return I(this,null,function*(){return Lc(l.publicKey.ecdh,n,e,r)})}}),ecdhX:O0,ecdsa:H0,eddsa:x0,eddsaLegacy:z0,generate:di,getPreferredHashAlgo:Fc}),Ai=BigInt(0),vn=BigInt(1),Ti=class{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){let r=e[0];if(e.length>=1+r)return this.data=e.subarray(1,1+r),1+this.data.length}throw Error("Invalid symmetric key")}write(){return d.concatUint8Array([new Uint8Array([this.data.length]),this.data])}},Mi=class{constructor(e){if(e){let{hash:r,cipher:t}=e;this.hash=r,this.cipher=t}else this.hash=null,this.cipher=null}read(e){if(e.length<4||e[0]!==3||e[1]!==1)throw new ie("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}},Fi=class n{static fromObject({wrappedKey:e,algorithm:r}){let t=new n;return t.wrappedKey=e,t.algorithm=r,t}read(e){let r=0,t=e[r++];this.algorithm=t%2?e[r++]:null,t-=t%2,this.wrappedKey=d.readExactSubarray(e,r,r+t),r+=t}write(){return d.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}};function _0(n,e,r,t,i){return I(this,null,function*(){switch(n){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:{let{n:s,e:a}=r;return{c:yield K0(t,s,a)}}case l.publicKey.elgamal:{let{p:s,g:a,y:o}=r;return function(c,f,h,u){return I(this,null,function*(){f=Z(f),h=Z(h),u=Z(u);let y=Z(pc(c,qe(f))),g=cr(ir,f-ir);return{c1:ke(Ce(h,g,f)),c2:ke(te(Ce(u,g,f)*y,f))}})}(t,s,a,o)}case l.publicKey.ecdh:{let{oid:s,Q:a,kdfParams:o}=r,{publicKey:c,wrappedKey:f}=yield _c(s,o,t,a,i);return{V:c,C:new Ti(f)}}case l.publicKey.x25519:case l.publicKey.x448:{if(e&&!d.isAES(e))throw Error("X25519 and X448 keys can only encrypt AES session keys");let{A:s}=r,{ephemeralPublicKey:a,wrappedKey:o}=yield Rc(n,t,s);return{ephemeralPublicKey:a,C:Fi.fromObject({algorithm:e,wrappedKey:o})}}default:return[]}})}function Y0(n,e,r,t,i,s){return I(this,null,function*(){switch(n){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:{let{c:a}=t,{n:o,e:c}=e,{d:f,p:h,q:u,u:y}=r;return C0(a,o,c,f,h,u,y,s)}case l.publicKey.elgamal:{let{c1:a,c2:o}=t;return function(c,f,h,u,y){return I(this,null,function*(){return c=Z(c),f=Z(f),h=Z(h),dc(ke(te(tn(Ce(c,u=Z(u),h),h)*f,h),"be",qe(h)),y)})}(a,o,e.p,r.x,s)}case l.publicKey.ecdh:{let{oid:a,Q:o,kdfParams:c}=e,{d:f}=r,{V:h,C:u}=t;return Yc(a,c,h,u.data,o,f,i)}case l.publicKey.x25519:case l.publicKey.x448:{let{A:a}=e,{k:o}=r,{ephemeralPublicKey:c,C:f}=t;if(f.algorithm!==null&&!d.isAES(f.algorithm))throw Error("AES session key expected");return Tc(n,c,f.wrappedKey,a,o)}default:throw Error("Unknown public key encryption algorithm.")}})}function Go(n,e,r){let t=0;switch(n){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{let i=d.readMPI(e.subarray(t));t+=i.length+2;let s=d.readMPI(e.subarray(t));t+=s.length+2;let a=d.readMPI(e.subarray(t));t+=a.length+2;let o=d.readMPI(e.subarray(t));return t+=o.length+2,{read:t,privateParams:{d:i,p:s,q:a,u:o}}}case l.publicKey.dsa:case l.publicKey.elgamal:{let i=d.readMPI(e.subarray(t));return t+=i.length+2,{read:t,privateParams:{x:i}}}case l.publicKey.ecdsa:case l.publicKey.ecdh:{let i=Vr(n,r.oid),s=d.readMPI(e.subarray(t));return t+=s.length+2,s=d.leftPad(s,i),{read:t,privateParams:{d:s}}}case l.publicKey.eddsaLegacy:{let i=Vr(n,r.oid);if(r.oid.getName()!==l.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=d.readMPI(e.subarray(t));return t+=s.length+2,s=d.leftPad(s,i),{read:t,privateParams:{seed:s}}}case l.publicKey.ed25519:case l.publicKey.ed448:{let i=Vr(n),s=d.readExactSubarray(e,t,t+i);return t+=s.length,{read:t,privateParams:{seed:s}}}case l.publicKey.x25519:case l.publicKey.x448:{let i=Vr(n),s=d.readExactSubarray(e,t,t+i);return t+=s.length,{read:t,privateParams:{k:s}}}default:throw new ie("Unknown public key encryption algorithm.")}}function nn(n,e){let r=new Set([l.publicKey.ed25519,l.publicKey.x25519,l.publicKey.ed448,l.publicKey.x448]),t=Object.keys(e).map(i=>{let s=e[i];return d.isUint8Array(s)?r.has(n)?s:d.uint8ArrayToMPI(s):s.write()});return d.concatUint8Array(t)}function Z0(n,e,r){switch(n){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:return function(t,i){return I(this,null,function*(){if(i=BigInt(i),d.getWebCrypto()){let f={name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:ke(i),hash:{name:"SHA-1"}},h=yield rn.generateKey(f,!0,["sign","verify"]);return xo(yield rn.exportKey("jwk",h.privateKey),i)}if(d.getNodeCrypto()){let f={modulusLength:t,publicExponent:ia(i),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},h=yield new Promise((u,y)=>{Ir.generateKeyPair("rsa",f,(g,p,w)=>{g?y(g):u(w)})});return xo(h,i)}let s,a,o;do a=Po(t-(t>>1),i,40),s=Po(t>>1,i,40),o=s*a;while(Xr(o)!==t);let c=(s-ur)*(a-ur);return a<s&&([s,a]=[a,s]),{n:ke(o),e:ke(i),d:ke(tn(i,c)),p:ke(s),q:ke(a),u:ke(tn(s,a))}})}(e,65537).then(({n:t,e:i,d:s,p:a,q:o,u:c})=>({privateParams:{d:s,p:a,q:o,u:c},publicParams:{n:t,e:i}}));case l.publicKey.ecdsa:return di(r).then(({oid:t,Q:i,secret:s})=>({privateParams:{d:s},publicParams:{oid:new Ot(t),Q:i}}));case l.publicKey.eddsaLegacy:return di(r).then(({oid:t,Q:i,secret:s})=>({privateParams:{seed:s},publicParams:{oid:new Ot(t),Q:i}}));case l.publicKey.ecdh:return di(r).then(({oid:t,Q:i,secret:s,hash:a,cipher:o})=>({privateParams:{d:s},publicParams:{oid:new Ot(t),Q:i,kdfParams:new Mi({hash:a,cipher:o})}}));case l.publicKey.ed25519:case l.publicKey.ed448:return Wa(n).then(({A:t,seed:i})=>({privateParams:{seed:i},publicParams:{A:t}}));case l.publicKey.x25519:case l.publicKey.x448:return co(n).then(({A:t,k:i})=>({privateParams:{k:i},publicParams:{A:t}}));case l.publicKey.dsa:case l.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}}function J0(n,e,r){return I(this,null,function*(){if(!e||!r)throw Error("Missing key parameters");switch(n){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{let{n:t,e:i}=e,{d:s,p:a,q:o,u:c}=r;return function(f,h,u,y,g,p){return I(this,null,function*(){if(f=Z(f),(y=Z(y))*(g=Z(g))!==f)return!1;let w=BigInt(2);if(te(y*(p=Z(p)),g)!==BigInt(1))return!1;h=Z(h),u=Z(u);let A=cr(w,w<<BigInt(Math.floor(Xr(f)/3))),k=A*u*h;return!(te(k,y-ur)!==A||te(k,g-ur)!==A)})}(t,i,s,a,o,c)}case l.publicKey.dsa:{let{p:t,q:i,g:s,y:a}=e,{x:o}=r;return function(c,f,h,u,y){return I(this,null,function*(){if(c=Z(c),f=Z(f),h=Z(h),u=Z(u),h<=vn||h>=c||te(c-vn,f)!==Ai||Ce(h,f,c)!==vn)return!1;let g=BigInt(Xr(f));if(g<BigInt(150)||!gc(f,null,32))return!1;y=Z(y);let p=BigInt(2);return u===Ce(h,f*cr(p<<g-vn,p<<g)+y,c)})}(t,i,s,a,o)}case l.publicKey.elgamal:{let{p:t,g:i,y:s}=e,{x:a}=r;return function(o,c,f,h){return I(this,null,function*(){if(o=Z(o),c=Z(c),f=Z(f),c<=ir||c>=o)return!1;let u=BigInt(Xr(o));if(u<BigInt(1023)||Ce(c,o-ir,o)!==ir)return!1;let y=c,g=BigInt(1),p=BigInt(2),w=p<<BigInt(17);for(;g<w;){if(y=te(y*c,o),y===ir)return!1;g++}h=Z(h);let A=cr(p<<u-ir,p<<u);return f===Ce(c,(o-ir)*A+h,o)})}(t,i,s,a)}case l.publicKey.ecdsa:case l.publicKey.ecdh:{let t=q0[l.read(l.publicKey,n)],{oid:i,Q:s}=e,{d:a}=r;return t.validateParams(i,s,a)}case l.publicKey.eddsaLegacy:{let{Q:t,oid:i}=e,{seed:s}=r;return jc(i,t,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{let{A:t}=e,{seed:i}=r;return to(n,t,i)}case l.publicKey.x25519:case l.publicKey.x448:{let{A:t}=e,{k:i}=r;return uo(n,t,i)}default:throw Error("Unknown public key algorithm.")}})}function Aa(n){let{keySize:e}=he(n);return Me(e)}function Ds(n){try{n.getName()}catch{throw new ie("Unknown curve OID")}}function Vr(n,e){switch(n){case l.publicKey.ecdsa:case l.publicKey.ecdh:case l.publicKey.eddsaLegacy:return new Ze(e).payloadSize;case l.publicKey.ed25519:case l.publicKey.ed448:return gs(n);case l.publicKey.x25519:case l.publicKey.x448:return ws(n);default:throw Error("Unknown elliptic algo")}}var wi=d.getWebCrypto(),Ln=d.getNodeCrypto(),gr=Ln?Ln.getCiphers():[],Li={idea:gr.includes("idea-cfb")?"idea-cfb":void 0,tripledes:gr.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:gr.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:gr.includes("bf-cfb")?"bf-cfb":void 0,aes128:gr.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:gr.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:gr.includes("aes-256-cfb")?"aes-256-cfb":void 0};function X0(n){return I(this,null,function*(){let{blockSize:e}=he(n),r=yield Me(e),t=new Uint8Array([r[r.length-2],r[r.length-1]]);return d.concat([r,t])})}function ho(n,e,r,t,i){return I(this,null,function*(){let s=l.read(l.symmetric,n);if(d.getNodeCrypto()&&Li[s])return function(u,y,g,p){let w=l.read(l.symmetric,u),A=new Ln.createCipheriv(Li[w],y,p);return me(g,k=>new Uint8Array(A.update(k)))}(n,e,r,t);if(d.isAES(n))return function(u,y,g,p){return I(this,null,function*(){if(wi&&(yield Ni.isSupported(u))){let w=new Ni(u,y,p);return d.isStream(g)?me(g,A=>w.encryptChunk(A),()=>w.finish()):w.encrypt(g)}if(d.isStream(g)){let w=new Oi(!0,u,y,p);return me(g,A=>w.processChunk(A),()=>w.finish())}return Cc(y,p).encrypt(g)})}(n,e,r,t);let a=new(yield Qc(n))(e),o=a.blockSize,c=t.slice(),f=new Uint8Array,h=u=>{u&&(f=d.concatUint8Array([f,u]));let y=new Uint8Array(f.length),g,p=0;for(;u?f.length>=o:f.length;){let w=a.encrypt(c);for(g=0;g<o;g++)c[g]=f[g]^w[g],y[p++]=c[g];f=f.subarray(o)}return y.subarray(0,p)};return me(r,h,h)})}function fo(n,e,r,t){return I(this,null,function*(){let i=l.read(l.symmetric,n);if(Ln&&Li[i])return function(h,u,y,g){let p=l.read(l.symmetric,h),w=new Ln.createDecipheriv(Li[p],u,g);return me(y,A=>new Uint8Array(w.update(A)))}(n,e,r,t);if(d.isAES(n))return function(h,u,y,g){return I(this,null,function*(){if(d.isStream(y)){let p=new Oi(!1,h,u,g);return me(y,w=>p.processChunk(w),()=>p.finish())}return Cc(u,g).decrypt(y)})}(n,e,r,t);let s=new(yield Qc(n))(e),a=s.blockSize,o=t,c=new Uint8Array,f=h=>{h&&(c=d.concatUint8Array([c,h]));let u=new Uint8Array(c.length),y,g=0;for(;h?c.length>=a:c.length;){let p=s.encrypt(o);for(o=c.subarray(0,a),y=0;y<a;y++)u[g++]=o[y]^p[y];c=c.subarray(a)}return u.subarray(0,g)};return me(r,f,f)})}var Ni=class{constructor(e,r,t){let{blockSize:i}=he(e);this.key=r,this.prevBlock=t,this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i,this.zeroBlock=new Uint8Array(this.blockSize)}static isSupported(e){return I(this,null,function*(){let{keySize:r}=he(e);return wi.importKey("raw",new Uint8Array(r),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)})}_runCBC(e,r){return I(this,null,function*(){let t="AES-CBC";this.keyRef=this.keyRef||(yield wi.importKey("raw",this.key,t,!1,["encrypt"]));let i=yield wi.encrypt({name:t,iv:r||this.zeroBlock},this.keyRef,e);return new Uint8Array(i).subarray(0,e.length)})}encryptChunk(e){return I(this,null,function*(){let r=this.nextBlock.length-this.i,t=e.subarray(0,r);if(this.nextBlock.set(t,this.i),this.i+e.length>=2*this.blockSize){let s=(e.length-r)%this.blockSize,a=d.concatUint8Array([this.nextBlock,e.subarray(r,e.length-s)]),o=d.concatUint8Array([this.prevBlock,a.subarray(0,a.length-this.blockSize)]),c=yield this._runCBC(o);return ni(c,a),this.prevBlock=c.slice(-this.blockSize),s>0&&this.nextBlock.set(e.subarray(-s)),this.i=s,c}let i;if(this.i+=t.length,this.i===this.nextBlock.length){let s=this.nextBlock;i=yield this._runCBC(this.prevBlock),ni(i,s),this.prevBlock=i.slice(),this.i=0;let a=e.subarray(t.length);this.nextBlock.set(a,this.i),this.i+=a.length}else i=new Uint8Array;return i})}finish(){return I(this,null,function*(){let e;if(this.i===0)e=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);let r=this.nextBlock,t=yield this._runCBC(this.prevBlock);ni(t,r),e=t.subarray(0,r.length)}return this.clearSensitiveData(),e})}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}encrypt(e){return I(this,null,function*(){let r=(yield this._runCBC(d.concatUint8Array([new Uint8Array(this.blockSize),e]),this.iv)).subarray(0,e.length);return ni(r,e),this.clearSensitiveData(),r})}},Oi=class{constructor(e,r,t,i){this.forEncryption=e;let{blockSize:s}=he(r);this.key=Lo.expandKeyLE(t),i.byteOffset%4!=0&&(i=i.slice()),this.prevBlock=xs(i),this.nextBlock=new Uint8Array(s),this.i=0,this.blockSize=s}_runCFB(e){let r=xs(e),t=new Uint8Array(e.length),i=xs(t);for(let s=0;s+4<=i.length;s+=4){let{s0:a,s1:o,s2:c,s3:f}=Lo.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);i[s+0]=r[s+0]^a,i[s+1]=r[s+1]^o,i[s+2]=r[s+2]^c,i[s+3]=r[s+3]^f,this.prevBlock=(this.forEncryption?i:r).slice(s,s+4)}return t}processChunk(e){return I(this,null,function*(){let r=this.nextBlock.length-this.i,t=e.subarray(0,r);if(this.nextBlock.set(t,this.i),this.i+e.length>=2*this.blockSize){let s=(e.length-r)%this.blockSize,a=d.concatUint8Array([this.nextBlock,e.subarray(r,e.length-s)]),o=this._runCFB(a);return s>0&&this.nextBlock.set(e.subarray(-s)),this.i=s,o}let i;if(this.i+=t.length,this.i===this.nextBlock.length){i=this._runCFB(this.nextBlock),this.i=0;let s=e.subarray(t.length);this.nextBlock.set(s,this.i),this.i+=s.length}else i=new Uint8Array;return i})}finish(){return I(this,null,function*(){let e;return this.i===0?e=new Uint8Array:e=this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),e})}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}};function ni(n,e){let r=Math.min(n.length,e.length);for(let t=0;t<r;t++)n[t]=n[t]^e[t]}var xs=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),jo=d.getWebCrypto(),W0=d.getNodeCrypto(),kr=16;function Vo(n,e){let r=n.length-kr;for(let t=0;t<kr;t++)n[t+r]^=e[t];return n}var mi=new Uint8Array(kr);function $0(n){return I(this,null,function*(){let e=yield e3(n),r=d.double(yield e(mi)),t=d.double(r);return function(i){return I(this,null,function*(){return(yield e(function(s,a,o){if(s.length&&s.length%kr==0)return Vo(s,a);let c=new Uint8Array(s.length+(kr-s.length%kr));return c.set(s),c[s.length]=128,Vo(c,o)}(i,r,t))).subarray(-16)})}})}function e3(n){return I(this,null,function*(){if(d.getNodeCrypto())return function(e){return I(this,null,function*(){let r=new W0.createCipheriv("aes-"+8*n.length+"-cbc",n,mi).update(e);return new Uint8Array(r)})};if(d.getWebCrypto())try{return n=yield jo.importKey("raw",n,{name:"AES-CBC",length:8*n.length},!1,["encrypt"]),function(e){return I(this,null,function*(){let r=yield jo.encrypt({name:"AES-CBC",iv:mi,length:128},n,e);return new Uint8Array(r).subarray(0,r.byteLength-kr)})}}catch(e){if(e.name!=="NotSupportedError"&&(n.length!==24||e.name!=="OperationError"))throw e;d.printDebugError("Browser did not support operation: "+e.message)}return function(e){return I(this,null,function*(){return fa(n,mi,{disablePadding:!0}).encrypt(e)})}})}var qo=d.getWebCrypto(),t3=d.getNodeCrypto(),r3=d.getNodeBuffer(),Jn=16,bi=Jn,_o=new Uint8Array(Jn),wa=new Uint8Array(Jn);wa[15]=1;var ma=new Uint8Array(Jn);function n3(n){return I(this,null,function*(){let e=yield $0(n);return function(r,t){return e(d.concatUint8Array([r,t]))}})}function i3(n){return I(this,null,function*(){if(d.getNodeCrypto())return function(e,r){return I(this,null,function*(){let t=new t3.createCipheriv("aes-"+8*n.length+"-ctr",n,r),i=r3.concat([t.update(e),t.final()]);return new Uint8Array(i)})};if(d.getWebCrypto())try{let e=yield qo.importKey("raw",n,{name:"AES-CTR",length:8*n.length},!1,["encrypt"]);return function(r,t){return I(this,null,function*(){let i=yield qo.encrypt({name:"AES-CTR",counter:t,length:128},e,r);return new Uint8Array(i)})}}catch(e){if(e.name!=="NotSupportedError"&&(n.length!==24||e.name!=="OperationError"))throw e;d.printDebugError("Browser did not support operation: "+e.message)}return function(e,r){return I(this,null,function*(){return M0(n,r).encrypt(e)})}})}function Bn(n,e){return I(this,null,function*(){if(n!==l.symmetric.aes128&&n!==l.symmetric.aes192&&n!==l.symmetric.aes256)throw Error("EAX mode supports only AES cipher");let[r,t]=yield Promise.all([n3(e),i3(e)]);return{encrypt:function(i,s,a){return I(this,null,function*(){let[o,c]=yield Promise.all([r(_o,s),r(wa,a)]),f=yield t(i,o),h=yield r(ma,f);for(let u=0;u<bi;u++)h[u]^=c[u]^o[u];return d.concatUint8Array([f,h])})},decrypt:function(i,s,a){return I(this,null,function*(){if(i.length<bi)throw Error("Invalid EAX ciphertext");let o=i.subarray(0,-16),c=i.subarray(-16),[f,h,u]=yield Promise.all([r(_o,s),r(wa,a),r(ma,o)]),y=u;for(let g=0;g<bi;g++)y[g]^=h[g]^f[g];if(!d.equalsUint8Array(c,y))throw Error("Authentication tag mismatch");return yield t(o,f)})}}})}ma[15]=2,Bn.getNonce=function(n,e){let r=n.slice();for(let t=0;t<e.length;t++)r[8+t]^=e[t];return r},Bn.blockLength=Jn,Bn.ivLength=16,Bn.tagLength=bi;var Xe=16,ba=16;function Yo(n){let e=0;for(let r=1;!(n&r);r<<=1)e++;return e}function Ne(n,e){for(let r=0;r<n.length;r++)n[r]^=e[r];return n}function ii(n,e){return Ne(n.slice(),e)}var ln=new Uint8Array(Xe),s3=new Uint8Array([1]);function In(n,e){return I(this,null,function*(){let{keySize:r}=he(n);if(!d.isAES(n)||e.length!==r)throw Error("Unexpected algorithm or key size");let t=0,i=c=>fa(e,ln,{disablePadding:!0}).encrypt(c),s=c=>fa(e,ln,{disablePadding:!0}).decrypt(c),a;function o(c,f,h,u){let y=f.length/Xe|0;(function(U,B){let b=d.nbits(Math.max(U.length,B.length)/Xe|0)-1;for(let C=t+1;C<=b;C++)a[C]=d.double(a[C-1]);t=b})(f,u);let g=d.concatUint8Array([ln.subarray(0,15-h.length),s3,h]),p=63&g[15];g[15]&=192;let w=i(g),A=d.concatUint8Array([w,ii(w.subarray(0,8),w.subarray(1,9))]),k=d.shiftRight(A.subarray(0+(p>>3),17+(p>>3)),8-(7&p)).subarray(1),S=new Uint8Array(Xe),m=new Uint8Array(f.length+ba),E,D=0;for(E=0;E<y;E++)Ne(k,a[Yo(E+1)]),m.set(Ne(c(ii(k,f)),k),D),Ne(S,c===i?f:m.subarray(D)),f=f.subarray(Xe),D+=Xe;if(f.length){Ne(k,a.x);let U=i(k);m.set(ii(f,U),D);let B=new Uint8Array(Xe);B.set(c===i?f:m.subarray(D,-16),0),B[f.length]=128,Ne(S,B),D+=f.length}let R=Ne(i(Ne(Ne(S,k),a.$)),function(U){if(!U.length)return ln;let B=U.length/Xe|0,b=new Uint8Array(Xe),C=new Uint8Array(Xe);for(let v=0;v<B;v++)Ne(b,a[Yo(v+1)]),Ne(C,i(ii(b,U))),U=U.subarray(Xe);if(U.length){Ne(b,a.x);let v=new Uint8Array(Xe);v.set(U,0),v[U.length]=128,Ne(v,b),Ne(C,i(v))}return C}(u));return m.set(R,D),m}return function(){let c=i(ln),f=d.double(c);a=[],a[0]=d.double(f),a.x=c,a.$=f}(),{encrypt:function(c,f,h){return I(this,null,function*(){return o(i,c,f,h)})},decrypt:function(c,f,h){return I(this,null,function*(){if(c.length<ba)throw Error("Invalid OCB ciphertext");let u=c.subarray(-16);c=c.subarray(0,-16);let y=o(s,c,f,h);if(d.equalsUint8Array(u,y.subarray(-16)))return y.subarray(0,-16);throw Error("Authentication tag mismatch")})}}})}In.getNonce=function(n,e){let r=n.slice();for(let t=0;t<e.length;t++)r[7+t]^=e[t];return r},In.blockLength=Xe,In.ivLength=15,In.tagLength=ba;var Qs=d.getWebCrypto(),Zo=d.getNodeCrypto(),Jo=d.getNodeBuffer(),ki=16,Rs="AES-GCM";function qr(n,e){return I(this,null,function*(){if(n!==l.symmetric.aes128&&n!==l.symmetric.aes192&&n!==l.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(d.getNodeCrypto())return{encrypt:function(s,a){return I(this,arguments,function*(r,t,i=new Uint8Array){let o=new Zo.createCipheriv("aes-"+8*e.length+"-gcm",e,t);o.setAAD(i);let c=Jo.concat([o.update(r),o.final(),o.getAuthTag()]);return new Uint8Array(c)})},decrypt:function(s,a){return I(this,arguments,function*(r,t,i=new Uint8Array){let o=new Zo.createDecipheriv("aes-"+8*e.length+"-gcm",e,t);o.setAAD(i),o.setAuthTag(r.slice(r.length-ki,r.length));let c=Jo.concat([o.update(r.slice(0,r.length-ki)),o.final()]);return new Uint8Array(c)})}};if(d.getWebCrypto())try{let r=yield Qs.importKey("raw",e,{name:Rs},!1,["encrypt","decrypt"]),t=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:function(o,c){return I(this,arguments,function*(i,s,a=new Uint8Array){if(t&&!i.length)return ri(e,s,a).encrypt(i);let f=yield Qs.encrypt({name:Rs,iv:s,additionalData:a,tagLength:128},r,i);return new Uint8Array(f)})},decrypt:function(o,c){return I(this,arguments,function*(i,s,a=new Uint8Array){if(t&&i.length===ki)return ri(e,s,a).decrypt(i);try{let f=yield Qs.decrypt({name:Rs,iv:s,additionalData:a,tagLength:128},r,i);return new Uint8Array(f)}catch(f){if(f.name==="OperationError")throw Error("Authentication tag mismatch")}})}}}catch(r){if(r.name!=="NotSupportedError"&&(e.length!==24||r.name!=="OperationError"))throw r;d.printDebugError("Browser did not support operation: "+r.message)}return{encrypt:function(r,t,i){return I(this,null,function*(){return ri(e,t,i).encrypt(r)})},decrypt:function(r,t,i){return I(this,null,function*(){return ri(e,t,i).decrypt(r)})}}})}function Er(n,e=!1){switch(n){case l.aead.eax:return Bn;case l.aead.ocb:return In;case l.aead.gcm:return qr;case l.aead.experimentalGCM:if(!e)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return qr;default:throw Error("Unsupported AEAD mode")}}function a3(n,e,r,t,i,s){return I(this,null,function*(){switch(n){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{let{n:a,e:o}=t;return S0(e,i,d.leftPad(r.s,a.length),a,o,s)}case l.publicKey.dsa:{let{g:a,p:o,q:c,y:f}=t,{r:h,s:u}=r;return function(y,g,p,w,A,k,S,m){return I(this,null,function*(){if(g=Z(g),p=Z(p),k=Z(k),S=Z(S),A=Z(A),m=Z(m),g<=Ai||g>=S||p<=Ai||p>=S)return d.printDebug("invalid DSA Signature"),!1;let E=te(Z(w.subarray(0,qe(S))),S),D=tn(p,S);if(D===Ai)return d.printDebug("invalid DSA Signature"),!1;A=te(A,k),m=te(m,k);let R=te(E*D,S),U=te(g*D,S);return te(te(Ce(A,R,k)*Ce(m,U,k),k),S)===g})}(0,h,u,s,a,o,c,f)}case l.publicKey.ecdsa:{let{oid:a,Q:o}=t,c=new Ze(a).payloadSize;return da(a,e,{r:d.leftPad(r.r,c),s:d.leftPad(r.s,c)},i,o,s)}case l.publicKey.eddsaLegacy:{let{oid:a,Q:o}=t,c=new Ze(a).payloadSize;return Gc(a,e,{r:d.leftPad(r.r,c),s:d.leftPad(r.s,c)},0,o,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{let{A:a}=t;return eo(n,e,r,0,a,s)}default:throw Error("Unknown signature algorithm.")}})}function o3(n,e,r,t,i,s){return I(this,null,function*(){if(!r||!t)throw Error("Missing key parameters");switch(n){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{let{n:a,e:o}=r,{d:c,p:f,q:h,u}=t;return{s:yield I0(e,i,a,o,c,f,h,u,s)}}case l.publicKey.dsa:{let{g:a,p:o,q:c}=r,{x:f}=t;return function(h,u,y,g,p,w){return I(this,null,function*(){let A=BigInt(0),k,S,m,E;g=Z(g),p=Z(p),y=Z(y),w=Z(w),y=te(y,g),w=te(w,p);let D=te(Z(u.subarray(0,qe(p))),p);for(;;){if(k=cr(vn,p),S=te(Ce(y,k,g),p),S===A)continue;let R=te(w*S,p);if(E=te(D+R,p),m=te(tn(k,p)*E,p),m!==A)break}return{r:ke(S,"be",qe(g)),s:ke(m,"be",qe(g))}})}(0,s,a,o,c,f)}case l.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case l.publicKey.ecdsa:{let{oid:a,Q:o}=r,{d:c}=t;return pa(a,e,i,o,c,s)}case l.publicKey.eddsaLegacy:{let{oid:a,Q:o}=r,{seed:c}=t;return zc(a,e,0,o,c,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{let{A:a}=r,{seed:o}=t;return $a(n,e,0,a,o,s)}default:throw Error("Unknown signature algorithm.")}})}qr.getNonce=function(n,e){let r=n.slice();for(let t=0;t<e.length;t++)r[4+t]^=e[t];return r},qr.blockLength=16,qr.ivLength=12,qr.tagLength=ki;var Hi=class n extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.name="Argon2OutOfMemoryError"}},si,yn,ka=class{constructor(e=q){let{passes:r,parallelism:t,memoryExponent:i}=e.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=r,this.p=t,this.encodedM=i}generateSalt(){this.salt=Me(16)}read(e){let r=0;return this.salt=e.subarray(r,r+16),r+=16,this.t=e[r++],this.p=e[r++],this.encodedM=e[r++],r}write(){let e=[new Uint8Array([l.write(l.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return d.concatUint8Array(e)}produceKey(e,r){return I(this,null,function*(){let t=2<<this.encodedM-1;try{si=si||(yield Promise.resolve().then(function(){return Bh})).default,yn=yn||si();let i=yield yn,s=i({version:19,type:2,password:d.encodeUTF8(e),salt:this.salt,tagLength:r,memorySize:t,parallelism:this.p,passes:this.t});return t>1048576&&(yn=si(),yn.catch(()=>{})),s}catch(i){throw i.message&&(i.message.includes("Unable to grow instance memory")||i.message.includes("failed to grow memory")||i.message.includes("WebAssembly.Memory.grow")||i.message.includes("Out of memory"))?new Hi("Could not allocate required memory for Argon2"):i}})}},Ea=class{constructor(e,r=q){this.algorithm=l.hash.sha256,this.type=l.read(l.s2k,e),this.c=r.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=Me(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let r=0;switch(this.algorithm=e[r++],this.type){case"simple":break;case"salted":this.salt=e.subarray(r,r+8),r+=8;break;case"iterated":this.salt=e.subarray(r,r+8),r+=8,this.c=e[r++];break;case"gnu":if(d.uint8ArrayToString(e.subarray(r,r+3))!=="GNU")throw new ie("Unknown s2k type.");if(r+=3,1e3+e[r++]!==1001)throw new ie("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new ie("Unknown s2k type.")}return r}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...d.stringToUint8Array("GNU"),1]);let e=[new Uint8Array([l.write(l.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return d.concatUint8Array(e)}produceKey(e,r){return I(this,null,function*(){e=d.encodeUTF8(e);let t=[],i=0,s=0;for(;i<r;){let a;switch(this.type){case"simple":a=d.concatUint8Array([new Uint8Array(s),e]);break;case"salted":a=d.concatUint8Array([new Uint8Array(s),this.salt,e]);break;case"iterated":{let c=d.concatUint8Array([this.salt,e]),f=c.length,h=Math.max(this.getCount(),f);a=new Uint8Array(s+h),a.set(c,s);for(let u=s+f;u<h;u+=f,f*=2)a.copyWithin(u,s,u);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}let o=yield Ut(this.algorithm,a);t.push(o),i+=o.length,s++}return d.concatUint8Array(t).subarray(0,r)})}},c3=new Set([l.s2k.argon2,l.s2k.iterated]);function zi(n,e=q){switch(n){case l.s2k.argon2:return new ka(e);case l.s2k.iterated:case l.s2k.gnu:case l.s2k.salted:case l.s2k.simple:return new Ea(n,e);default:throw new ie("Unsupported S2K type")}}function Zc(n){let{s2kType:e}=n;if(!c3.has(e))throw Error("The provided `config.s2kType` value is not allowed");return zi(e,n)}var be=Uint8Array,et=Uint16Array,lo=Int32Array,Es=new be([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vs=new be([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),va=new be([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Jc=function(n,e){for(var r=new et(31),t=0;t<31;++t)r[t]=e+=1<<n[t-1];var i=new lo(r[30]);for(t=1;t<30;++t)for(var s=r[t];s<r[t+1];++s)i[s]=s-r[t]<<5|t;return{b:r,r:i}},Xc=Jc(Es,2),Wc=Xc.b,Ba=Xc.r;Wc[28]=258,Ba[258]=28;for(Ts=Jc(vs,0),$c=Ts.b,Ia=Ts.r,Gi=new et(32768),ce=0;ce<32768;++ce)_t=(43690&ce)>>1|(21845&ce)<<1,_t=(61680&(_t=(52428&_t)>>2|(13107&_t)<<2))>>4|(3855&_t)<<4,Gi[ce]=((65280&_t)>>8|(255&_t)<<8)>>1;var _t,Ts,$c,Ia,Gi,ce,Ct=function(n,e,r){for(var t=n.length,i=0,s=new et(e);i<t;++i)n[i]&&++s[n[i]-1];var a,o=new et(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;if(r){a=new et(1<<e);var c=15-e;for(i=0;i<t;++i)if(n[i])for(var f=i<<4|n[i],h=e-n[i],u=o[n[i]-1]++<<h,y=u|(1<<h)-1;u<=y;++u)a[Gi[u]>>c]=f}else for(a=new et(t),i=0;i<t;++i)n[i]&&(a[i]=Gi[o[n[i]-1]++]>>15-n[i]);return a},fr=new be(288);for(ce=0;ce<144;++ce)fr[ce]=8;for(ce=144;ce<256;++ce)fr[ce]=9;for(ce=256;ce<280;++ce)fr[ce]=7;for(ce=280;ce<288;++ce)fr[ce]=8;var Nn=new be(32);for(ce=0;ce<32;++ce)Nn[ce]=5;var u3=Ct(fr,9,0),h3=Ct(fr,9,1),f3=Ct(Nn,5,0),l3=Ct(Nn,5,1),Ms=function(n){for(var e=n[0],r=1;r<n.length;++r)n[r]>e&&(e=n[r]);return e},ot=function(n,e,r){var t=e/8|0;return(n[t]|n[t+1]<<8)>>(7&e)&r},Fs=function(n,e){var r=e/8|0;return(n[r]|n[r+1]<<8|n[r+2]<<16)>>(7&e)},yo=function(n){return(n+7)/8|0},Sn=function(n,e,r){return(e==null||e<0)&&(e=0),(r==null||r>n.length)&&(r=n.length),new be(n.subarray(e,r))},y3=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Se=function(n,e,r){var t=Error(e||y3[n]);if(t.code=n,Error.captureStackTrace&&Error.captureStackTrace(t,Se),!r)throw t;return t},xt=function(n,e,r){r<<=7&e;var t=e/8|0;n[t]|=r,n[t+1]|=r>>8},gn=function(n,e,r){r<<=7&e;var t=e/8|0;n[t]|=r,n[t+1]|=r>>8,n[t+2]|=r>>16},Ls=function(n,e){for(var r=[],t=0;t<n.length;++t)n[t]&&r.push({s:t,f:n[t]});var i=r.length,s=r.slice();if(!i)return{t:t2,l:0};if(i==1){var a=new be(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(D,R){return D.f-R.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],f=0,h=1,u=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};h!=i-1;)o=r[r[f].f<r[u].f?f++:u++],c=r[f!=h&&r[f].f<r[u].f?f++:u++],r[h++]={s:-1,f:o.f+c.f,l:o,r:c};var y=s[0].s;for(t=1;t<i;++t)s[t].s>y&&(y=s[t].s);var g=new et(y+1),p=Sa(r[h-1],g,0);if(p>e){t=0;var w=0,A=p-e,k=1<<A;for(s.sort(function(D,R){return g[R.s]-g[D.s]||D.f-R.f});t<i;++t){var S=s[t].s;if(!(g[S]>e))break;w+=k-(1<<p-g[S]),g[S]=e}for(w>>=A;w>0;){var m=s[t].s;g[m]<e?w-=1<<e-g[m]++-1:++t}for(;t>=0&&w;--t){var E=s[t].s;g[E]==e&&(--g[E],++w)}p=e}return{t:new be(g),l:p}},Sa=function(n,e,r){return n.s==-1?Math.max(Sa(n.l,e,r+1),Sa(n.r,e,r+1)):e[n.s]=r},Xo=function(n){for(var e=n.length;e&&!n[--e];);for(var r=new et(++e),t=0,i=n[0],s=1,a=function(c){r[t++]=c},o=1;o<=e;++o)if(n[o]==i&&o!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=n[o]}return{c:r.subarray(0,t),n:e}},pn=function(n,e){for(var r=0,t=0;t<e.length;++t)r+=n[t]*e[t];return r},e2=function(n,e,r){var t=r.length,i=yo(e+2);n[i]=255&t,n[i+1]=t>>8,n[i+2]=255^n[i],n[i+3]=255^n[i+1];for(var s=0;s<t;++s)n[i+s+4]=r[s];return 8*(i+4+t)},Wo=function(n,e,r,t,i,s,a,o,c,f,h){xt(e,h++,r),++i[256];for(var u=Ls(i,15),y=u.t,g=u.l,p=Ls(s,15),w=p.t,A=p.l,k=Xo(y),S=k.c,m=k.n,E=Xo(w),D=E.c,R=E.n,U=new et(19),B=0;B<S.length;++B)++U[31&S[B]];for(B=0;B<D.length;++B)++U[31&D[B]];for(var b=Ls(U,7),C=b.t,v=b.l,K=19;K>4&&!C[va[K-1]];--K);var P,x,T,Q,M=f+5<<3,O=pn(i,fr)+pn(s,Nn)+a,L=pn(i,y)+pn(s,w)+a+14+3*K+pn(U,C)+2*U[16]+3*U[17]+7*U[18];if(c>=0&&M<=O&&M<=L)return e2(e,h,n.subarray(c,c+f));if(xt(e,h,1+(L<O)),h+=2,L<O){P=Ct(y,g,0),x=y,T=Ct(w,A,0),Q=w;var F=Ct(C,v,0);for(xt(e,h,m-257),xt(e,h+5,R-1),xt(e,h+10,K-4),h+=14,B=0;B<K;++B)xt(e,h+3*B,C[va[B]]);h+=3*K;for(var G=[S,D],N=0;N<2;++N){var H=G[N];for(B=0;B<H.length;++B){var z=31&H[B];xt(e,h,F[z]),h+=C[z],z>15&&(xt(e,h,H[B]>>5&127),h+=H[B]>>12)}}}else P=u3,x=fr,T=f3,Q=Nn;for(B=0;B<o;++B){var j=t[B];if(j>255){gn(e,h,P[(z=j>>18&31)+257]),h+=x[z+257],z>7&&(xt(e,h,j>>23&31),h+=Es[z]);var V=31&j;gn(e,h,T[V]),h+=Q[V],V>3&&(gn(e,h,j>>5&8191),h+=vs[V])}else gn(e,h,P[j]),h+=x[j]}return gn(e,h,P[256]),h+x[256]},g3=new lo([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),t2=new be(0),$o=function(){var n=1,e=0;return{p:function(r){for(var t=n,i=e,s=0|r.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=t+=r[a];t=(65535&t)+15*(t>>16),i=(65535&i)+15*(i>>16)}n=t,e=i},d:function(){return(255&(n%=65521))<<24|(65280&n)<<8|(255&(e%=65521))<<8|e>>8}}},r2=function(n,e,r,t,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new be(s.length+n.length);a.set(s),a.set(n,s.length),n=a,i.w=s.length}return function(o,c,f,h,u,y){var g=y.z||o.length,p=new be(h+g+5*(1+Math.ceil(g/7e3))+u),w=p.subarray(h,p.length-u),A=y.l,k=7&(y.r||0);if(c){k&&(w[0]=y.r>>3);for(var S=g3[c-1],m=S>>13,E=8191&S,D=(1<<f)-1,R=y.p||new et(32768),U=y.h||new et(D+1),B=Math.ceil(f/3),b=2*B,C=function(Ks){return(o[Ks]^o[Ks+1]<<B^o[Ks+2]<<b)&D},v=new lo(25e3),K=new et(288),P=new et(32),x=0,T=0,Q=y.i||0,M=0,O=y.w||0,L=0;Q+2<g;++Q){var F=C(Q),G=32767&Q,N=U[F];if(R[G]=N,U[F]=G,O<=Q){var H=g-Q;if((x>7e3||M>24576)&&(H>423||!A)){k=Wo(o,w,0,v,K,P,T,M,L,Q-L,k),M=x=T=0,L=Q;for(var z=0;z<286;++z)K[z]=0;for(z=0;z<30;++z)P[z]=0}var j=2,V=0,J=E,_=G-N&32767;if(H>2&&F==C(Q-_))for(var ee=Math.min(m,H)-1,$=Math.min(32767,Q),ne=Math.min(258,H);_<=$&&--J&&G!=N;){if(o[Q+j]==o[Q+j-_]){for(var W=0;W<ne&&o[Q+W]==o[Q+W-_];++W);if(W>j){if(j=W,V=_,W>ee)break;var ge=Math.min(_,W-2),de=0;for(z=0;z<ge;++z){var pe=Q-_+z&32767,un=pe-R[pe]&32767;un>de&&(de=un,N=pe)}}}_+=(G=N)-(N=R[G])&32767}if(V){v[M++]=268435456|Ba[j]<<18|Ia[V];var bo=31&Ba[j],ko=31&Ia[V];T+=Es[bo]+vs[ko],++K[257+bo],++P[ko],O=Q+j,++x}else v[M++]=o[Q],++K[o[Q]]}}for(Q=Math.max(Q,O);Q<g;++Q)v[M++]=o[Q],++K[o[Q]];k=Wo(o,w,A,v,K,P,T,M,L,Q-L,k),A||(y.r=7&k|w[k/8|0]<<3,k-=7,y.h=U,y.p=R,y.i=Q,y.w=O)}else{for(Q=y.w||0;Q<g+A;Q+=65535){var Ss=Q+65535;Ss>=g&&(w[k/8|0]=A,Ss=g),k=e2(w,k+1,o.subarray(Q,Ss))}y.i=g}return Sn(p,0,h+yo(k)+u)}(n,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(n.length)))):20:12+e.mem,r,t,i)},e1=function(n,e,r){for(;r;++e)n[e]=r,r>>>=8},Ei=function(){function n(e,r){if(typeof e=="function"&&(r=e,e={}),this.ondata=r,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new be(98304),this.o.dictionary){var t=this.o.dictionary.subarray(-32768);this.b.set(t,32768-t.length),this.s.i=32768-t.length}}return n.prototype.p=function(e,r){this.ondata(r2(e,this.o,0,0,this.s),r)},n.prototype.push=function(e,r){this.ondata||Se(5),this.s.l&&Se(4);var t=e.length+this.s.z;if(t>this.b.length){if(t>2*this.b.length-32768){var i=new be(-32768&t);i.set(this.b.subarray(0,this.s.z)),this.b=i}var s=this.b.length-this.s.z;this.b.set(e.subarray(0,s),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(s),32768),this.s.z=e.length-s+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n.prototype.flush=function(){this.ondata||Se(5),this.s.l&&Se(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},n}(),vi=function(){function n(e,r){typeof e=="function"&&(r=e,e={}),this.ondata=r;var t=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:t?t.length:0},this.o=new be(32768),this.p=new be(0),t&&this.o.set(t)}return n.prototype.e=function(e){if(this.ondata||Se(5),this.d&&Se(4),this.p.length){if(e.length){var r=new be(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length),this.p=r}}else this.p=e},n.prototype.c=function(e){this.s.i=+(this.d=e||!1);var r=this.s.b,t=function(i,s,a,o){var c=i.length;if(!c||s.f&&!s.l)return a||new be(0);var f=!a,h=f||s.i!=2,u=s.i;f&&(a=new be(3*c));var y=function(de){var pe=a.length;if(de>pe){var un=new be(Math.max(2*pe,de));un.set(a),a=un}},g=s.f||0,p=s.p||0,w=s.b||0,A=s.l,k=s.d,S=s.m,m=s.n,E=8*c;do{if(!A){g=ot(i,p,1);var D=ot(i,p+1,3);if(p+=3,!D){var R=i[(M=yo(p)+4)-4]|i[M-3]<<8,U=M+R;if(U>c){u&&Se(0);break}h&&y(w+R),a.set(i.subarray(M,U),w),s.b=w+=R,s.p=p=8*U,s.f=g;continue}if(D==1)A=h3,k=l3,S=9,m=5;else if(D==2){var B=ot(i,p,31)+257,b=ot(i,p+10,15)+4,C=B+ot(i,p+5,31)+1;p+=14;for(var v=new be(C),K=new be(19),P=0;P<b;++P)K[va[P]]=ot(i,p+3*P,7);p+=3*b;var x=Ms(K),T=(1<<x)-1,Q=Ct(K,x,1);for(P=0;P<C;){var M,O=Q[ot(i,p,T)];if(p+=15&O,(M=O>>4)<16)v[P++]=M;else{var L=0,F=0;for(M==16?(F=3+ot(i,p,3),p+=2,L=v[P-1]):M==17?(F=3+ot(i,p,7),p+=3):M==18&&(F=11+ot(i,p,127),p+=7);F--;)v[P++]=L}}var G=v.subarray(0,B),N=v.subarray(B);S=Ms(G),m=Ms(N),A=Ct(G,S,1),k=Ct(N,m,1)}else Se(1);if(p>E){u&&Se(0);break}}h&&y(w+131072);for(var H=(1<<S)-1,z=(1<<m)-1,j=p;;j=p){var V=(L=A[Fs(i,p)&H])>>4;if((p+=15&L)>E){u&&Se(0);break}if(L||Se(2),V<256)a[w++]=V;else{if(V==256){j=p,A=null;break}var J=V-254;if(V>264){var _=Es[P=V-257];J=ot(i,p,(1<<_)-1)+Wc[P],p+=_}var ee=k[Fs(i,p)&z],$=ee>>4;if(ee||Se(3),p+=15&ee,N=$c[$],$>3&&(_=vs[$],N+=Fs(i,p)&(1<<_)-1,p+=_),p>E){u&&Se(0);break}h&&y(w+131072);var ne=w+J;if(w<N){var W=0-N,ge=Math.min(N,ne);for(W+w<0&&Se(3);w<ge;++w)a[w]=o[W+w]}for(;w<ne;++w)a[w]=a[w-N]}}s.l=A,s.p=j,s.b=w,s.f=g,A&&(g=1,s.m=S,s.d=k,s.n=m)}while(!g);return w!=a.length&&f?Sn(a,0,w):a.subarray(0,w)}(this.p,this.s,this.o);this.ondata(Sn(t,r,this.s.b),this.d),this.o=Sn(t,this.s.b-32768),this.s.b=this.o.length,this.p=Sn(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(e,r){this.e(e),this.c(r)},n}(),p3=function(){function n(e,r){this.c=$o(),this.v=1,Ei.call(this,e,r)}return n.prototype.push=function(e,r){this.c.p(e),Ei.prototype.push.call(this,e,r)},n.prototype.p=function(e,r){var t=r2(e,this.o,this.v&&(this.o.dictionary?6:2),r&&4,this.s);this.v&&(function(i,s){var a=s.level,o=a==0?0:a<6?1:a==9?3:2;if(i[0]=120,i[1]=o<<6|(s.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,s.dictionary){var c=$o();c.p(s.dictionary),e1(i,2,c.d())}}(t,this.o),this.v=0),r&&e1(t,t.length-4,this.c.d()),this.ondata(t,r)},n.prototype.flush=function(){Ei.prototype.flush.call(this)},n}(),d3=function(){function n(e,r){vi.call(this,e,r),this.v=e&&e.dictionary?2:1}return n.prototype.push=function(e,r){if(vi.prototype.e.call(this,e),this.v){if(this.p.length<6&&!r)return;this.p=this.p.subarray((t=this.p,i=this.v-1,((15&t[0])!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Se(6,"invalid zlib data"),(t[1]>>5&1)==+!i&&Se(6,"invalid zlib data: "+(32&t[1]?"need":"unexpected")+" dictionary"),2+(t[1]>>3&4))),this.v=0}var t,i;r&&(this.p.length<4&&Se(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),vi.prototype.c.call(this,r)},n}(),A3=typeof TextDecoder<"u"&&new TextDecoder;try{A3.decode(t2,{stream:!0})}catch{}var On=class{static get tag(){return l.packet.literalData}constructor(e=new Date){this.format=l.literal.utf8,this.date=d.normalizeDate(e),this.text=null,this.data=null,this.filename=""}setText(e,r=l.literal.utf8){this.format=r,this.text=e,this.data=null}getText(e=!1){return(this.text===null||d.isStream(this.text))&&(this.text=d.decodeUTF8(d.nativeEOL(this.getBytes(e)))),this.text}setBytes(e,r){this.format=r,this.data=e,this.text=null}getBytes(e=!1){return this.data===null&&(this.data=d.canonicalizeEOL(d.encodeUTF8(this.text))),e?xn(this.data):this.data}setFilename(e){this.filename=e}getFilename(){return this.filename}read(e){return I(this,null,function*(){yield Ja(e,r=>I(this,null,function*(){let t=yield r.readByte(),i=yield r.readByte();this.filename=d.decodeUTF8(yield r.readBytes(i)),this.date=d.readDate(yield r.readBytes(4));let s=r.remainder();Ee(s)&&(s=yield De(s)),this.setBytes(s,t)}))})}writeHeader(){let e=d.encodeUTF8(this.filename),r=new Uint8Array([e.length]),t=new Uint8Array([this.format]),i=d.writeDate(this.date);return d.concatUint8Array([t,r,e,i])}write(){let e=this.writeHeader(),r=this.getBytes();return d.concat([e,r])}},Ht=class n{constructor(){this.bytes=""}read(e){return this.bytes=d.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return d.stringToUint8Array(this.bytes)}toHex(){return d.uint8ArrayToHex(d.stringToUint8Array(this.bytes))}equals(e,r=!1){return r&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){let r=new n;return r.read(d.hexToUint8Array(e)),r}static wildcard(){let e=new n;return e.read(new Uint8Array(8)),e}},dn=Symbol("verified"),t1="salt@notations.openpgpjs.org",w3=new Set([l.signatureSubpacket.issuerKeyID,l.signatureSubpacket.issuerFingerprint,l.signatureSubpacket.embeddedSignature]),_e=class n{static get tag(){return l.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Ht,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[dn]=null}read(e,r=q){let t=0;if(this.version=e[t++],this.version===5&&!r.enableParsingV5Entities)throw new ie("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version!==4&&this.version!==5&&this.version!==6)throw new ie(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[t++],this.publicKeyAlgorithm=e[t++],this.hashAlgorithm=e[t++],t+=this.readSubPackets(e.subarray(t,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=e.subarray(0,t),t+=this.readSubPackets(e.subarray(t,e.length),!1),this.signedHashValue=e.subarray(t,t+2),t+=2,this.version===6){let o=e[t++];this.salt=e.subarray(t,t+o),t+=o}let i=e.subarray(t,e.length),{read:s,signatureParams:a}=function(o,c){let f=0;switch(o){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{let h=d.readMPI(c.subarray(f));return f+=h.length+2,{read:f,signatureParams:{s:h}}}case l.publicKey.dsa:case l.publicKey.ecdsa:{let h=d.readMPI(c.subarray(f));f+=h.length+2;let u=d.readMPI(c.subarray(f));return f+=u.length+2,{read:f,signatureParams:{r:h,s:u}}}case l.publicKey.eddsaLegacy:{let h=d.readMPI(c.subarray(f));f+=h.length+2;let u=d.readMPI(c.subarray(f));return f+=u.length+2,{read:f,signatureParams:{r:h,s:u}}}case l.publicKey.ed25519:case l.publicKey.ed448:{let h=2*gs(o),u=d.readExactSubarray(c,f,f+h);return f+=u.length,{read:f,signatureParams:{RS:u}}}default:throw new ie("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,i);if(s<i.length)throw Error("Error reading MPIs");this.params=a}writeParams(){return this.params instanceof Promise?xr(()=>I(this,null,function*(){return nn(this.publicKeyAlgorithm,yield this.params)})):nn(this.publicKeyAlgorithm,this.params)}write(){let e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),this.version===6&&(e.push(new Uint8Array([this.salt.length])),e.push(this.salt)),e.push(this.writeParams()),d.concat(e)}sign(a,o){return I(this,arguments,function*(e,r,t=new Date,i=!1,s){this.version=e.version,this.created=d.normalizeDate(t),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID();let c=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(this.version===6){let y=Ns(this.hashAlgorithm);if(this.salt===null)this.salt=Me(y);else if(y!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(s.nonDeterministicSignaturesViaNotation){if(this.rawNotations.filter(({name:y})=>y===t1).length!==0)throw Error("Unexpected existing salt notation");{let y=Me(Ns(this.hashAlgorithm));this.rawNotations.push({name:t1,value:y,humanReadable:!1,critical:!1})}}c.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=d.concat(c);let f=this.toHash(this.signatureType,r,i),h=yield this.hash(this.signatureType,r,f,i);this.signedHashValue=Pe(Rn(h),0,2);let u=()=>I(this,null,function*(){return o3(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,f,yield De(h))});d.isStream(h)?this.params=u():(this.params=yield u(),this[dn]=!0)})}writeHashedSubPackets(){let e=l.signatureSubpacket,r=[],t;if(this.created===null)throw Error("Missing signature creation time");r.push(se(e.signatureCreationTime,!0,d.writeDate(this.created))),this.signatureExpirationTime!==null&&r.push(se(e.signatureExpirationTime,!0,d.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&r.push(se(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(t=new Uint8Array([this.trustLevel,this.trustAmount]),r.push(se(e.trustSignature,!0,t))),this.regularExpression!==null&&r.push(se(e.regularExpression,!0,this.regularExpression)),this.revocable!==null&&r.push(se(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&r.push(se(e.keyExpirationTime,!0,d.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.preferredSymmetricAlgorithms)),r.push(se(e.preferredSymmetricAlgorithms,!1,t))),this.revocationKeyClass!==null&&(t=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),t=d.concat([t,this.revocationKeyFingerprint]),r.push(se(e.revocationKey,!1,t))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&r.push(se(e.issuerKeyID,!1,this.issuerKeyID.write())),this.rawNotations.forEach(({name:a,value:o,humanReadable:c,critical:f})=>{t=[new Uint8Array([c?128:0,0,0,0])];let h=d.encodeUTF8(a);t.push(d.writeNumber(h.length,2)),t.push(d.writeNumber(o.length,2)),t.push(h),t.push(o),t=d.concat(t),r.push(se(e.notationData,f,t))}),this.preferredHashAlgorithms!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.preferredHashAlgorithms)),r.push(se(e.preferredHashAlgorithms,!1,t))),this.preferredCompressionAlgorithms!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.preferredCompressionAlgorithms)),r.push(se(e.preferredCompressionAlgorithms,!1,t))),this.keyServerPreferences!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.keyServerPreferences)),r.push(se(e.keyServerPreferences,!1,t))),this.preferredKeyServer!==null&&r.push(se(e.preferredKeyServer,!1,d.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&r.push(se(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&r.push(se(e.policyURI,!1,d.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.keyFlags)),r.push(se(e.keyFlags,!0,t))),this.signersUserID!==null&&r.push(se(e.signersUserID,!1,d.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(t=d.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),r.push(se(e.reasonForRevocation,!0,t))),this.features!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.features)),r.push(se(e.features,!1,t))),this.signatureTargetPublicKeyAlgorithm!==null&&(t=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],t.push(d.stringToUint8Array(this.signatureTargetHash)),t=d.concat(t),r.push(se(e.signatureTarget,!0,t))),this.embeddedSignature!==null&&r.push(se(e.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(t=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],t=d.concat(t),r.push(se(e.issuerFingerprint,this.version>=5,t))),this.preferredAEADAlgorithms!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.preferredAEADAlgorithms)),r.push(se(e.preferredAEADAlgorithms,!1,t))),this.preferredCipherSuites!==null&&(t=new Uint8Array([].concat(...this.preferredCipherSuites)),r.push(se(e.preferredCipherSuites,!1,t)));let i=d.concat(r),s=d.writeNumber(i.length,this.version===6?4:2);return d.concat([s,i])}writeUnhashedSubPackets(){let e=this.unhashedSubpackets.map(({type:i,critical:s,body:a})=>se(i,s,a)),r=d.concat(e),t=d.writeNumber(r.length,this.version===6?4:2);return d.concat([t,r])}readSubPacket(e,r=!0){let t=0,i=!!(128&e[t]),s=127&e[t];if(t++,r||(this.unhashedSubpackets.push({type:s,critical:i,body:e.subarray(t,e.length)}),w3.has(s)))switch(s){case l.signatureSubpacket.signatureCreationTime:this.created=d.readDate(e.subarray(t,e.length));break;case l.signatureSubpacket.signatureExpirationTime:{let a=d.readNumber(e.subarray(t,e.length));this.signatureNeverExpires=a===0,this.signatureExpirationTime=a;break}case l.signatureSubpacket.exportableCertification:this.exportable=e[t++]===1;break;case l.signatureSubpacket.trustSignature:this.trustLevel=e[t++],this.trustAmount=e[t++];break;case l.signatureSubpacket.regularExpression:this.regularExpression=e[t];break;case l.signatureSubpacket.revocable:this.revocable=e[t++]===1;break;case l.signatureSubpacket.keyExpirationTime:{let a=d.readNumber(e.subarray(t,e.length));this.keyExpirationTime=a,this.keyNeverExpires=a===0;break}case l.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.revocationKey:this.revocationKeyClass=e[t++],this.revocationKeyAlgorithm=e[t++],this.revocationKeyFingerprint=e.subarray(t,t+20);break;case l.signatureSubpacket.issuerKeyID:if(this.version===4)this.issuerKeyID.read(e.subarray(t,e.length));else if(r)throw Error("Unexpected Issuer Key ID subpacket");break;case l.signatureSubpacket.notationData:{let a=!!(128&e[t]);t+=4;let o=d.readNumber(e.subarray(t,t+2));t+=2;let c=d.readNumber(e.subarray(t,t+2));t+=2;let f=d.decodeUTF8(e.subarray(t,t+o)),h=e.subarray(t+o,t+o+c);this.rawNotations.push({name:f,humanReadable:a,value:h,critical:i}),a&&(this.notations[f]=d.decodeUTF8(h));break}case l.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=d.decodeUTF8(e.subarray(t,e.length));break;case l.signatureSubpacket.primaryUserID:this.isPrimaryUserID=e[t++]!==0;break;case l.signatureSubpacket.policyURI:this.policyURI=d.decodeUTF8(e.subarray(t,e.length));break;case l.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.signersUserID:this.signersUserID=d.decodeUTF8(e.subarray(t,e.length));break;case l.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[t++],this.reasonForRevocationString=d.decodeUTF8(e.subarray(t,e.length));break;case l.signatureSubpacket.features:this.features=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[t++],this.signatureTargetHashAlgorithm=e[t++];let a=ve(this.signatureTargetHashAlgorithm);this.signatureTargetHash=d.uint8ArrayToString(e.subarray(t,t+a));break}case l.signatureSubpacket.embeddedSignature:this.embeddedSignature=new n,this.embeddedSignature.read(e.subarray(t,e.length));break;case l.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[t++],this.issuerFingerprint=e.subarray(t,e.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case l.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let a=t;a<e.length;a+=2)this.preferredCipherSuites.push([e[a],e[a+1]]);break;default:this.unknownSubpackets.push({type:s,critical:i,body:e.subarray(t,e.length)})}}readSubPackets(e,r=!0,t){let i=this.version===6?4:2,s=d.readNumber(e.subarray(0,i)),a=i;for(;a<2+s;){let o=wc(e.subarray(a,e.length));a+=o.offset,this.readSubPacket(e.subarray(a,a+o.len),r,t),a+=o.len}return a}toSign(e,r){let t=l.signature;switch(e){case t.binary:return r.text!==null?d.encodeUTF8(r.getText(!0)):r.getBytes(!0);case t.text:{let i=r.getBytes(!0);return d.canonicalizeEOL(i)}case t.standalone:return new Uint8Array(0);case t.certGeneric:case t.certPersona:case t.certCasual:case t.certPositive:case t.certRevocation:{let i,s;if(r.userID)s=180,i=r.userID;else{if(!r.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");s=209,i=r.userAttribute}let a=i.write();return d.concat([this.toSign(t.key,r),new Uint8Array([s]),d.writeNumber(a.length,4),a])}case t.subkeyBinding:case t.subkeyRevocation:case t.keyBinding:return d.concat([this.toSign(t.key,r),this.toSign(t.key,{key:r.bind})]);case t.key:if(r.key===void 0)throw Error("Key packet is required for this signature.");return r.key.writeForHash(this.version);case t.keyRevocation:return this.toSign(t.key,r);case t.timestamp:return new Uint8Array(0);case t.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,r){let t=0;return me(Rn(this.signatureData),i=>{t+=i.length},()=>{let i=[];return this.version!==5||this.signatureType!==l.signature.binary&&this.signatureType!==l.signature.text||(r?i.push(new Uint8Array(6)):i.push(e.writeHeader())),i.push(new Uint8Array([this.version,255])),this.version===5&&i.push(new Uint8Array(4)),i.push(d.writeNumber(t,4)),d.concat(i)})}toHash(e,r,t=!1){let i=this.toSign(e,r);return d.concat([this.salt||new Uint8Array,i,this.signatureData,this.calculateTrailer(r,t)])}hash(e,r,t,i=!1){return I(this,null,function*(){if(this.version===6&&this.salt.length!==Ns(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return t||(t=this.toHash(e,r,i)),Ut(this.hashAlgorithm,t)})}verify(o,c,f){return I(this,arguments,function*(e,r,t,i=new Date,s=!1,a=q){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");let h=r===l.signature.binary||r===l.signature.text;if(!(this[dn]&&!h)){let y,g;if(this.hashed?g=yield this.hashed:(y=this.toHash(r,t,s),g=yield this.hash(r,t,y)),g=yield De(g),this.signedHashValue[0]!==g[0]||this.signedHashValue[1]!==g[1])throw Error("Signed digest did not match");if(this.params=yield this.params,this[dn]=yield a3(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,y,g),!this[dn])throw Error("Signature verification failed")}let u=d.normalizeDate(i);if(u&&this.created>u)throw Error("Signature creation time is in the future");if(u&&u>=this.getExpirationTime())throw Error("Signature is expired");if(a.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+l.read(l.hash,this.hashAlgorithm).toUpperCase());if(a.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[l.signature.binary,l.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+l.read(l.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:y,critical:g})=>{if(g)throw Error("Unknown critical signature subpacket type "+y)}),this.rawNotations.forEach(({name:y,critical:g})=>{if(g&&a.knownNotations.indexOf(y)<0)throw Error("Unknown critical notation: "+y)}),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")})}isExpired(e=new Date){let r=d.normalizeDate(e);return r!==null&&!(this.created<=r&&r<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}};function se(n,e,r){let t=[];return t.push(ys(r.length+1)),t.push(new Uint8Array([(e?128:0)|n])),t.push(r),d.concat(t)}function Ns(n){switch(n){case l.hash.sha256:return 16;case l.hash.sha384:return 24;case l.hash.sha512:return 32;case l.hash.sha224:case l.hash.sha3_256:return 16;case l.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}var zt=class n{static get tag(){return l.packet.onePassSignature}static fromSignaturePacket(e,r){let t=new n;return t.version=e.version===6?6:3,t.signatureType=e.signatureType,t.hashAlgorithm=e.hashAlgorithm,t.publicKeyAlgorithm=e.publicKeyAlgorithm,t.issuerKeyID=e.issuerKeyID,t.salt=e.salt,t.issuerFingerprint=e.issuerFingerprint,t.flags=r?1:0,t}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(e){let r=0;if(this.version=e[r++],this.version!==3&&this.version!==6)throw new ie(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=e[r++],this.hashAlgorithm=e[r++],this.publicKeyAlgorithm=e[r++],this.version===6){let t=e[r++];this.salt=e.subarray(r,r+t),r+=t,this.issuerFingerprint=e.subarray(r,r+32),r+=32,this.issuerKeyID=new Ht,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Ht,this.issuerKeyID.read(e.subarray(r,r+8)),r+=8;return this.flags=e[r++],this}write(){let e=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return this.version===6?e.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):e.push(this.issuerKeyID.write()),e.push(new Uint8Array([this.flags])),d.concatUint8Array(e)}calculateTrailer(...e){return xr(()=>I(this,null,function*(){return _e.prototype.calculateTrailer.apply(yield this.correspondingSig,e)}))}verify(){return I(this,arguments,function*(){let e=yield this.correspondingSig;if(!e||e.constructor.tag!==l.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID)||this.version===3&&e.version===6||this.version===6&&e.version!==6||this.version===6&&!d.equalsUint8Array(e.issuerFingerprint,this.issuerFingerprint)||this.version===6&&!d.equalsUint8Array(e.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)})}};function m3(n,e){if(!e[n]){let r;try{r=l.read(l.packet,n)}catch{throw new Wr("Unknown packet type with tag: "+n)}throw Error("Packet not allowed in this context: "+r)}return new e[n]}zt.prototype.hash=_e.prototype.hash,zt.prototype.toHash=_e.prototype.toHash,zt.prototype.toSign=_e.prototype.toSign;var we=class n extends Array{static fromBinary(a,o){return I(this,arguments,function*(e,r,t=q,i=null,s=!1){let c=new n;return yield c.read(e,r,t,i,s),c})}read(a,o){return I(this,arguments,function*(e,r,t=q,i=null,s=!1){let c;t.additionalAllowedPackets.length&&(c=d.constructAllowedPackets(t.additionalAllowedPackets),r=ue(ue({},r),c)),this.stream=Dr(e,(h,u)=>I(this,null,function*(){let y=Gt(h),g=st(u);try{let p=d.isStream(h);for(;;){let w,A;if(yield g.ready,yield D0(y,p,S=>I(this,null,function*(){try{if(S.tag===l.packet.marker||S.tag===l.packet.trust||S.tag===l.packet.padding)return;let m=m3(S.tag,r);try{i?.recordPacket(S.tag,c)}catch(E){if(t.enforceGrammar)throw E;d.printDebugError(E)}m.packets=new n,m.fromStream=d.isStream(S.packet),A=m.fromStream;try{yield m.read(S.packet,t)}catch(E){throw E instanceof ie?E:d.wrapError(new Qn(`Parsing ${m.constructor.name} failed`),E)}yield g.write(m)}catch(m){let E=m instanceof Wr&&S.tag<=39,D=m instanceof ie&&!(m instanceof Wr)&&!t.ignoreUnsupportedPackets,R=m instanceof Qn&&!t.ignoreMalformedPackets,U=pi(S.tag);if(E||D||R||U||!(m instanceof Wr||m instanceof ie||m instanceof Qn))s?w=m:yield g.abort(m);else{let B=new Tn(S.tag,S.packet);yield g.write(B)}d.printDebugError(m)}})),A&&(p=null),w)throw yield y.readToEnd(),w;let k=yield y.peekBytes(2);if(!k||!k.length){try{i?.recordEnd()}catch(S){if(t.enforceGrammar)throw S;d.printDebugError(S)}return yield g.ready,void(yield g.close())}}}catch(p){yield g.abort(p)}}));let f=Gt(this.stream);for(;;){let{done:h,value:u}=yield f.read();if(h?this.stream=null:this.push(u),h||pi(u.constructor.tag))break}f.releaseLock()})}write(){let e=[];for(let r=0;r<this.length;r++){let t=this[r]instanceof Tn?this[r].tag:this[r].constructor.tag,i=this[r].write();if(d.isStream(i)&&pi(this[r].constructor.tag)){let s=[],a=0,o=512;e.push(Ci(t)),e.push(me(i,c=>{if(s.push(c),a+=c.length,a>=o){let f=Math.min(Math.log(a)/Math.LN2|0,30),h=2**f,u=d.concat([P0(f)].concat(s));return s=[u.subarray(1+h)],a=s[0].length,u.subarray(0,1+h)}},()=>d.concat([ys(a)].concat(s))))}else{if(d.isStream(i)){let s=0;e.push(me(Rn(i),a=>{s+=a.length},()=>Qo(t,s)))}else e.push(Qo(t,i.length));e.push(i)}}return d.concat(e)}filterByTag(...e){let r=new n,t=i=>s=>i===s;for(let i=0;i<this.length;i++)e.some(t(this[i].constructor.tag))&&r.push(this[i]);return r}findPacket(e){return this.find(r=>r.constructor.tag===e)}indexOfTag(...e){let r=[],t=this,i=s=>a=>s===a;for(let s=0;s<this.length;s++)e.some(i(t[s].constructor.tag))&&r.push(s);return r}},wt=class n extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.name="GrammarError"}},Ae;(function(n){n[n.EmptyMessage=0]="EmptyMessage",n[n.PlaintextOrEncryptedData=1]="PlaintextOrEncryptedData",n[n.EncryptedSessionKeys=2]="EncryptedSessionKeys",n[n.StandaloneAdditionalAllowedData=3]="StandaloneAdditionalAllowedData"})(Ae||(Ae={}));var ji=class{constructor(){this.state=Ae.EmptyMessage,this.leadingOnePassSignatureCounter=0}recordPacket(e,r){switch(this.state){case Ae.EmptyMessage:case Ae.StandaloneAdditionalAllowedData:switch(e){case l.packet.literalData:case l.packet.compressedData:case l.packet.aeadEncryptedData:case l.packet.symEncryptedIntegrityProtectedData:case l.packet.symmetricallyEncryptedData:return void(this.state=Ae.PlaintextOrEncryptedData);case l.packet.signature:if(this.state===Ae.StandaloneAdditionalAllowedData&&--this.leadingOnePassSignatureCounter<0)throw new wt("Trailing signature packet without OPS");return;case l.packet.onePassSignature:if(this.state===Ae.StandaloneAdditionalAllowedData)throw new wt("OPS following StandaloneAdditionalAllowedData");return void this.leadingOnePassSignatureCounter++;case l.packet.publicKeyEncryptedSessionKey:case l.packet.symEncryptedSessionKey:return void(this.state=Ae.EncryptedSessionKeys);default:if(!r?.[e])throw new wt(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Ae.StandaloneAdditionalAllowedData)}case Ae.PlaintextOrEncryptedData:if(e===l.packet.signature){if(--this.leadingOnePassSignatureCounter<0)throw new wt("Trailing signature packet without OPS");return void(this.state=Ae.PlaintextOrEncryptedData)}if(!r?.[e])throw new wt(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Ae.PlaintextOrEncryptedData);case Ae.EncryptedSessionKeys:switch(e){case l.packet.publicKeyEncryptedSessionKey:case l.packet.symEncryptedSessionKey:return void(this.state=Ae.EncryptedSessionKeys);case l.packet.symEncryptedIntegrityProtectedData:case l.packet.aeadEncryptedData:case l.packet.symmetricallyEncryptedData:return void(this.state=Ae.PlaintextOrEncryptedData);case l.packet.signature:if(--this.leadingOnePassSignatureCounter<0)throw new wt("Trailing signature packet without OPS");return void(this.state=Ae.PlaintextOrEncryptedData);default:if(!r?.[e])throw new wt(`Unexpected packet ${e} in state ${this.state}`);this.state=Ae.EncryptedSessionKeys}}}recordEnd(){switch(this.state){case Ae.EmptyMessage:case Ae.PlaintextOrEncryptedData:case Ae.EncryptedSessionKeys:case Ae.StandaloneAdditionalAllowedData:if(this.leadingOnePassSignatureCounter>0)throw new wt("Missing trailing signature packets")}}},b3=d.constructAllowedPackets([On,zt,_e]),Vi=class{static get tag(){return l.packet.compressedData}constructor(e=q){this.packets=null,this.algorithm=e.preferredCompressionAlgorithm,this.compressed=null}read(t){return I(this,arguments,function*(e,r=q){yield Ja(e,i=>I(this,null,function*(){this.algorithm=yield i.readByte(),this.compressed=i.remainder(),yield this.decompress(r)}))})}write(){return this.compressed===null&&this.compress(),d.concat([new Uint8Array([this.algorithm]),this.compressed])}decompress(){return I(this,arguments,function*(e=q){let r=l.read(l.compression,this.algorithm),t=v3[r];if(!t)throw Error(r+" decompression not supported");this.packets=yield we.fromBinary(yield t(this.compressed),b3,e,new ji)})}compress(){let e=l.read(l.compression,this.algorithm),r=E3[e];if(!r)throw Error(e+" compression not supported");this.compressed=r(this.packets.write())}};function qi(n,e){return r=>{if(!d.isStream(r)||Ee(r))return xr(()=>De(r).then(a=>new Promise((o,c)=>{let f=new e,h=[];f.ondata=(u,y)=>{h.push(u),y&&o(d.concatUint8Array(h))};try{f.push(a,!0)}catch(u){c(u)}})));if(n)try{let a=n();return r.pipeThrough(a)}catch(a){if(a.name!=="TypeError")throw a}let t=r.getReader(),i=new e;return new ReadableStream({start(a){return I(this,null,function*(){for(i.ondata=(o,c)=>I(null,null,function*(){a.enqueue(o),c&&a.close()});;){let{done:o,value:c}=yield t.read();if(o)return void i.push(new Uint8Array,!0);c.length&&i.push(c)}})}})}}function k3(){return function(n){return I(this,null,function*(){let{decode:e}=yield Promise.resolve().then(function(){return Kh});return xr(()=>I(null,null,function*(){return e(yield De(n))}))})}}var _i=n=>({compressor:typeof CompressionStream<"u"&&(()=>new CompressionStream(n)),decompressor:typeof DecompressionStream<"u"&&(()=>new DecompressionStream(n))}),E3={zip:qi(_i("deflate-raw").compressor,Ei),zlib:qi(_i("deflate").compressor,p3)},v3={uncompressed:n=>n,zip:qi(_i("deflate-raw").decompressor,vi),zlib:qi(_i("deflate").decompressor,d3),bzip2:k3()},B3=d.constructAllowedPackets([On,Vi,zt,_e]),Hn=class n{static get tag(){return l.packet.symEncryptedIntegrityProtectedData}static fromObject({version:e,aeadAlgorithm:r}){if(e!==1&&e!==2)throw Error("Unsupported SEIPD version");let t=new n;return t.version=e,e===2&&(t.aeadAlgorithm=r),t}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}read(e){return I(this,null,function*(){yield Ja(e,r=>I(this,null,function*(){if(this.version=yield r.readByte(),this.version!==1&&this.version!==2)throw new ie(`Version ${this.version} of the SEIP packet is unsupported.`);this.version===2&&(this.cipherAlgorithm=yield r.readByte(),this.aeadAlgorithm=yield r.readByte(),this.chunkSizeByte=yield r.readByte(),this.salt=yield r.readBytes(32)),this.encrypted=r.remainder()}))})}write(){return this.version===2?d.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):d.concat([new Uint8Array([this.version]),this.encrypted])}encrypt(i,s){return I(this,arguments,function*(e,r,t=q){let{blockSize:a,keySize:o}=he(e);if(r.length!==o)throw Error("Unexpected session key size");let c=this.packets.write();if(Ee(c)&&(c=yield De(c)),this.version===2)this.cipherAlgorithm=e,this.salt=Me(32),this.chunkSizeByte=t.aeadChunkSizeByte,this.encrypted=yield r1(this,"encrypt",r,c);else{let f=yield X0(e),h=new Uint8Array([211,20]),u=d.concat([f,c,h]),y=yield Ut(l.hash.sha1,xn(u)),g=d.concat([u,y]);this.encrypted=yield ho(e,r,g,new Uint8Array(a))}return!0})}decrypt(i,s){return I(this,arguments,function*(e,r,t=q){if(r.length!==he(e).keySize)throw Error("Unexpected session key size");let a,o=Rn(this.encrypted);Ee(o)&&(o=yield De(o));let c=!1;if(this.version===2){if(this.cipherAlgorithm!==e)throw Error("Unexpected session key algorithm");a=yield r1(this,"decrypt",r,o)}else{let{blockSize:f}=he(e),h=yield fo(e,r,o,new Uint8Array(f)),u=Pe(xn(h),-20),y=Pe(h,0,-20),g=Promise.all([De(yield Ut(l.hash.sha1,xn(y))),De(u)]).then(([w,A])=>{if(!d.equalsUint8Array(w,A))throw Error("Modification detected.");return new Uint8Array}),p=Pe(y,f+2);a=Pe(p,0,-2),a=$e([a,xr(()=>g)]),d.isStream(o)&&t.allowUnauthenticatedStream?c=!0:a=yield De(a)}return this.packets=yield we.fromBinary(a,B3,t,new ji,c),!0})}};function r1(n,e,r,t){return I(this,null,function*(){let i=n instanceof Hn&&n.version===2,s=!i&&n.constructor.tag===l.packet.aeadEncryptedData;if(!i&&!s)throw Error("Unexpected packet type");let a=Er(n.aeadAlgorithm,s),o=e==="decrypt"?a.tagLength:0,c=e==="encrypt"?a.tagLength:0,f=2**(n.chunkSizeByte+6)+o,h=s?8:0,u=new ArrayBuffer(13+h),y=new Uint8Array(u,0,5+h),g=new Uint8Array(u),p=new DataView(u),w=new Uint8Array(u,5,8);y.set([192|n.constructor.tag,n.version,n.cipherAlgorithm,n.aeadAlgorithm,n.chunkSizeByte],0);let A,k,S=0,m=Promise.resolve(),E=0,D=0;if(i){let{keySize:U}=he(n.cipherAlgorithm),{ivLength:B}=a,b=new Uint8Array(u,0,5),C=yield hr(l.hash.sha256,r,n.salt,b,U+B);r=C.subarray(0,U),A=C.subarray(U),A.fill(0,A.length-8),k=new DataView(A.buffer,A.byteOffset,A.byteLength)}else A=n.iv;let R=yield a(n.cipherAlgorithm,r);return Dr(t,(U,B)=>I(null,null,function*(){if(d.isStream(U)!=="array"){let v=new TransformStream({},{highWaterMark:d.getHardwareConcurrency()*2**(n.chunkSizeByte+6),size:K=>K.length});en(v.readable,B),B=v.writable}let b=Gt(U),C=st(B);try{for(;;){let v=(yield b.readBytes(f+o))||new Uint8Array,K=v.subarray(v.length-o),P,x,T;if(v=v.subarray(0,v.length-o),i)T=A;else{T=A.slice();for(let Q=0;Q<8;Q++)T[A.length-8+Q]^=w[Q]}if(!S||v.length?(b.unshift(K),P=R[e](v,T,y),P.catch(()=>{}),D+=v.length-o+c):(p.setInt32(5+h+4,E),P=R[e](K,T,g),P.catch(()=>{}),D+=c,x=!0),E+=v.length-o,m=m.then(()=>P).then(Q=>I(null,null,function*(){yield C.ready,yield C.write(Q),D-=Q.length})).catch(Q=>C.abort(Q)),(x||D>C.desiredSize)&&(yield m),x){yield C.close();break}i?k.setInt32(A.length-4,++S):p.setInt32(9,++S)}}catch(v){yield C.ready.catch(()=>{}),yield C.abort(v)}}))})}var Yi=class n{static get tag(){return l.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new Ht,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:e,encryptionKeyPacket:r,anonymousRecipient:t,sessionKey:i,sessionKeyAlgorithm:s}){let a=new n;if(e!==3&&e!==6)throw Error("Unsupported PKESK version");return a.version=e,e===6&&(a.publicKeyVersion=t?null:r.version,a.publicKeyFingerprint=t?null:r.getFingerprintBytes()),a.publicKeyID=t?Ht.wildcard():r.getKeyID(),a.publicKeyAlgorithm=r.algorithm,a.sessionKey=i,a.sessionKeyAlgorithm=s,a}read(e){let r=0;if(this.version=e[r++],this.version!==3&&this.version!==6)throw new ie(`Version ${this.version} of the PKESK packet is unsupported.`);if(this.version===6){let t=e[r++];if(t){this.publicKeyVersion=e[r++];let i=t-1;this.publicKeyFingerprint=e.subarray(r,r+i),r+=i,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=Ht.wildcard()}else r+=this.publicKeyID.read(e.subarray(r,r+8));if(this.publicKeyAlgorithm=e[r++],this.encrypted=function(t,i){let s=0;switch(t){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:return{c:d.readMPI(i.subarray(s))};case l.publicKey.elgamal:{let a=d.readMPI(i.subarray(s));return s+=a.length+2,{c1:a,c2:d.readMPI(i.subarray(s))}}case l.publicKey.ecdh:{let a=d.readMPI(i.subarray(s));s+=a.length+2;let o=new Ti;return o.read(i.subarray(s)),{V:a,C:o}}case l.publicKey.x25519:case l.publicKey.x448:{let a=Vr(t),o=d.readExactSubarray(i,s,s+a);s+=o.length;let c=new Fi;return c.read(i.subarray(s)),{ephemeralPublicKey:o,C:c}}default:throw new ie("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,e.subarray(r)),this.publicKeyAlgorithm===l.publicKey.x25519||this.publicKeyAlgorithm===l.publicKey.x448){if(this.version===3)this.sessionKeyAlgorithm=l.write(l.symmetric,this.encrypted.C.algorithm);else if(this.encrypted.C.algorithm!==null)throw Error("Unexpected cleartext symmetric algorithm")}}write(){let e=[new Uint8Array([this.version])];return this.version===6?this.publicKeyFingerprint!==null?(e.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),e.push(this.publicKeyFingerprint)):e.push(new Uint8Array([0])):e.push(this.publicKeyID.write()),e.push(new Uint8Array([this.publicKeyAlgorithm]),nn(this.publicKeyAlgorithm,this.encrypted)),d.concatUint8Array(e)}encrypt(e){return I(this,null,function*(){let r=l.write(l.publicKey,this.publicKeyAlgorithm),t=this.version===3?this.sessionKeyAlgorithm:null,i=e.version===5?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),s=n1(this.version,r,t,this.sessionKey);this.encrypted=yield _0(r,t,e.publicParams,s,i)})}decrypt(e,r){return I(this,null,function*(){if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Decryption error");let t=r?n1(this.version,this.publicKeyAlgorithm,r.sessionKeyAlgorithm,r.sessionKey):null,i=e.version===5?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),s=yield Y0(this.publicKeyAlgorithm,e.publicParams,e.privateParams,this.encrypted,i,t),{sessionKey:a,sessionKeyAlgorithm:o}=function(c,f,h,u){switch(f){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.elgamal:case l.publicKey.ecdh:{let y=h.subarray(0,h.length-2),g=h.subarray(h.length-2),p=d.writeChecksum(y.subarray(y.length%8)),w=p[0]===g[0]&p[1]===g[1],A=c===6?{sessionKeyAlgorithm:null,sessionKey:y}:{sessionKeyAlgorithm:y[0],sessionKey:y.subarray(1)};if(u){let k=w&A.sessionKeyAlgorithm===u.sessionKeyAlgorithm&A.sessionKey.length===u.sessionKey.length;return{sessionKey:d.selectUint8Array(k,A.sessionKey,u.sessionKey),sessionKeyAlgorithm:c===6?null:d.selectUint8(k,A.sessionKeyAlgorithm,u.sessionKeyAlgorithm)}}if(w&&(c===6||l.read(l.symmetric,A.sessionKeyAlgorithm)))return A;throw Error("Decryption error")}case l.publicKey.x25519:case l.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:h};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,s,r);if(this.version===3){let c=this.publicKeyAlgorithm!==l.publicKey.x25519&&this.publicKeyAlgorithm!==l.publicKey.x448;if(this.sessionKeyAlgorithm=c?o:this.sessionKeyAlgorithm,a.length!==he(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=a})}};function n1(n,e,r,t){switch(e){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.elgamal:case l.publicKey.ecdh:return d.concatUint8Array([new Uint8Array(n===6?[]:[r]),t,d.writeChecksum(t.subarray(t.length%8))]);case l.publicKey.x25519:case l.publicKey.x448:return t;default:throw Error("Unsupported public key algorithm")}}var Zi=class n{static get tag(){return l.packet.symEncryptedSessionKey}constructor(e=q){this.version=e.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=l.write(l.aead,e.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(e){let r=0;if(this.version=e[r++],this.version!==4&&this.version!==5&&this.version!==6)throw new ie(`Version ${this.version} of the SKESK packet is unsupported.`);this.version===6&&r++;let t=e[r++];this.version>=5&&(this.aeadAlgorithm=e[r++],this.version===6&&r++);let i=e[r++];if(this.s2k=zi(i),r+=this.s2k.read(e.subarray(r,e.length)),this.version>=5){let s=Er(this.aeadAlgorithm,!0);this.iv=e.subarray(r,r+=s.ivLength)}this.version>=5||r<e.length?(this.encrypted=e.subarray(r,e.length),this.sessionKeyEncryptionAlgorithm=t):this.sessionKeyAlgorithm=t}write(){let e=this.encrypted===null?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm,r,t=this.s2k.write();if(this.version===6){let i=t.length,s=3+i+this.iv.length;r=d.concatUint8Array([new Uint8Array([this.version,s,e,this.aeadAlgorithm,i]),t,this.iv,this.encrypted])}else this.version===5?r=d.concatUint8Array([new Uint8Array([this.version,e,this.aeadAlgorithm]),t,this.iv,this.encrypted]):(r=d.concatUint8Array([new Uint8Array([this.version,e]),t]),this.encrypted!==null&&(r=d.concatUint8Array([r,this.encrypted])));return r}decrypt(e){return I(this,null,function*(){let r=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:t,keySize:i}=he(r),s=yield this.s2k.produceKey(e,i);if(this.version>=5){let a=Er(this.aeadAlgorithm,!0),o=new Uint8Array([192|n.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),c=this.version===6?yield hr(l.hash.sha256,s,new Uint8Array,o,i):s,f=yield a(r,c);this.sessionKey=yield f.decrypt(this.encrypted,this.iv,o)}else if(this.encrypted!==null){let a=yield fo(r,s,this.encrypted,new Uint8Array(t));if(this.sessionKeyAlgorithm=l.write(l.symmetric,a[0]),this.sessionKey=a.subarray(1,a.length),this.sessionKey.length!==he(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=s})}encrypt(t){return I(this,arguments,function*(e,r=q){let i=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=i,this.s2k=Zc(r),this.s2k.generateSalt();let{blockSize:s,keySize:a}=he(i),o=yield this.s2k.produceKey(e,a);if(this.sessionKey===null&&(this.sessionKey=Aa(this.sessionKeyAlgorithm)),this.version>=5){let c=Er(this.aeadAlgorithm);this.iv=Me(c.ivLength);let f=new Uint8Array([192|n.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),h=this.version===6?yield hr(l.hash.sha256,o,new Uint8Array,f,a):o,u=yield c(i,h);this.encrypted=yield u.encrypt(this.sessionKey,this.iv,f)}else{let c=d.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=yield ho(i,o,c,new Uint8Array(s))}})}},It=class n{static get tag(){return l.packet.publicKey}constructor(e=new Date,r=q){this.version=r.v6Keys?6:4,this.created=d.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){let r=new n,{version:t,created:i,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=e;return r.version=t,r.created=i,r.algorithm=s,r.publicParams=a,r.keyID=o,r.fingerprint=c,r}read(t){return I(this,arguments,function*(e,r=q){let i=0;if(this.version=e[i++],this.version===5&&!r.enableParsingV5Entities)throw new ie("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version===4||this.version===5||this.version===6){this.created=d.readDate(e.subarray(i,i+4)),i+=4,this.algorithm=e[i++],this.version>=5&&(i+=4);let{read:s,publicParams:a}=function(o,c){let f=0;switch(o){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{let h=d.readMPI(c.subarray(f));f+=h.length+2;let u=d.readMPI(c.subarray(f));return f+=u.length+2,{read:f,publicParams:{n:h,e:u}}}case l.publicKey.dsa:{let h=d.readMPI(c.subarray(f));f+=h.length+2;let u=d.readMPI(c.subarray(f));f+=u.length+2;let y=d.readMPI(c.subarray(f));f+=y.length+2;let g=d.readMPI(c.subarray(f));return f+=g.length+2,{read:f,publicParams:{p:h,q:u,g:y,y:g}}}case l.publicKey.elgamal:{let h=d.readMPI(c.subarray(f));f+=h.length+2;let u=d.readMPI(c.subarray(f));f+=u.length+2;let y=d.readMPI(c.subarray(f));return f+=y.length+2,{read:f,publicParams:{p:h,g:u,y}}}case l.publicKey.ecdsa:{let h=new Ot;f+=h.read(c),Ds(h);let u=d.readMPI(c.subarray(f));return f+=u.length+2,{read:f,publicParams:{oid:h,Q:u}}}case l.publicKey.eddsaLegacy:{let h=new Ot;if(f+=h.read(c),Ds(h),h.getName()!==l.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let u=d.readMPI(c.subarray(f));return f+=u.length+2,u=d.leftPad(u,33),{read:f,publicParams:{oid:h,Q:u}}}case l.publicKey.ecdh:{let h=new Ot;f+=h.read(c),Ds(h);let u=d.readMPI(c.subarray(f));f+=u.length+2;let y=new Mi;return f+=y.read(c.subarray(f)),{read:f,publicParams:{oid:h,Q:u,kdfParams:y}}}case l.publicKey.ed25519:case l.publicKey.ed448:case l.publicKey.x25519:case l.publicKey.x448:{let h=d.readExactSubarray(c,f,f+Vr(o));return f+=h.length,{read:f,publicParams:{A:h}}}default:throw new ie("Unknown public key encryption algorithm.")}}(this.algorithm,e.subarray(i));if(this.version===6&&a.oid&&(a.oid.getName()===l.curve.curve25519Legacy||a.oid.getName()===l.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=a,i+=s,yield this.computeFingerprintAndKeyID(),i}throw new ie(`Version ${this.version} of the key packet is unsupported.`)})}write(){let e=[];e.push(new Uint8Array([this.version])),e.push(d.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));let r=nn(this.algorithm,this.publicParams);return this.version>=5&&e.push(d.writeNumber(r.length,4)),e.push(r),d.concatUint8Array(e)}writeForHash(e){let r=this.writePublicKey(),t=149+e,i=e>=5?4:2;return d.concatUint8Array([new Uint8Array([t]),d.writeNumber(r.length,i),r])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}computeFingerprintAndKeyID(){return I(this,null,function*(){if(yield this.computeFingerprint(),this.keyID=new Ht,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}})}computeFingerprint(){return I(this,null,function*(){let e=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=yield Ut(l.hash.sha256,e);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=yield Ut(l.hash.sha1,e)}})}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return d.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&d.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){let e={};e.algorithm=l.read(l.publicKey,this.algorithm);let r=this.publicParams.n||this.publicParams.p;return r?e.bits=d.uint8ArrayBitLength(r):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}};It.prototype.readPublicKey=It.prototype.read,It.prototype.writePublicKey=It.prototype.write;var Ji=class n extends It{static get tag(){return l.packet.publicSubkey}constructor(e,r){super(e,r)}static fromSecretSubkeyPacket(e){let r=new n,{version:t,created:i,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=e;return r.version=t,r.created=i,r.algorithm=s,r.publicParams=a,r.keyID=o,r.fingerprint=c,r}},Ka=class n{static get tag(){return l.packet.userAttribute}constructor(){this.attributes=[]}read(e){let r=0;for(;r<e.length;){let t=wc(e.subarray(r,e.length));r+=t.offset,this.attributes.push(d.uint8ArrayToString(e.subarray(r,r+t.len))),r+=t.len}}write(){let e=[];for(let r=0;r<this.attributes.length;r++)e.push(ys(this.attributes[r].length)),e.push(d.stringToUint8Array(this.attributes[r]));return d.concatUint8Array(e)}equals(e){return!!(e&&e instanceof n)&&this.attributes.every(function(r,t){return r===e.attributes[t]})}},Xi=class extends It{static get tag(){return l.packet.secretKey}constructor(e=new Date,r=q){super(e,r),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}read(t){return I(this,arguments,function*(e,r=q){let i=yield this.readPublicKey(e,r),s=i;this.s2kUsage=e[i++],this.version===5&&i++,this.version===6&&this.s2kUsage&&i++;try{if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){this.symmetric=e[i++],this.s2kUsage===253&&(this.aead=e[i++]),this.version===6&&i++;let a=e[i++];if(this.s2k=zi(a),i+=this.s2k.read(e.subarray(i,e.length)),this.s2k.type==="gnu-dummy")return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=this.s2kUsage===253&&(this.version===5||this.version===4&&r.parseAEADEncryptedV4KeysAsLegacy),this.s2kUsage!==253||this.isLegacyAEAD?(this.iv=e.subarray(i,i+he(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=e.subarray(i,i+Er(this.aead).ivLength),this.usedModernAEAD=!0),i+=this.iv.length)}catch(a){if(!this.s2kUsage)throw a;this.unparseableKeyMaterial=e.subarray(s),this.isEncrypted=!0}if(this.version===5&&(i+=4),this.keyMaterial=e.subarray(i),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let a;if(this.version===6)a=this.keyMaterial;else if(a=this.keyMaterial.subarray(0,-2),!d.equalsUint8Array(d.writeChecksum(a),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{let{read:o,privateParams:c}=Go(this.algorithm,a,this.publicParams);if(o<a.length)throw Error("Error reading MPIs");this.privateParams=c}catch(o){throw o instanceof ie?o:Error("Error reading MPIs")}}})}write(){let e=this.writePublicKey();if(this.unparseableKeyMaterial)return d.concatUint8Array([e,this.unparseableKeyMaterial]);let r=[e];r.push(new Uint8Array([this.s2kUsage]));let t=[];if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){t.push(this.symmetric),this.s2kUsage===253&&t.push(this.aead);let i=this.s2k.write();this.version===6&&t.push(i.length),t.push(...i)}return this.s2kUsage&&this.s2k.type!=="gnu-dummy"&&t.push(...this.iv),(this.version===5||this.version===6&&this.s2kUsage)&&r.push(new Uint8Array([t.length])),r.push(new Uint8Array(t)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=nn(this.algorithm,this.privateParams)),this.version===5&&r.push(d.writeNumber(this.keyMaterial.length,4)),r.push(this.keyMaterial),this.s2kUsage||this.version===6||r.push(d.writeChecksum(this.keyMaterial))),d.concatUint8Array(r)}isDecrypted(){return this.isEncrypted===!1}isMissingSecretKeyMaterial(){return this.unparseableKeyMaterial!==void 0||this.isDummy()}isDummy(){return!(!this.s2k||this.s2k.type!=="gnu-dummy")}makeDummy(e=q){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=zi(l.s2k.gnu,e),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=l.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}encrypt(t){return I(this,arguments,function*(e,r=q){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!e)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=Zc(r),this.s2k.generateSalt();let i=nn(this.algorithm,this.privateParams);this.symmetric=l.symmetric.aes256;let{blockSize:s}=he(this.symmetric);if(r.aeadProtect){this.s2kUsage=253,this.aead=r.preferredAEADAlgorithm;let a=Er(this.aead);this.isLegacyAEAD=this.version===5,this.usedModernAEAD=!this.isLegacyAEAD;let o=Ci(this.constructor.tag),c=yield Os(this.version,this.s2k,e,this.symmetric,this.aead,o,this.isLegacyAEAD),f=yield a(this.symmetric,c);this.iv=this.isLegacyAEAD?Me(s):Me(a.ivLength);let h=this.isLegacyAEAD?new Uint8Array:d.concatUint8Array([o,this.writePublicKey()]);this.keyMaterial=yield f.encrypt(i,this.iv.subarray(0,a.ivLength),h)}else{this.s2kUsage=254,this.usedModernAEAD=!1;let a=yield Os(this.version,this.s2k,e,this.symmetric);this.iv=Me(s),this.keyMaterial=yield ho(this.symmetric,a,d.concatUint8Array([i,yield Ut(l.hash.sha1,i)]),this.iv)}})}decrypt(e){return I(this,null,function*(){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let r,t=Ci(this.constructor.tag);if(this.s2kUsage!==254&&this.s2kUsage!==253)throw this.s2kUsage===255?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");let i;if(r=yield Os(this.version,this.s2k,e,this.symmetric,this.aead,t,this.isLegacyAEAD),this.s2kUsage===253){let s=Er(this.aead,!0),a=yield s(this.symmetric,r);try{let o=this.isLegacyAEAD?new Uint8Array:d.concatUint8Array([t,this.writePublicKey()]);i=yield a.decrypt(this.keyMaterial,this.iv.subarray(0,s.ivLength),o)}catch(o){throw o.message==="Authentication tag mismatch"?Error("Incorrect key passphrase: "+o.message):o}}else{let s=yield fo(this.symmetric,r,this.keyMaterial,this.iv);i=s.subarray(0,-20);let a=yield Ut(l.hash.sha1,i);if(!d.equalsUint8Array(a,s.subarray(-20)))throw Error("Incorrect key passphrase")}try{let{privateParams:s}=Go(this.algorithm,i,this.publicParams);this.privateParams=s}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null})}validate(){return I(this,null,function*(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");if(this.usedModernAEAD)return;let e;try{e=yield J0(this.algorithm,this.publicParams,this.privateParams)}catch{e=!1}if(!e)throw Error("Key is invalid")})}generate(e,r){return I(this,null,function*(){if(this.version===6&&(this.algorithm===l.publicKey.ecdh&&r===l.curve.curve25519Legacy||this.algorithm===l.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${r}. Generate a key of type 'curve25519' instead`);let{privateParams:t,publicParams:i}=yield Z0(this.algorithm,e,r);this.privateParams=t,this.publicParams=i,this.isEncrypted=!1})}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach(e=>{this.privateParams[e].fill(0),delete this.privateParams[e]}),this.privateParams=null,this.isEncrypted=!0)}};function Os(n,e,r,t,i,s,a){return I(this,null,function*(){if(e.type==="argon2"&&!i)throw Error("Using Argon2 S2K without AEAD is not allowed");if(e.type==="simple"&&n===6)throw Error("Using Simple S2K with version 6 keys is not allowed");let{keySize:o}=he(t),c=yield e.produceKey(r,o);if(!i||n===5||a)return c;let f=d.concatUint8Array([s,new Uint8Array([n,t,i])]);return hr(l.hash.sha256,c,new Uint8Array,f,o)})}var Ca=class n{static get tag(){return l.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(e){if(d.isString(e)||e.name&&!d.isString(e.name)||e.email&&!d.isEmailAddress(e.email)||e.comment&&!d.isString(e.comment))throw Error("Invalid user ID format");let r=new n;Object.assign(r,e);let t=[];return r.name&&t.push(r.name),r.comment&&t.push(`(${r.comment})`),r.email&&t.push(`<${r.email}>`),r.userID=t.join(" "),r}read(e,r=q){let t=d.decodeUTF8(e);if(t.length>r.maxUserIDLength)throw Error("User ID string is too long");let i=o=>/^[^\s@]+@[^\s@]+$/.test(o),s=t.indexOf("<"),a=t.lastIndexOf(">");if(s!==-1&&a!==-1&&a>s){let o=t.substring(s+1,a);if(i(o)){this.email=o;let c=t.substring(0,s).trim(),f=c.indexOf("("),h=c.lastIndexOf(")");f!==-1&&h!==-1&&h>f?(this.comment=c.substring(f+1,h).trim(),this.name=c.substring(0,f).trim()):(this.name=c,this.comment="")}}else i(t.trim())&&(this.email=t.trim(),this.name="",this.comment="");this.userID=t}write(){return d.encodeUTF8(this.userID)}equals(e){return e&&e.userID===this.userID}},Wi=class extends Xi{static get tag(){return l.packet.secretSubkey}constructor(e=new Date,r=q){super(e,r)}};var $i=class{constructor(e){this.packets=e||new we}write(){return this.packets.write()}armor(e=q){let r=this.packets.some(t=>t.constructor.tag===_e.tag&&t.version!==6);return Yn(l.armor.signature,this.write(),void 0,void 0,void 0,r,e)}getSigningKeyIDs(){return this.packets.map(e=>e.issuerKeyID)}};function I3(n,e){return I(this,null,function*(){let r=new Wi(n.date,e);return r.packets=null,r.algorithm=l.write(l.publicKey,n.algorithm),yield r.generate(n.rsaBits,n.curve),yield r.computeFingerprintAndKeyID(),r})}function ut(a,o,c,f){return I(this,arguments,function*(n,e,r,t,i=new Date,s){let h,u;for(let y=n.length-1;y>=0;y--)try{(!h||n[y].created>=h.created)&&(yield n[y].verify(e,r,t,i,void 0,s),h=n[y])}catch(g){u=g}if(!h)throw d.wrapError(`Could not find valid ${l.read(l.signature,r)} signature in key ${e.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(y,g,p)=>g+" "+p.toLowerCase()),u);return h})}function Ua(n,e,r=new Date){let t=d.normalizeDate(r);if(t!==null){let i=es(n,e);return!(n.created<=t&&t<i)}return!1}function S3(n,e,r,t){return I(this,null,function*(){let i={};i.key=e,i.bind=n;let s={signatureType:l.signature.subkeyBinding};return r.sign?(s.keyFlags=[l.keyFlags.signData],s.embeddedSignature=yield Kr(i,[],n,{signatureType:l.signature.keyBinding},r.date,void 0,void 0,void 0,t)):s.keyFlags=[l.keyFlags.encryptCommunication|l.keyFlags.encryptStorage],r.keyExpirationTime>0&&(s.keyExpirationTime=r.keyExpirationTime,s.keyNeverExpires=!1),yield Kr(i,[],e,s,r.date,void 0,void 0,void 0,t)})}function K3(s,a){return I(this,arguments,function*(n,e,r=new Date,t=[],i){let o=l.hash.sha256,c=i.preferredHashAlgorithm,f=yield Promise.all(n.map((g,p)=>I(null,null,function*(){return(yield g.getPrimarySelfSignature(r,t[p],i)).preferredHashAlgorithms||[]}))),h=new Map;for(let g of f)for(let p of g)try{let w=l.write(l.hash,p);h.set(w,h.has(w)?h.get(w)+1:1)}catch{}let u=g=>n.length===0||h.get(g)===n.length||g===o,y=()=>{if(h.size===0)return o;let g=Array.from(h.keys()).filter(p=>u(p)).sort((p,w)=>ve(p)-ve(w))[0];return ve(g)>=ve(o)?g:o};if(new Set([l.publicKey.ecdsa,l.publicKey.eddsaLegacy,l.publicKey.ed25519,l.publicKey.ed448]).has(e.algorithm)){let g=function(A,k){switch(A){case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:return Fc(k);case l.publicKey.ed25519:case l.publicKey.ed448:return ps(A);default:throw Error("Unknown elliptic signing algo")}}(e.algorithm,e.publicParams.oid),p=u(c),w=ve(c)>=ve(g);if(p&&w)return c;{let A=y();return ve(A)>=ve(g)?A:g}}return u(c)?c:y()})}function Kr(f,h,u,y,g,p){return I(this,arguments,function*(n,e,r,t,i,s,a=[],o=!1,c){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");let w=new _e;return Object.assign(w,t),w.publicKeyAlgorithm=r.algorithm,w.hashAlgorithm=yield K3(e,r,i,s,c),w.rawNotations=[...a],yield w.sign(r,n,i,o,c),w})}function vr(s,a,o){return I(this,arguments,function*(n,e,r,t=new Date,i){(n=n[r])&&(e[r].length?yield Promise.all(n.map(function(c){return I(this,null,function*(){c.isExpired(t)||i&&!(yield i(c))||e[r].some(function(f){return d.equalsUint8Array(f.writeParams(),c.writeParams())})||e[r].push(c)})})):e[r]=n)})}function sn(c,f,h,u,y,g){return I(this,arguments,function*(n,e,r,t,i,s,a=new Date,o){s=s||n;let p=[];return yield Promise.all(t.map(function(w){return I(this,null,function*(){try{if(!i||w.issuerKeyID.equals(i.issuerKeyID)){let A=![l.reasonForRevocation.keyRetired,l.reasonForRevocation.keySuperseded,l.reasonForRevocation.userIDInvalid].includes(w.reasonForRevocationFlag);yield w.verify(s,e,r,A?null:a,!1,o),p.push(w.issuerKeyID)}}catch{}})})),i?(i.revoked=!!p.some(w=>w.equals(i.issuerKeyID))||i.revoked||!1,i.revoked):p.length>0})}function es(n,e){let r;return e.keyNeverExpires===!1&&(r=n.created.getTime()+1e3*e.keyExpirationTime),r?new Date(r):1/0}function C3(n,e={}){switch(n.type=n.type||e.type,n.curve=n.curve||e.curve,n.rsaBits=n.rsaBits||e.rsaBits,n.keyExpirationTime=n.keyExpirationTime!==void 0?n.keyExpirationTime:e.keyExpirationTime,n.passphrase=d.isString(n.passphrase)?n.passphrase:e.passphrase,n.date=n.date||e.date,n.sign=n.sign||!1,n.type){case"ecc":try{n.curve=l.write(l.curve,n.curve)}catch{throw Error("Unknown curve")}n.curve!==l.curve.ed25519Legacy&&n.curve!==l.curve.curve25519Legacy&&n.curve!=="ed25519"&&n.curve!=="curve25519"||(n.curve=n.sign?l.curve.ed25519Legacy:l.curve.curve25519Legacy),n.sign?n.algorithm=n.curve===l.curve.ed25519Legacy?l.publicKey.eddsaLegacy:l.publicKey.ecdsa:n.algorithm=l.publicKey.ecdh;break;case"curve25519":n.algorithm=n.sign?l.publicKey.ed25519:l.publicKey.x25519;break;case"curve448":n.algorithm=n.sign?l.publicKey.ed448:l.publicKey.x448;break;case"rsa":n.algorithm=l.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+n.type)}return n}function i1(n,e,r){switch(n.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.dsa:case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:case l.publicKey.ed25519:case l.publicKey.ed448:if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!e.keyFlags||!!(e.keyFlags[0]&l.keyFlags.signData);default:return!1}}function s1(n,e,r){switch(n.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.elgamal:case l.publicKey.ecdh:case l.publicKey.x25519:case l.publicKey.x448:if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!e.keyFlags||!!(e.keyFlags[0]&l.keyFlags.encryptCommunication)||!!(e.keyFlags[0]&l.keyFlags.encryptStorage);default:return!1}}function a1(n,e,r){if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(n.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.elgamal:case l.publicKey.ecdh:case l.publicKey.x25519:case l.publicKey.x448:return!(!(!e.keyFlags||e.keyFlags[0]&l.keyFlags.signData)||!r.allowInsecureDecryptionWithSigningKeys)||!e.keyFlags||!!(e.keyFlags[0]&l.keyFlags.encryptCommunication)||!!(e.keyFlags[0]&l.keyFlags.encryptStorage);default:return!1}}function Ar(n,e){let r=l.write(l.publicKey,n.algorithm),t=n.getAlgorithmInfo();if(e.rejectPublicKeyAlgorithms.has(r))throw Error(t.algorithm+" keys are considered too weak.");switch(r){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.rsaEncrypt:if(t.bits<e.minRSABits)throw Error(`RSA keys shorter than ${e.minRSABits} bits are considered too weak.`);break;case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:case l.publicKey.ecdh:if(e.rejectCurves.has(t.curve))throw Error(`Support for ${t.algorithm} keys using curve ${t.curve} is disabled.`)}}var Pa=class n{constructor(e,r){this.userID=e.constructor.tag===l.packet.userID?e:null,this.userAttribute=e.constructor.tag===l.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=r}toPacketList(){let e=new we;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){let e=new n(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}certify(e,r,t){return I(this,null,function*(){let i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i},a=new n(s.userID||s.userAttribute,this.mainKey);return a.otherCertifications=yield Promise.all(e.map(function(o){return I(this,null,function*(){if(!o.isPrivate())throw Error("Need private key for signing");if(o.hasSameFingerprintAs(i))throw Error("The user's own key can only be used for self-certifications");let c=yield o.getSigningKey(void 0,r,void 0,t);return Kr(s,[o],c.keyPacket,{signatureType:l.signature.certGeneric,keyFlags:[l.keyFlags.certifyKeys|l.keyFlags.signData]},r,void 0,void 0,void 0,t)})})),yield a.update(this,r,t),a})}isRevoked(s,a){return I(this,arguments,function*(e,r,t=new Date,i=q){let o=this.mainKey.keyPacket;return sn(o,l.signature.certRevocation,{key:o,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,r,t,i)})}verifyCertificate(s,a){return I(this,arguments,function*(e,r,t=new Date,i){let o=this,c=this.mainKey.keyPacket,f={userID:this.userID,userAttribute:this.userAttribute,key:c},{issuerKeyID:h}=e,u=r.filter(y=>y.getKeys(h).length>0);return u.length===0?null:(yield Promise.all(u.map(y=>I(this,null,function*(){let g=yield y.getSigningKey(h,e.created,void 0,i);if(e.revoked||(yield o.isRevoked(e,g.keyPacket,t,i)))throw Error("User certificate is revoked");try{yield e.verify(g.keyPacket,l.signature.certGeneric,f,t,void 0,i)}catch(p){throw d.wrapError("User certificate is invalid",p)}}))),!0)})}verifyAllCertifications(i){return I(this,arguments,function*(e,r=new Date,t){let s=this,a=this.selfCertifications.concat(this.otherCertifications);return Promise.all(a.map(o=>I(this,null,function*(){return{keyID:o.issuerKeyID,valid:yield s.verifyCertificate(o,e,r,t).catch(()=>!1)}})))})}verify(){return I(this,arguments,function*(e=new Date,r){if(!this.selfCertifications.length)throw Error("No self-certifications found");let t=this,i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i},a;for(let o=this.selfCertifications.length-1;o>=0;o--)try{let c=this.selfCertifications[o];if(c.revoked||(yield t.isRevoked(c,void 0,e,r)))throw Error("Self-certification is revoked");try{yield c.verify(i,l.signature.certGeneric,s,e,void 0,r)}catch(f){throw d.wrapError("Self-certification is invalid",f)}return!0}catch(c){a=c}throw a})}update(e,r,t){return I(this,null,function*(){let i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i};yield vr(e,this,"selfCertifications",r,function(a){return I(this,null,function*(){try{return yield a.verify(i,l.signature.certGeneric,s,r,!1,t),!0}catch{return!1}})}),yield vr(e,this,"otherCertifications",r),yield vr(e,this,"revocationSignatures",r,function(a){return sn(i,l.signature.certRevocation,s,[a],void 0,void 0,r,t)})})}revoke(a){return I(this,arguments,function*(e,{flag:r=l.reasonForRevocation.noReason,string:t=""}={},i=new Date,s=q){let o={userID:this.userID,userAttribute:this.userAttribute,key:e},c=new n(o.userID||o.userAttribute,this.mainKey);return c.revocationSignatures.push(yield Kr(o,[],e,{signatureType:l.signature.certRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,r),reasonForRevocationString:t},i,void 0,void 0,!1,s)),yield c.update(this),c})}},zn=class n{constructor(e,r){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=r}toPacketList(){let e=new we;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){let e=new n(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}isRevoked(s,a){return I(this,arguments,function*(e,r,t=new Date,i=q){let o=this.mainKey.keyPacket;return sn(o,l.signature.subkeyRevocation,{key:o,bind:this.keyPacket},this.revocationSignatures,e,r,t,i)})}verify(){return I(this,arguments,function*(e=new Date,r=q){let t=this.mainKey.keyPacket,i={key:t,bind:this.keyPacket},s=yield ut(this.bindingSignatures,t,l.signature.subkeyBinding,i,e,r);if(s.revoked||(yield this.isRevoked(s,null,e,r)))throw Error("Subkey is revoked");if(Ua(this.keyPacket,s,e))throw Error("Subkey is expired");return s})}getExpirationTime(){return I(this,arguments,function*(e=new Date,r=q){let t=this.mainKey.keyPacket,i={key:t,bind:this.keyPacket},s;try{s=yield ut(this.bindingSignatures,t,l.signature.subkeyBinding,i,e,r)}catch{return null}let a=es(this.keyPacket,s),o=s.getExpirationTime();return a<o?a:o})}update(i){return I(this,arguments,function*(e,r=new Date,t=q){let s=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===l.packet.publicSubkey&&e.keyPacket.constructor.tag===l.packet.secretSubkey&&(this.keyPacket=e.keyPacket);let a=this,o={key:s,bind:a.keyPacket};yield vr(e,this,"bindingSignatures",r,function(c){return I(this,null,function*(){for(let f=0;f<a.bindingSignatures.length;f++)if(a.bindingSignatures[f].issuerKeyID.equals(c.issuerKeyID))return c.created>a.bindingSignatures[f].created&&(a.bindingSignatures[f]=c),!1;try{return yield c.verify(s,l.signature.subkeyBinding,o,r,void 0,t),!0}catch{return!1}})}),yield vr(e,this,"revocationSignatures",r,function(c){return sn(s,l.signature.subkeyRevocation,o,[c],void 0,void 0,r,t)})})}revoke(a){return I(this,arguments,function*(e,{flag:r=l.reasonForRevocation.noReason,string:t=""}={},i=new Date,s=q){let o={key:e,bind:this.keyPacket},c=new n(this.keyPacket,this.mainKey);return c.revocationSignatures.push(yield Kr(o,[],e,{signatureType:l.signature.subkeyRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,r),reasonForRevocationString:t},i,void 0,void 0,!1,s)),yield c.update(this),c})}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}};["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(n=>{zn.prototype[n]=function(){return this.keyPacket[n]()}});var U3=d.constructAllowedPackets([_e]),o1=new Set([l.packet.publicKey,l.packet.privateKey]),c1=new Set([l.packet.publicKey,l.packet.privateKey,l.packet.publicSubkey,l.packet.privateSubkey]),ts=class{packetListToStructure(e,r=new Set){let t,i,s,a;for(let o of e){if(o instanceof Tn){c1.has(o.tag)&&!a&&(a=o1.has(o.tag)?o1:c1);continue}let c=o.constructor.tag;if(a){if(!a.has(c))continue;a=null}if(r.has(c))throw Error("Unexpected packet type: "+c);switch(c){case l.packet.publicKey:case l.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=o,i=this.getKeyID(),!i)throw Error("Missing Key ID");break;case l.packet.userID:case l.packet.userAttribute:t=new Pa(o,this),this.users.push(t);break;case l.packet.publicSubkey:case l.packet.secretSubkey:t=null,s=new zn(o,this),this.subkeys.push(s);break;case l.packet.signature:switch(o.signatureType){case l.signature.certGeneric:case l.signature.certPersona:case l.signature.certCasual:case l.signature.certPositive:if(!t){d.printDebug("Dropping certification signatures without preceding user packet");continue}o.issuerKeyID.equals(i)?t.selfCertifications.push(o):t.otherCertifications.push(o);break;case l.signature.certRevocation:t?t.revocationSignatures.push(o):this.directSignatures.push(o);break;case l.signature.key:this.directSignatures.push(o);break;case l.signature.subkeyBinding:if(!s){d.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}s.bindingSignatures.push(o);break;case l.signature.keyRevocation:this.revocationSignatures.push(o);break;case l.signature.subkeyRevocation:if(!s){d.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}s.revocationSignatures.push(o)}}}}toPacketList(){let e=new we;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map(r=>e.push(...r.toPacketList())),this.subkeys.map(r=>e.push(...r.toPacketList())),e}clone(e=!1){let r=new this.constructor(this.toPacketList());return e&&r.getKeys().forEach(t=>{if(t.keyPacket=Object.create(Object.getPrototypeOf(t.keyPacket),Object.getOwnPropertyDescriptors(t.keyPacket)),!t.keyPacket.isDecrypted())return;let i={};Object.keys(t.keyPacket.privateParams).forEach(s=>{i[s]=new Uint8Array(t.keyPacket.privateParams[s])}),t.keyPacket.privateParams=i}),r}getSubkeys(e=null){return this.subkeys.filter(r=>!e||r.getKeyID().equals(e,!0))}getKeys(e=null){let r=[];return e&&!this.getKeyID().equals(e,!0)||r.push(this),r.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map(e=>e.getKeyID())}getUserIDs(){return this.users.map(e=>e.userID?e.userID.userID:null).filter(e=>e!==null)}write(){return this.toPacketList().write()}getSigningKey(){return I(this,arguments,function*(e=null,r=new Date,t={},i=q){yield this.verifyPrimaryKey(r,t,i);let s=this.keyPacket;try{Ar(s,i)}catch(c){throw d.wrapError("Could not verify primary key",c)}let a=this.subkeys.slice().sort((c,f)=>f.keyPacket.created-c.keyPacket.created||f.keyPacket.algorithm-c.keyPacket.algorithm),o;for(let c of a)if(!e||c.getKeyID().equals(e))try{yield c.verify(r,i);let f={key:s,bind:c.keyPacket},h=yield ut(c.bindingSignatures,s,l.signature.subkeyBinding,f,r,i);if(!i1(c.keyPacket,h,i))continue;if(!h.embeddedSignature)throw Error("Missing embedded signature");return yield ut([h.embeddedSignature],c.keyPacket,l.signature.keyBinding,f,r,i),Ar(c.keyPacket,i),c}catch(f){o=f}try{let c=yield this.getPrimarySelfSignature(r,t,i);if((!e||s.getKeyID().equals(e))&&i1(s,c,i))return Ar(s,i),this}catch(c){o=c}throw d.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),o)})}getEncryptionKey(s){return I(this,arguments,function*(e,r=new Date,t={},i=q){yield this.verifyPrimaryKey(r,t,i);let a=this.keyPacket;try{Ar(a,i)}catch(f){throw d.wrapError("Could not verify primary key",f)}let o=this.subkeys.slice().sort((f,h)=>h.keyPacket.created-f.keyPacket.created||h.keyPacket.algorithm-f.keyPacket.algorithm),c;for(let f of o)if(!e||f.getKeyID().equals(e))try{yield f.verify(r,i);let h={key:a,bind:f.keyPacket},u=yield ut(f.bindingSignatures,a,l.signature.subkeyBinding,h,r,i);if(s1(f.keyPacket,u,i))return Ar(f.keyPacket,i),f}catch(h){c=h}try{let f=yield this.getPrimarySelfSignature(r,t,i);if((!e||a.getKeyID().equals(e))&&s1(a,f,i))return Ar(a,i),this}catch(f){c=f}throw d.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),c)})}isRevoked(s,a){return I(this,arguments,function*(e,r,t=new Date,i=q){return sn(this.keyPacket,l.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,r,t,i)})}verifyPrimaryKey(){return I(this,arguments,function*(e=new Date,r={},t=q){let i=this.keyPacket;if(yield this.isRevoked(null,null,e,t))throw Error("Primary key is revoked");if(Ua(i,yield this.getPrimarySelfSignature(e,r,t),e))throw Error("Primary key is expired");if(i.version!==6){let s=yield ut(this.directSignatures,i,l.signature.key,{key:i},e,t).catch(()=>{});if(s&&Ua(i,s,e))throw Error("Primary key is expired")}})}getExpirationTime(t){return I(this,arguments,function*(e,r=q){let i;try{let s=yield this.getPrimarySelfSignature(null,e,r),a=es(this.keyPacket,s),o=s.getExpirationTime(),c=this.keyPacket.version!==6&&(yield ut(this.directSignatures,this.keyPacket,l.signature.key,{key:this.keyPacket},null,r).catch(()=>{}));if(c){let f=es(this.keyPacket,c);i=Math.min(a,o,f)}else i=a<o?a:o}catch{i=null}return d.normalizeDate(i)})}getPrimarySelfSignature(){return I(this,arguments,function*(e=new Date,r={},t=q){let i=this.keyPacket;if(i.version===6)return ut(this.directSignatures,i,l.signature.key,{key:i},e,t);let{selfCertification:s}=yield this.getPrimaryUser(e,r,t);return s})}getPrimaryUser(){return I(this,arguments,function*(e=new Date,r={},t=q){let i=this.keyPacket,s=[],a;for(let h=0;h<this.users.length;h++)try{let u=this.users[h];if(!u.userID)continue;if(r.name!==void 0&&u.userID.name!==r.name||r.email!==void 0&&u.userID.email!==r.email||r.comment!==void 0&&u.userID.comment!==r.comment)throw Error("Could not find user that matches that user ID");let y={userID:u.userID,key:i},g=yield ut(u.selfCertifications,i,l.signature.certGeneric,y,e,t);s.push({index:h,user:u,selfCertification:g})}catch(u){a=u}if(!s.length)throw a||Error("Could not find primary user");yield Promise.all(s.map(function(h){return I(this,null,function*(){return h.selfCertification.revoked||h.user.isRevoked(h.selfCertification,null,e,t)})}));let o=s.sort(function(h,u){let y=h.selfCertification,g=u.selfCertification;return g.revoked-y.revoked||y.isPrimaryUserID-g.isPrimaryUserID||y.created-g.created}).pop(),{user:c,selfCertification:f}=o;if(f.revoked||(yield c.isRevoked(f,null,e,t)))throw Error("Primary user is revoked");return o})}update(i){return I(this,arguments,function*(e,r=new Date,t=q){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(!(this.subkeys.length===e.subkeys.length&&this.subkeys.every(a=>e.subkeys.some(o=>a.hasSameFingerprintAs(o)))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,t)}let s=this.clone();return yield vr(e,s,"revocationSignatures",r,a=>sn(s.keyPacket,l.signature.keyRevocation,s,[a],null,e.keyPacket,r,t)),yield vr(e,s,"directSignatures",r),yield Promise.all(e.users.map(a=>I(this,null,function*(){let o=s.users.filter(c=>a.userID&&a.userID.equals(c.userID)||a.userAttribute&&a.userAttribute.equals(c.userAttribute));if(o.length>0)yield Promise.all(o.map(c=>c.update(a,r,t)));else{let c=a.clone();c.mainKey=s,s.users.push(c)}}))),yield Promise.all(e.subkeys.map(a=>I(this,null,function*(){let o=s.subkeys.filter(c=>c.hasSameFingerprintAs(a));if(o.length>0)yield Promise.all(o.map(c=>c.update(a,r,t)));else{let c=a.clone();c.mainKey=s,s.subkeys.push(c)}}))),s})}getRevocationCertificate(){return I(this,arguments,function*(e=new Date,r=q){let t={key:this.keyPacket},i=yield ut(this.revocationSignatures,this.keyPacket,l.signature.keyRevocation,t,e,r),s=new we;s.push(i);let a=this.keyPacket.version!==6;return Yn(l.armor.publicKey,s.write(),null,null,"This is a revocation certificate",a,r)})}applyRevocationCertificate(i){return I(this,arguments,function*(e,r=new Date,t=q){let s=yield Xa(e),a=(yield we.fromBinary(s.data,U3,t)).findPacket(l.packet.signature);if(!a||a.signatureType!==l.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!a.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{yield a.verify(this.keyPacket,l.signature.keyRevocation,{key:this.keyPacket},r,void 0,t)}catch(c){throw d.wrapError("Could not verify revocation signature",c)}let o=this.clone();return o.revocationSignatures.push(a),o})}signPrimaryUser(s,a,o){return I(this,arguments,function*(e,r,t,i=q){let{index:c,user:f}=yield this.getPrimaryUser(r,t,i),h=yield f.certify(e,r,i),u=this.clone();return u.users[c]=h,u})}signAllUsers(i){return I(this,arguments,function*(e,r=new Date,t=q){let s=this.clone();return s.users=yield Promise.all(this.users.map(function(a){return a.certify(e,r,t)})),s})}verifyPrimaryUser(s){return I(this,arguments,function*(e,r=new Date,t,i=q){let a=this.keyPacket,{user:o}=yield this.getPrimaryUser(r,t,i);return e?yield o.verifyAllCertifications(e,r,i):[{keyID:a.getKeyID(),valid:yield o.verify(r,i).catch(()=>!1)}]})}verifyAllUsers(i){return I(this,arguments,function*(e,r=new Date,t=q){let s=this.keyPacket,a=[];return yield Promise.all(this.users.map(o=>I(this,null,function*(){let c=e?yield o.verifyAllCertifications(e,r,t):[{keyID:s.getKeyID(),valid:yield o.verify(r,t).catch(()=>!1)}];a.push(...c.map(f=>({userID:o.userID?o.userID.userID:null,userAttribute:o.userAttribute,keyID:f.keyID,valid:f.valid})))}))),a})}};["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(n=>{ts.prototype[n]=zn.prototype[n]});var Gn=class extends ts{constructor(e){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],e&&(this.packetListToStructure(e,new Set([l.packet.secretKey,l.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(e=q){let r=this.keyPacket.version!==6;return Yn(l.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,r,e)}},Da=class n extends Gn{constructor(e){if(super(),this.packetListToStructure(e,new Set([l.packet.publicKey,l.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){let e=new we,r=this.toPacketList();for(let t of r)switch(t.constructor.tag){case l.packet.secretKey:{let i=It.fromSecretKeyPacket(t);e.push(i);break}case l.packet.secretSubkey:{let i=Ji.fromSecretSubkeyPacket(t);e.push(i);break}default:e.push(t)}return new Gn(e)}armor(e=q){let r=this.keyPacket.version!==6;return Yn(l.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,r,e)}getDecryptionKeys(s){return I(this,arguments,function*(e,r=new Date,t={},i=q){let a=this.keyPacket,o=[],c=null;for(let h=0;h<this.subkeys.length;h++)if(!e||this.subkeys[h].getKeyID().equals(e,!0)){if(this.subkeys[h].keyPacket.isDummy()){c=c||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{let u={key:a,bind:this.subkeys[h].keyPacket},y=yield ut(this.subkeys[h].bindingSignatures,a,l.signature.subkeyBinding,u,r,i);a1(this.subkeys[h].keyPacket,y,i)&&o.push(this.subkeys[h])}catch(u){c=u}}let f=yield this.getPrimarySelfSignature(r,t,i);if(e&&!a.getKeyID().equals(e,!0)||!a1(a,f,i)||(a.isDummy()?c=c||Error("Gnu-dummy key packets cannot be used for decryption"):o.push(this)),o.length===0)throw c||Error("No decryption key packets found");return o})}isDecrypted(){return this.getKeys().some(({keyPacket:e})=>e.isDecrypted())}validate(){return I(this,arguments,function*(e=q){if(!this.isPrivate())throw Error("Cannot validate a public key");let r;if(this.keyPacket.isDummy()){let t=yield this.getSigningKey(null,null,void 0,gt(ue({},e),{rejectPublicKeyAlgorithms:new Set,minRSABits:0}));t&&!t.keyPacket.isDummy()&&(r=t.keyPacket)}else r=this.keyPacket;if(r)return r.validate();{let t=this.getKeys();if(t.map(i=>i.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(t.map(i=>I(this,null,function*(){return i.keyPacket.validate()})))}})}clearPrivateParams(){this.getKeys().forEach(({keyPacket:e})=>{e.isDecrypted()&&e.clearPrivateParams()})}revoke(){return I(this,arguments,function*({flag:e=l.reasonForRevocation.noReason,string:r=""}={},t=new Date,i=q){if(!this.isPrivate())throw Error("Need private key for revoking");let s={key:this.keyPacket},a=this.clone();return a.revocationSignatures.push(yield Kr(s,[],this.keyPacket,{signatureType:l.signature.keyRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,e),reasonForRevocationString:r},t,void 0,void 0,void 0,i)),a})}addSubkey(){return I(this,arguments,function*(e={}){let r=ue(ue({},q),e.config);if(e.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(e.rsaBits<r.minRSABits)throw Error(`rsaBits should be at least ${r.minRSABits}, got: ${e.rsaBits}`);let t=this.keyPacket;if(t.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!t.isDecrypted())throw Error("Key is not decrypted");let i=t.getAlgorithmInfo();i.type=function(c){switch(l.write(l.publicKey,c)){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.dsa:return"rsa";case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:return"ecc";case l.publicKey.ed25519:return"curve25519";case l.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}}(i.algorithm),i.rsaBits=i.bits||4096,i.curve=i.curve||"curve25519Legacy",e=C3(e,i);let s=yield I3(e,gt(ue({},r),{v6Keys:this.keyPacket.version===6}));Ar(s,r);let a=yield S3(s,t,e,r),o=this.toPacketList();return o.push(s,a),new n(o)})}},P3=d.constructAllowedPackets([It,Ji,Xi,Wi,Ca,Ka,_e]);function D3(n){for(let e of n)switch(e.constructor.tag){case l.packet.secretKey:return new Da(n);case l.packet.publicKey:return new Gn(n)}throw Error("No key packet found")}function n2(i){return I(this,null,function*(){var s=i,{armoredKey:n,binaryKey:e,config:r}=s,t=ei(s,["armoredKey","binaryKey","config"]);if(r=ue(ue({},q),r),!n&&!e)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(n&&!d.isString(n))throw Error("readKey: options.armoredKey must be a string");if(e&&!d.isUint8Array(e))throw Error("readKey: options.binaryKey must be a Uint8Array");let a=Object.keys(t);if(a.length>0)throw Error("Unknown option: "+a.join(", "));let o;if(n){let{type:h,data:u}=yield Xa(n);if(h!==l.armor.publicKey&&h!==l.armor.privateKey)throw Error("Armored text not of type key");o=u}else o=e;let c=yield we.fromBinary(o,P3,r),f=c.indexOfTag(l.packet.publicKey,l.packet.secretKey);if(f.length===0)throw Error("No key packet found");return D3(c.slice(f[0],f[1]))})}var x3=d.constructAllowedPackets([Zi]),Q3=d.constructAllowedPackets([_e]),rs=class n{constructor(e){this.packets=e||new we}getEncryptionKeyIDs(){let e=[];return this.packets.filterByTag(l.packet.publicKeyEncryptedSessionKey).forEach(function(r){e.push(r.publicKeyID)}),e}getSigningKeyIDs(){let e=this.unwrapCompressed(),r=e.packets.filterByTag(l.packet.onePassSignature);return r.length>0?r.map(t=>t.issuerKeyID):e.packets.filterByTag(l.packet.signature).map(t=>t.issuerKeyID)}decrypt(a,o,c){return I(this,arguments,function*(e,r,t,i=new Date,s=q){let f=this.packets.filterByTag(l.packet.symmetricallyEncryptedData,l.packet.symEncryptedIntegrityProtectedData,l.packet.aeadEncryptedData);if(f.length===0)throw Error("No encrypted data found");let h=f[0],u=h.cipherAlgorithm,y=t||(yield this.decryptSessionKeys(e,r,u,i,s)),g=null,p=Promise.all(y.map(S=>I(this,[S],function*({algorithm:A,data:k}){if(!d.isUint8Array(k)||!h.cipherAlgorithm&&!d.isString(A))throw Error("Invalid session key for decryption.");try{let m=h.cipherAlgorithm||l.write(l.symmetric,A);yield h.decrypt(m,k,s)}catch(m){d.printDebugError(m),g=m}})));if(na(h.encrypted),h.encrypted=null,yield p,!h.packets||!h.packets.length)throw g||Error("Decryption failed.");let w=new n(h.packets);return h.packets=new we,w})}decryptSessionKeys(a,o,c){return I(this,arguments,function*(e,r,t,i=new Date,s=q){let f,h=[];if(r){let u=this.packets.filterByTag(l.packet.symEncryptedSessionKey);if(u.length===0)throw Error("No symmetrically encrypted session key packet found.");yield Promise.all(r.map(function(y,g){return I(this,null,function*(){let p;p=g?yield we.fromBinary(u.write(),x3,s):u,yield Promise.all(p.map(function(w){return I(this,null,function*(){try{yield w.decrypt(y),h.push(w)}catch(A){d.printDebugError(A),A instanceof Hi&&(f=A)}})}))})}))}else{if(!e)throw Error("No key or password specified.");{let u=this.packets.filterByTag(l.packet.publicKeyEncryptedSessionKey);if(u.length===0)throw Error("No public key encrypted session key packet found.");yield Promise.all(u.map(function(y){return I(this,null,function*(){yield Promise.all(e.map(function(g){return I(this,null,function*(){let p;try{p=(yield g.getDecryptionKeys(y.publicKeyID,null,void 0,s)).map(A=>A.keyPacket)}catch(A){return void(f=A)}let w=[l.symmetric.aes256,l.symmetric.aes128,l.symmetric.tripledes,l.symmetric.cast5];try{let A=yield g.getPrimarySelfSignature(i,void 0,s);A.preferredSymmetricAlgorithms&&(w=w.concat(A.preferredSymmetricAlgorithms))}catch{}yield Promise.all(p.map(function(A){return I(this,null,function*(){if(!A.isDecrypted())throw Error("Decryption key is not decrypted.");if(s.constantTimePKCS1Decryption&&(y.publicKeyAlgorithm===l.publicKey.rsaEncrypt||y.publicKeyAlgorithm===l.publicKey.rsaEncryptSign||y.publicKeyAlgorithm===l.publicKey.rsaSign||y.publicKeyAlgorithm===l.publicKey.elgamal)){let k=y.write();yield Promise.all((t?[t]:Array.from(s.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map(S=>I(null,null,function*(){let m=new Yi;m.read(k);let E={sessionKeyAlgorithm:S,sessionKey:Aa(S)};try{yield m.decrypt(A,E),h.push(m)}catch(D){d.printDebugError(D),f=D}})))}else try{yield y.decrypt(A);let k=t||y.sessionKeyAlgorithm;if(k&&!w.includes(l.write(l.symmetric,k)))throw Error("A non-preferred symmetric algorithm was used.");h.push(y)}catch(k){d.printDebugError(k),f=k}})}))})})),na(y.encrypted),y.encrypted=null})}))}}if(h.length>0){if(h.length>1){let u=new Set;h=h.filter(y=>{let g=y.sessionKeyAlgorithm+d.uint8ArrayToString(y.sessionKey);return!u.has(g)&&(u.add(g),!0)})}return h.map(u=>({data:u.sessionKey,algorithm:u.sessionKeyAlgorithm&&l.read(l.symmetric,u.sessionKeyAlgorithm)}))}throw f||Error("Session key decryption failed.")})}getLiteralData(){let e=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return e&&e.getBytes()||null}getFilename(){let e=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return e&&e.getFilename()||null}getText(){let e=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return e?e.getText():null}static generateSessionKey(){return I(this,arguments,function*(e=[],r=new Date,t=[],i=q){let{symmetricAlgo:s,aeadAlgo:a}=yield function(){return I(this,arguments,function*(f=[],h=new Date,u=[],y=q){let g=yield Promise.all(f.map((A,k)=>A.getPrimarySelfSignature(h,u[k],y)));if(f.length?g.every(A=>A.features&&A.features[0]&l.features.seipdv2):y.aeadProtect){let A={symmetricAlgo:l.symmetric.aes128,aeadAlgo:l.aead.ocb},k=[{symmetricAlgo:y.preferredSymmetricAlgorithm,aeadAlgo:y.preferredAEADAlgorithm},{symmetricAlgo:y.preferredSymmetricAlgorithm,aeadAlgo:l.aead.ocb},{symmetricAlgo:l.symmetric.aes128,aeadAlgo:y.preferredAEADAlgorithm}];for(let S of k)if(g.every(m=>m.preferredCipherSuites&&m.preferredCipherSuites.some(E=>E[0]===S.symmetricAlgo&&E[1]===S.aeadAlgo)))return S;return A}let p=l.symmetric.aes128,w=y.preferredSymmetricAlgorithm;return{symmetricAlgo:g.every(A=>A.preferredSymmetricAlgorithms&&A.preferredSymmetricAlgorithms.includes(w))?w:p,aeadAlgo:void 0}})}(e,r,t,i),o=l.read(l.symmetric,s),c=a?l.read(l.aead,a):void 0;return yield Promise.all(e.map(f=>f.getEncryptionKey().catch(()=>null).then(h=>{if(h&&(h.keyPacket.algorithm===l.publicKey.x25519||h.keyPacket.algorithm===l.publicKey.x448)&&!c&&!d.isAES(s))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:Aa(s),algorithm:o,aeadAlgorithm:c}})}encrypt(f,h,u){return I(this,arguments,function*(e,r,t,i=!1,s=[],a=new Date,o=[],c=q){if(t){if(!d.isUint8Array(t.data)||!d.isString(t.algorithm))throw Error("Invalid session key for encryption.")}else if(e&&e.length)t=yield n.generateSessionKey(e,a,o,c);else{if(!r||!r.length)throw Error("No keys, passwords, or session key provided.");t=yield n.generateSessionKey(void 0,void 0,void 0,c)}let{data:y,algorithm:g,aeadAlgorithm:p}=t,w=yield n.encryptSessionKey(y,g,p,e,r,i,s,a,o,c),A=Hn.fromObject({version:p?2:1,aeadAlgorithm:p?l.write(l.aead,p):null});A.packets=this.packets;let k=l.write(l.symmetric,g);return yield A.encrypt(k,y,c),w.packets.push(A),A.packets=new we,w})}static encryptSessionKey(u,y,g,p,w){return I(this,arguments,function*(e,r,t,i,s,a=!1,o=[],c=new Date,f=[],h=q){let A=new we,k=l.write(l.symmetric,r),S=t&&l.write(l.aead,t);if(i){let m=yield Promise.all(i.map(function(E,D){return I(this,null,function*(){let R=yield E.getEncryptionKey(o[D],c,f,h),U=Yi.fromObject({version:S?6:3,encryptionKeyPacket:R.keyPacket,anonymousRecipient:a,sessionKey:e,sessionKeyAlgorithm:k});return yield U.encrypt(R.keyPacket),delete U.sessionKey,U})}));A.push(...m)}if(s){let m=function(U,B){return I(this,null,function*(){try{return yield U.decrypt(B),1}catch{return 0}})},E=(U,B)=>U+B,D=function(U,B,b,C){return I(this,null,function*(){let v=new Zi(h);return v.sessionKey=U,v.sessionKeyAlgorithm=B,b&&(v.aeadAlgorithm=b),yield v.encrypt(C,h),h.passwordCollisionCheck&&(yield Promise.all(s.map(K=>m(v,K)))).reduce(E)!==1?D(U,B,C):(delete v.sessionKey,v)})},R=yield Promise.all(s.map(U=>D(e,k,S,U)));A.push(...R)}return new n(A)})}sign(){return I(this,arguments,function*(e=[],r=[],t=null,i=[],s=new Date,a=[],o=[],c=[],f=q){let h=new we,u=this.packets.findPacket(l.packet.literalData);if(!u)throw Error("No literal data packet to sign.");let y=yield u1(u,e,r,t,i,s,a,o,c,!1,f),g=y.map((p,w)=>zt.fromSignaturePacket(p,w===0)).reverse();return h.push(...g),h.push(u),h.push(...y),new n(h)})}compress(e,r=q){if(e===l.compression.uncompressed)return this;let t=new Vi(r);t.algorithm=e,t.packets=this.packets;let i=new we;return i.push(t),new n(i)}signDetached(){return I(this,arguments,function*(e=[],r=[],t=null,i=[],s=[],a=new Date,o=[],c=[],f=q){let h=this.packets.findPacket(l.packet.literalData);if(!h)throw Error("No literal data packet to sign.");return new $i(yield u1(h,e,r,t,i,s,a,o,c,!0,f))})}verify(i){return I(this,arguments,function*(e,r=new Date,t=q){let s=this.unwrapCompressed(),a=s.packets.filterByTag(l.packet.literalData);if(a.length!==1)throw Error("Can only verify message with one literal data packet.");let o=s.packets;Ee(o.stream)&&(o=o.concat(yield De(o.stream,h=>h||[])));let c=o.filterByTag(l.packet.onePassSignature).reverse(),f=o.filterByTag(l.packet.signature);return c.length&&!f.length&&d.isStream(o.stream)&&!Ee(o.stream)?(yield Promise.all(c.map(h=>I(this,null,function*(){h.correspondingSig=new Promise((u,y)=>{h.correspondingSigResolve=u,h.correspondingSigReject=y}),h.signatureData=xr(()=>I(this,null,function*(){return(yield h.correspondingSig).signatureData})),h.hashed=De(yield h.hash(h.signatureType,a[0],void 0,!1)),h.hashed.catch(()=>{})}))),o.stream=Dr(o.stream,(h,u)=>I(this,null,function*(){let y=Gt(h),g=st(u);try{for(let p=0;p<c.length;p++){let{value:w}=yield y.read();c[p].correspondingSigResolve(w)}yield y.readToEnd(),yield g.ready,yield g.close()}catch(p){c.forEach(w=>{w.correspondingSigReject(p)}),yield g.abort(p)}})),Hs(c,a,e,r,!1,t)):Hs(f,a,e,r,!1,t)})}verifyDetached(e,r,t=new Date,i=q){let s=this.unwrapCompressed().packets.filterByTag(l.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");return Hs(e.packets.filterByTag(l.packet.signature),s,r,t,!0,i)}unwrapCompressed(){let e=this.packets.filterByTag(l.packet.compressedData);return e.length?new n(e[0].packets):this}appendSignature(t){return I(this,arguments,function*(e,r=q){yield this.packets.read(d.isUint8Array(e)?e:(yield Xa(e)).data,Q3,r)})}write(){return this.packets.write()}armor(e=q){let r=this.packets[this.packets.length-1],t=r.constructor.tag===Hn.tag?r.version!==2:this.packets.some(i=>i.constructor.tag===_e.tag&&i.version!==6);return Yn(l.armor.message,this.write(),null,null,null,t,e)}};function u1(u,y){return I(this,arguments,function*(n,e,r=[],t=null,i=[],s=new Date,a=[],o=[],c=[],f=!1,h=q){let g=new we,p=n.text===null?l.signature.binary:l.signature.text;if(yield Promise.all(e.map((w,A)=>I(null,null,function*(){let k=a[A];if(!w.isPrivate())throw Error("Need private key for signing");let S=yield w.getSigningKey(i[A],s,k,h);return Kr(n,r.length?r:[w],S.keyPacket,{signatureType:p},s,o,c,f,h)}))).then(w=>{g.push(...w)}),t){let w=t.packets.filterByTag(l.packet.signature);g.push(...w)}return g})}function Hs(a,o,c){return I(this,arguments,function*(n,e,r,t=new Date,i=!1,s=q){return Promise.all(n.filter(function(f){return["text","binary"].includes(l.read(l.signature,f.signatureType))}).map(function(f){return I(this,null,function*(){return function(A,k,S){return I(this,arguments,function*(h,u,y,g=new Date,p=!1,w=q){let m,E;for(let U of y){let B=U.getKeys(h.issuerKeyID);if(B.length>0){m=U,E=B[0];break}}let D=h instanceof zt?h.correspondingSig:h,R={keyID:h.issuerKeyID,verified:I(null,null,function*(){if(!E)throw Error("Could not find signing key with key ID "+h.issuerKeyID.toHex());yield h.verify(E.keyPacket,h.signatureType,u[0],g,p,w);let U=yield D;if(E.getCreationTime()>U.created)throw Error("Key is newer than the signature");try{yield m.getSigningKey(E.getKeyID(),U.created,void 0,w)}catch(B){if(!w.allowInsecureVerificationWithReformattedKeys||!B.message.match(/Signature creation time is in the future/))throw B;yield m.getSigningKey(E.getKeyID(),g,void 0,w)}return!0}),signature:I(null,null,function*(){let U=yield D,B=new we;return U&&B.push(U),new $i(B)})};return R.signature.catch(()=>{}),R.verified.catch(()=>{}),R})}(f,e,r,t,i,s)})}))})}function i2(a){return I(this,null,function*(){var o=a,{text:n,binary:e,filename:r,date:t=new Date,format:i=n!==void 0?"utf8":"binary"}=o,s=ei(o,["text","binary","filename","date","format"]);let c=n!==void 0?n:e;if(c===void 0)throw Error("createMessage: must pass options object containing `text` or `binary`");if(n&&!d.isString(n)&&!d.isStream(n))throw Error("createMessage: options.text must be a string or stream");if(e&&!d.isUint8Array(e)&&!d.isStream(e))throw Error("createMessage: options.binary must be a Uint8Array or stream");let f=Object.keys(s);if(f.length>0)throw Error("Unknown option: "+f.join(", "));let h=d.isStream(c),u=new On(t);n!==void 0?u.setText(c,l.write(l.literal,i)):u.setBytes(c,l.write(l.literal,i)),r!==void 0&&u.setFilename(r);let y=new we;y.push(u);let g=new rs(y);return g.fromStream=h,g})}function s2(A){return I(this,null,function*(){var k=A,{message:n,encryptionKeys:e,signingKeys:r,passwords:t,sessionKey:i,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:f=[],date:h=new Date,signingUserIDs:u=[],encryptionUserIDs:y=[],signatureNotations:g=[],config:p}=k,w=ei(k,["message","encryptionKeys","signingKeys","passwords","sessionKey","format","signature","wildcard","signingKeyIDs","encryptionKeyIDs","date","signingUserIDs","encryptionUserIDs","signatureNotations","config"]);if(F3(p=ue(ue({},q),p)),R3(n),T3(s),e=Yt(e),r=Yt(r),t=Yt(t),c=Yt(c),f=Yt(f),u=Yt(u),y=Yt(y),g=Yt(g),w.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(w.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(w.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(w.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");let S=Object.keys(w);if(S.length>0)throw Error("Unknown option: "+S.join(", "));r||(r=[]);try{if((r.length||a)&&(n=yield n.sign(r,e,a,c,h,u,f,g,p)),n=n.compress(yield function(){return I(this,arguments,function*(E=[],D=new Date,R=[],U=q){let B=l.compression.uncompressed,b=U.preferredCompressionAlgorithm;return(yield Promise.all(E.map(function(v,K){return I(this,null,function*(){let P=(yield v.getPrimarySelfSignature(D,R[K],U)).preferredCompressionAlgorithms;return!!P&&P.indexOf(b)>=0})}))).every(Boolean)?b:B})}(e,h,y,p),p),n=yield n.encrypt(e,t,i,o,f,h,y,p),s==="object")return n;let m=s==="armored"?n.armor(p):n.write();return yield L3(m)}catch(m){throw d.wrapError("Error encrypting message",m)}})}function R3(n){if(!(n instanceof rs))throw Error("Parameter [message] needs to be of type Message")}function T3(n){if(n!=="armored"&&n!=="binary"&&n!=="object")throw Error("Unsupported format "+n)}var M3=Object.keys(q).length;function F3(n){let e=Object.keys(n);if(e.length!==M3){for(let r of e)if(q[r]===void 0)throw Error("Unknown config property: "+r)}}function Yt(n){return n&&!d.isArray(n)&&(n=[n]),n}function L3(n){return I(this,null,function*(){return d.isStream(n)==="array"?De(n):n})}var Fr=typeof Te=="object"&&"crypto"in Te?Te.crypto:void 0;function Xn(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function jn(n){if(!Number.isSafeInteger(n)||n<0)throw Error("positive integer expected, got "+n)}function Pt(n,...e){if(!Xn(n))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw Error("Uint8Array expected of length "+e+", got length="+n.length)}function a2(n){if(typeof n!="function"||typeof n.create!="function")throw Error("Hash should be wrapped by utils.createHasher");jn(n.outputLen),jn(n.blockLen)}function an(n,e=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(e&&n.finished)throw Error("Hash#digest() has already been called")}function o2(n,e){Pt(n);let r=e.outputLen;if(n.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function at(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function zs(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function pt(n,e){return n<<32-e|n>>>e}function ar(n,e){return n<<e|n>>>32-e>>>0}var h1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68?n=>n:function(n){for(let r=0;r<n.length;r++)n[r]=(e=n[r])<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;var e;return n},c2=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",N3=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Br(n){if(Pt(n),c2)return n.toHex();let e="";for(let r=0;r<n.length;r++)e+=N3[n[r]];return e}var f1=48,O3=57,l1=65,H3=70,y1=97,z3=102;function g1(n){return n>=f1&&n<=O3?n-f1:n>=l1&&n<=H3?n-(l1-10):n>=y1&&n<=z3?n-(y1-10):void 0}function ns(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);if(c2)return Uint8Array.fromHex(n);let e=n.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let t=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){let a=g1(n.charCodeAt(s)),o=g1(n.charCodeAt(s+1));if(a===void 0||o===void 0){let c=n[s]+n[s+1];throw Error('hex string expected, got non-hex character "'+c+'" at index '+s)}t[i]=16*a+o}return t}function Wn(n){return typeof n=="string"&&(n=function(e){if(typeof e!="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(n)),Pt(n),n}function ht(...n){let e=0;for(let t=0;t<n.length;t++){let i=n[t];Pt(i),e+=i.length}let r=new Uint8Array(e);for(let t=0,i=0;t<n.length;t++){let s=n[t];r.set(s,i),i+=s.length}return r}var Vn=class{};function qt(n){let e=t=>n().update(Wn(t)).digest(),r=n();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>n(),e}var G3=qt;function Bs(n=32){if(Fr&&typeof Fr.getRandomValues=="function")return Fr.getRandomValues(new Uint8Array(n));if(Fr&&typeof Fr.randomBytes=="function")return Uint8Array.from(Fr.randomBytes(n));throw Error("crypto.getRandomValues must be defined")}var go=BigInt(0),xa=BigInt(1);function Cr(n,e=""){if(typeof n!="boolean")throw Error((e&&`"${e}"`)+"expected boolean, got type="+typeof n);return n}function lt(n,e,r=""){let t=Xn(n),i=n?.length,s=e!==void 0;if(!t||s&&i!==e)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(s?" of length "+e:"")+", got "+(t?"length="+i:"type="+typeof n));return n}function ai(n){let e=n.toString(16);return 1&e.length?"0"+e:e}function u2(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);return n===""?go:BigInt("0x"+n)}function Is(n){return u2(Br(n))}function Ur(n){return Pt(n),u2(Br(Uint8Array.from(n).reverse()))}function po(n,e){return ns(n.toString(16).padStart(2*e,"0"))}function Ao(n,e){return po(n,e).reverse()}function le(n,e,r){let t;if(typeof e=="string")try{t=ns(e)}catch(s){throw Error(n+" must be hex string or Uint8Array, cause: "+s)}else{if(!Xn(e))throw Error(n+" must be hex string or Uint8Array");t=Uint8Array.from(e)}let i=t.length;if(typeof r=="number"&&i!==r)throw Error(n+" of length "+r+" expected, got "+i);return t}function p1(n){return Uint8Array.from(n)}var Gs=n=>typeof n=="bigint"&&go<=n;function qn(n,e,r,t){if(!function(i,s,a){return Gs(i)&&Gs(s)&&Gs(a)&&s<=i&&i<a}(e,r,t))throw Error("expected valid "+n+": "+r+" <= n < "+t+", got "+e)}function h2(n){let e;for(e=0;n>go;n>>=xa,e+=1);return e}var $n=n=>(xa<<BigInt(n))-xa;function cn(n,e,r={}){if(!n||typeof n!="object")throw Error("expected valid options object");function t(i,s,a){let o=n[i];if(a&&o===void 0)return;let c=typeof o;if(c!==s||o===null)throw Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}Object.entries(e).forEach(([i,s])=>t(i,s,!1)),Object.entries(r).forEach(([i,s])=>t(i,s,!0))}function is(n){let e=new WeakMap;return(r,...t)=>{let i=e.get(r);if(i!==void 0)return i;let s=n(r,...t);return e.set(r,s),s}}var ze=BigInt(0),Le=BigInt(1),wr=BigInt(2),f2=BigInt(3),l2=BigInt(4),y2=BigInt(5),j3=BigInt(7),g2=BigInt(8),V3=BigInt(9),d1=BigInt(16);function Be(n,e){let r=n%e;return r>=ze?r:e+r}function fe(n,e,r){let t=n;for(;e-- >ze;)t*=t,t%=r;return t}function A1(n,e){if(n===ze)throw Error("invert: expected non-zero number");if(e<=ze)throw Error("invert: expected positive modulus, got "+e);let r=Be(n,e),t=e,i=ze,s=Le;for(;r!==ze;){let a=t%r,o=i-s*(t/r);t=r,r=a,i=s,s=o}if(t!==Le)throw Error("invert: does not exist");return Be(i,e)}function wo(n,e,r){if(!n.eql(n.sqr(e),r))throw Error("Cannot find square root")}function p2(n,e){let r=(n.ORDER+Le)/l2,t=n.pow(e,r);return wo(n,t,e),t}function q3(n,e){let r=(n.ORDER-y2)/g2,t=n.mul(e,wr),i=n.pow(t,r),s=n.mul(e,i),a=n.mul(n.mul(s,wr),i),o=n.mul(s,n.sub(a,n.ONE));return wo(n,o,e),o}function w1(n){if(n<f2)throw Error("sqrt is not defined for small field");let e=n-Le,r=0;for(;e%wr===ze;)e/=wr,r++;let t=wr,i=Je(n);for(;m1(i,t)===1;)if(t++>1e3)throw Error("Cannot find square root: probably non-prime P");if(r===1)return p2;let s=i.pow(t,e),a=(e+Le)/wr;return function(o,c){if(o.is0(c))return c;if(m1(o,c)!==1)throw Error("Cannot find square root");let f=r,h=o.mul(o.ONE,s),u=o.pow(c,e),y=o.pow(c,a);for(;!o.eql(u,o.ONE);){if(o.is0(u))return o.ZERO;let g=1,p=o.sqr(u);for(;!o.eql(p,o.ONE);)if(g++,p=o.sqr(p),g===f)throw Error("Cannot find square root");let w=Le<<BigInt(f-g-1),A=o.pow(h,w);f=g,h=o.sqr(A),u=o.mul(u,h),y=o.mul(y,A)}return y}}function _3(n){return n%l2===f2?p2:n%g2===y2?q3:n%d1===V3?function(e){let r=Je(e),t=w1(e),i=t(r,r.neg(r.ONE)),s=t(r,i),a=t(r,r.neg(i)),o=(e+j3)/d1;return(c,f)=>{let h=c.pow(f,o),u=c.mul(h,i),y=c.mul(h,s),g=c.mul(h,a),p=c.eql(c.sqr(u),f),w=c.eql(c.sqr(y),f);h=c.cmov(h,u,p),u=c.cmov(g,y,w);let A=c.eql(c.sqr(u),f),k=c.cmov(h,u,A);return wo(c,k,f),k}}(n):w1(n)}var Y3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function d2(n,e,r=!1){let t=Array(e.length).fill(r?n.ZERO:void 0),i=e.reduce((a,o,c)=>n.is0(o)?a:(t[c]=a,n.mul(a,o)),n.ONE),s=n.inv(i);return e.reduceRight((a,o,c)=>n.is0(o)?a:(t[c]=n.mul(a,t[c]),n.mul(a,o)),s),t}function m1(n,e){let r=(n.ORDER-Le)/wr,t=n.pow(e,r),i=n.eql(t,n.ONE),s=n.eql(t,n.ZERO),a=n.eql(t,n.neg(n.ONE));if(!i&&!s&&!a)throw Error("invalid Legendre symbol result");return i?1:s?0:-1}function A2(n,e){e!==void 0&&jn(e);let r=e!==void 0?e:n.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Je(n,e,r=!1,t={}){if(n<=ze)throw Error("invalid field: expected ORDER > 0, got "+n);let i,s,a,o=!1;if(typeof e=="object"&&e!=null){if(t.sqrt||r)throw Error("cannot specify opts in two arguments");let y=e;y.BITS&&(i=y.BITS),y.sqrt&&(s=y.sqrt),typeof y.isLE=="boolean"&&(r=y.isLE),typeof y.modFromBytes=="boolean"&&(o=y.modFromBytes),a=y.allowedLengths}else typeof e=="number"&&(i=e),t.sqrt&&(s=t.sqrt);let{nBitLength:c,nByteLength:f}=A2(n,i);if(f>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let h,u=Object.freeze({ORDER:n,isLE:r,BITS:c,BYTES:f,MASK:$n(c),ZERO:ze,ONE:Le,allowedLengths:a,create:y=>Be(y,n),isValid:y=>{if(typeof y!="bigint")throw Error("invalid field element: expected bigint, got "+typeof y);return ze<=y&&y<n},is0:y=>y===ze,isValidNot0:y=>!u.is0(y)&&u.isValid(y),isOdd:y=>(y&Le)===Le,neg:y=>Be(-y,n),eql:(y,g)=>y===g,sqr:y=>Be(y*y,n),add:(y,g)=>Be(y+g,n),sub:(y,g)=>Be(y-g,n),mul:(y,g)=>Be(y*g,n),pow:(y,g)=>function(p,w,A){if(A<ze)throw Error("invalid exponent, negatives unsupported");if(A===ze)return p.ONE;if(A===Le)return w;let k=p.ONE,S=w;for(;A>ze;)A&Le&&(k=p.mul(k,S)),S=p.sqr(S),A>>=Le;return k}(u,y,g),div:(y,g)=>Be(y*A1(g,n),n),sqrN:y=>y*y,addN:(y,g)=>y+g,subN:(y,g)=>y-g,mulN:(y,g)=>y*g,inv:y=>A1(y,n),sqrt:s||(y=>(h||(h=_3(n)),h(u,y))),toBytes:y=>r?Ao(y,f):po(y,f),fromBytes:(y,g=!0)=>{if(a){if(!a.includes(y.length)||y.length>f)throw Error("Field.fromBytes: expected "+a+" bytes, got "+y.length);let w=new Uint8Array(f);w.set(y,r?0:w.length-y.length),y=w}if(y.length!==f)throw Error("Field.fromBytes: expected "+f+" bytes, got "+y.length);let p=r?Ur(y):Is(y);if(o&&(p=Be(p,n)),!g&&!u.isValid(p))throw Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:y=>d2(u,y),cmov:(y,g,p)=>p?g:y});return Object.freeze(u)}function w2(n){if(typeof n!="bigint")throw Error("field order must be bigint");let e=n.toString(2).length;return Math.ceil(e/8)}function b1(n){let e=w2(n);return e+Math.ceil(e/2)}function m2(n,e,r){return n&e^~n&r}function b2(n,e,r){return n&e^n&r^e&r}var Pr=class extends Vn{constructor(e,r,t,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=t,this.isLE=i,this.buffer=new Uint8Array(e),this.view=zs(this.buffer)}update(e){an(this),Pt(e=Wn(e));let{view:r,buffer:t,blockLen:i}=this,s=e.length;for(let a=0;a<s;){let o=Math.min(i-this.pos,s-a);if(o!==i)t.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(r,0),this.pos=0);else{let c=zs(e);for(;i<=s-a;a+=i)this.process(c,a)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){an(this),o2(e,this),this.finished=!0;let{buffer:r,view:t,blockLen:i,isLE:s}=this,{pos:a}=this;r[a++]=128,at(this.buffer.subarray(a)),this.padOffset>i-a&&(this.process(t,0),a=0);for(let u=a;u<i;u++)r[u]=0;(function(u,y,g,p){if(typeof u.setBigUint64=="function")return u.setBigUint64(y,g,p);let w=BigInt(32),A=BigInt(4294967295),k=Number(g>>w&A),S=Number(g&A),m=p?4:0,E=p?0:4;u.setUint32(y+m,k,p),u.setUint32(y+E,S,p)})(t,i-8,BigInt(8*this.length),s),this.process(t,0);let o=zs(e),c=this.outputLen;if(c%4)throw Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,h=this.get();if(f>h.length)throw Error("_sha2: outputLen bigger than state");for(let u=0;u<f;u++)o.setUint32(4*u,h[u],s)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let t=e.slice(0,r);return this.destroy(),t}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:t,length:i,finished:s,destroyed:a,pos:o}=this;return e.destroyed=a,e.finished=s,e.length=i,e.pos=o,i%r&&e.buffer.set(t),e}clone(){return this._cloneInto()}},Zt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Jt=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),xe=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Qe=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),oi=BigInt(2**32-1),k1=BigInt(32);function Z3(n,e=!1){return e?{h:Number(n&oi),l:Number(n>>k1&oi)}:{h:0|Number(n>>k1&oi),l:0|Number(n&oi)}}function k2(n,e=!1){let r=n.length,t=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){let{h:a,l:o}=Z3(n[s],e);[t[s],i[s]]=[a,o]}return[t,i]}var E1=(n,e,r)=>n>>>r,v1=(n,e,r)=>n<<32-r|e>>>r,Lr=(n,e,r)=>n>>>r|e<<32-r,Nr=(n,e,r)=>n<<32-r|e>>>r,ci=(n,e,r)=>n<<64-r|e>>>r-32,ui=(n,e,r)=>n>>>r-32|e<<64-r;function Qt(n,e,r,t){let i=(e>>>0)+(t>>>0);return{h:n+r+(i/2**32|0)|0,l:0|i}}var J3=(n,e,r)=>(n>>>0)+(e>>>0)+(r>>>0),X3=(n,e,r,t)=>e+r+t+(n/2**32|0)|0,W3=(n,e,r,t)=>(n>>>0)+(e>>>0)+(r>>>0)+(t>>>0),$3=(n,e,r,t,i)=>e+r+t+i+(n/2**32|0)|0,eu=(n,e,r,t,i)=>(n>>>0)+(e>>>0)+(r>>>0)+(t>>>0)+(i>>>0),tu=(n,e,r,t,i,s)=>e+r+t+i+s+(n/2**32|0)|0,ru=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xt=new Uint32Array(64),ss=class extends Pr{constructor(e=32){super(64,e,8,!1),this.A=0|Zt[0],this.B=0|Zt[1],this.C=0|Zt[2],this.D=0|Zt[3],this.E=0|Zt[4],this.F=0|Zt[5],this.G=0|Zt[6],this.H=0|Zt[7]}get(){let{A:e,B:r,C:t,D:i,E:s,F:a,G:o,H:c}=this;return[e,r,t,i,s,a,o,c]}set(e,r,t,i,s,a,o,c){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|i,this.E=0|s,this.F=0|a,this.G=0|o,this.H=0|c}process(e,r){for(let u=0;u<16;u++,r+=4)Xt[u]=e.getUint32(r,!1);for(let u=16;u<64;u++){let y=Xt[u-15],g=Xt[u-2],p=pt(y,7)^pt(y,18)^y>>>3,w=pt(g,17)^pt(g,19)^g>>>10;Xt[u]=w+Xt[u-7]+p+Xt[u-16]|0}let{A:t,B:i,C:s,D:a,E:o,F:c,G:f,H:h}=this;for(let u=0;u<64;u++){let y=h+(pt(o,6)^pt(o,11)^pt(o,25))+m2(o,c,f)+ru[u]+Xt[u]|0,g=(pt(t,2)^pt(t,13)^pt(t,22))+b2(t,i,s)|0;h=f,f=c,c=o,o=a+y|0,a=s,s=i,i=t,t=y+g|0}t=t+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,f=f+this.G|0,h=h+this.H|0,this.set(t,i,s,a,o,c,f,h)}roundClean(){at(Xt)}destroy(){this.set(0,0,0,0,0,0,0,0),at(this.buffer)}},Qa=class extends ss{constructor(){super(28),this.A=0|Jt[0],this.B=0|Jt[1],this.C=0|Jt[2],this.D=0|Jt[3],this.E=0|Jt[4],this.F=0|Jt[5],this.G=0|Jt[6],this.H=0|Jt[7]}},E2=k2(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),nu=E2[0],iu=E2[1],Wt=new Uint32Array(80),$t=new Uint32Array(80),as=class extends Pr{constructor(e=64){super(128,e,16,!1),this.Ah=0|Qe[0],this.Al=0|Qe[1],this.Bh=0|Qe[2],this.Bl=0|Qe[3],this.Ch=0|Qe[4],this.Cl=0|Qe[5],this.Dh=0|Qe[6],this.Dl=0|Qe[7],this.Eh=0|Qe[8],this.El=0|Qe[9],this.Fh=0|Qe[10],this.Fl=0|Qe[11],this.Gh=0|Qe[12],this.Gl=0|Qe[13],this.Hh=0|Qe[14],this.Hl=0|Qe[15]}get(){let{Ah:e,Al:r,Bh:t,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:f,El:h,Fh:u,Fl:y,Gh:g,Gl:p,Hh:w,Hl:A}=this;return[e,r,t,i,s,a,o,c,f,h,u,y,g,p,w,A]}set(e,r,t,i,s,a,o,c,f,h,u,y,g,p,w,A){this.Ah=0|e,this.Al=0|r,this.Bh=0|t,this.Bl=0|i,this.Ch=0|s,this.Cl=0|a,this.Dh=0|o,this.Dl=0|c,this.Eh=0|f,this.El=0|h,this.Fh=0|u,this.Fl=0|y,this.Gh=0|g,this.Gl=0|p,this.Hh=0|w,this.Hl=0|A}process(e,r){for(let m=0;m<16;m++,r+=4)Wt[m]=e.getUint32(r),$t[m]=e.getUint32(r+=4);for(let m=16;m<80;m++){let E=0|Wt[m-15],D=0|$t[m-15],R=Lr(E,D,1)^Lr(E,D,8)^E1(E,0,7),U=Nr(E,D,1)^Nr(E,D,8)^v1(E,D,7),B=0|Wt[m-2],b=0|$t[m-2],C=Lr(B,b,19)^ci(B,b,61)^E1(B,0,6),v=Nr(B,b,19)^ui(B,b,61)^v1(B,b,6),K=W3(U,v,$t[m-7],$t[m-16]),P=$3(K,R,C,Wt[m-7],Wt[m-16]);Wt[m]=0|P,$t[m]=0|K}let{Ah:t,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:f,Dl:h,Eh:u,El:y,Fh:g,Fl:p,Gh:w,Gl:A,Hh:k,Hl:S}=this;for(let m=0;m<80;m++){let E=Lr(u,y,14)^Lr(u,y,18)^ci(u,y,41),D=Nr(u,y,14)^Nr(u,y,18)^ui(u,y,41),R=u&g^~u&w,U=eu(S,D,y&p^~y&A,iu[m],$t[m]),B=tu(U,k,E,R,nu[m],Wt[m]),b=0|U,C=Lr(t,i,28)^ci(t,i,34)^ci(t,i,39),v=Nr(t,i,28)^ui(t,i,34)^ui(t,i,39),K=t&s^t&o^s&o,P=i&a^i&c^a&c;k=0|w,S=0|A,w=0|g,A=0|p,g=0|u,p=0|y,{h:u,l:y}=Qt(0|f,0|h,0|B,0|b),f=0|o,h=0|c,o=0|s,c=0|a,s=0|t,a=0|i;let x=J3(b,v,P);t=X3(x,B,C,K),i=0|x}({h:t,l:i}=Qt(0|this.Ah,0|this.Al,0|t,0|i)),{h:s,l:a}=Qt(0|this.Bh,0|this.Bl,0|s,0|a),{h:o,l:c}=Qt(0|this.Ch,0|this.Cl,0|o,0|c),{h:f,l:h}=Qt(0|this.Dh,0|this.Dl,0|f,0|h),{h:u,l:y}=Qt(0|this.Eh,0|this.El,0|u,0|y),{h:g,l:p}=Qt(0|this.Fh,0|this.Fl,0|g,0|p),{h:w,l:A}=Qt(0|this.Gh,0|this.Gl,0|w,0|A),{h:k,l:S}=Qt(0|this.Hh,0|this.Hl,0|k,0|S),this.set(t,i,s,a,o,c,f,h,u,y,g,p,w,A,k,S)}roundClean(){at(Wt,$t)}destroy(){at(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Ra=class extends as{constructor(){super(48),this.Ah=0|xe[0],this.Al=0|xe[1],this.Bh=0|xe[2],this.Bl=0|xe[3],this.Ch=0|xe[4],this.Cl=0|xe[5],this.Dh=0|xe[6],this.Dl=0|xe[7],this.Eh=0|xe[8],this.El=0|xe[9],this.Fh=0|xe[10],this.Fl=0|xe[11],this.Gh=0|xe[12],this.Gl=0|xe[13],this.Hh=0|xe[14],this.Hl=0|xe[15]}},mo=qt(()=>new ss),su=qt(()=>new Qa),v2=qt(()=>new as),B2=qt(()=>new Ra),os=class extends Vn{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,a2(e);let t=Wn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(t.length>i?e.create().update(t).digest():t);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=e.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),at(s)}update(e){return an(this),this.iHash.update(e),this}digestInto(e){an(this),Pt(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:t,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return e.finished=i,e.destroyed=s,e.blockLen=a,e.outputLen=o,e.oHash=r._cloneInto(e.oHash),e.iHash=t._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},I2=(n,e,r)=>new os(n,e).update(r).digest();I2.create=(n,e)=>new os(n,e);var on=BigInt(0),mr=BigInt(1);function cs(n,e){let r=e.negate();return n?r:e}function br(n,e){let r=d2(n.Fp,e.map(t=>t.Z));return e.map((t,i)=>n.fromAffine(t.toAffine(r[i])))}function S2(n,e){if(!Number.isSafeInteger(n)||n<=0||n>e)throw Error("invalid window size, expected [1.."+e+"], got W="+n)}function js(n,e){S2(n,e);let r=2**n;return{windows:Math.ceil(e/n)+1,windowSize:2**(n-1),mask:$n(n),maxNumber:r,shiftBy:BigInt(n)}}function B1(n,e,r){let{windowSize:t,mask:i,maxNumber:s,shiftBy:a}=r,o=Number(n&i),c=n>>a;o>t&&(o-=s,c+=mr);let f=e*t;return{nextN:c,offset:f+Math.abs(o)-1,isZero:o===0,isNeg:o<0,isNegF:e%2!=0,offsetF:f}}var Vs=new WeakMap,K2=new WeakMap;function qs(n){return K2.get(n)||1}function I1(n){if(n!==on)throw Error("invalid wNAF")}var us=class{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,t=this.ZERO){let i=e;for(;r>on;)r&mr&&(t=t.add(i)),i=i.double(),r>>=mr;return t}precomputeWindow(e,r){let{windows:t,windowSize:i}=js(r,this.bits),s=[],a=e,o=a;for(let c=0;c<t;c++){o=a,s.push(o);for(let f=1;f<i;f++)o=o.add(a),s.push(o);a=o.double()}return s}wNAF(e,r,t){if(!this.Fn.isValid(t))throw Error("invalid scalar");let i=this.ZERO,s=this.BASE,a=js(e,this.bits);for(let o=0;o<a.windows;o++){let{nextN:c,offset:f,isZero:h,isNeg:u,isNegF:y,offsetF:g}=B1(t,o,a);t=c,h?s=s.add(cs(y,r[g])):i=i.add(cs(u,r[f]))}return I1(t),{p:i,f:s}}wNAFUnsafe(e,r,t,i=this.ZERO){let s=js(e,this.bits);for(let a=0;a<s.windows&&t!==on;a++){let{nextN:o,offset:c,isZero:f,isNeg:h}=B1(t,a,s);if(t=o,!f){let u=r[c];i=i.add(h?u.negate():u)}}return I1(t),i}getPrecomputes(e,r,t){let i=Vs.get(r);return i||(i=this.precomputeWindow(r,e),e!==1&&(typeof t=="function"&&(i=t(i)),Vs.set(r,i))),i}cached(e,r,t){let i=qs(e);return this.wNAF(i,this.getPrecomputes(i,e,t),r)}unsafe(e,r,t,i){let s=qs(e);return s===1?this._unsafeLadder(e,r,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,t),r,i)}createCache(e,r){S2(r,this.bits),K2.set(e,r),Vs.delete(e)}hasCache(e){return qs(e)!==1}};function C2(n,e,r,t){(function(y,g){if(!Array.isArray(y))throw Error("array expected");y.forEach((p,w)=>{if(!(p instanceof g))throw Error("invalid point at index "+w)})})(r,n),function(y,g){if(!Array.isArray(y))throw Error("array of scalars expected");y.forEach((p,w)=>{if(!g.isValid(p))throw Error("invalid scalar at index "+w)})}(t,e);let i=r.length,s=t.length;if(i!==s)throw Error("arrays of points and scalars must have equal length");let a=n.ZERO,o=h2(BigInt(i)),c=1;o>12?c=o-3:o>4?c=o-2:o>0&&(c=2);let f=$n(c),h=Array(Number(f)+1).fill(a),u=a;for(let y=Math.floor((e.BITS-1)/c)*c;y>=0;y-=c){h.fill(a);for(let p=0;p<s;p++){let w=t[p],A=Number(w>>BigInt(y)&f);h[A]=h[A].add(r[p])}let g=a;for(let p=h.length-1,w=a;p>0;p--)w=w.add(h[p]),g=g.add(w);if(u=u.add(g),y!==0)for(let p=0;p<c;p++)u=u.double()}return u}function S1(n,e,r){if(e){if(e.ORDER!==n)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return function(t){cn(t,Y3.reduce((i,s)=>(i[s]="function",i),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))}(e),e}return Je(n,{isLE:r})}function U2(n,e,r={},t){if(t===void 0&&(t=n==="edwards"),!e||typeof e!="object")throw Error(`expected valid ${n} CURVE object`);for(let o of["p","n","h"]){let c=e[o];if(!(typeof c=="bigint"&&c>on))throw Error(`CURVE.${o} must be positive bigint`)}let i=S1(e.p,r.Fp,t),s=S1(e.n,r.Fn,t),a=["Gx","Gy","a",n==="weierstrass"?"b":"d"];for(let o of a)if(!i.isValid(e[o]))throw Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{CURVE:e=Object.freeze(Object.assign({},e)),Fp:i,Fn:s}}var K1=(n,e)=>(n+(n>=0?e:-e)/P2)/e;function Ta(n){if(!["compact","recovered","der"].includes(n))throw Error('Signature format must be "compact", "recovered", or "der"');return n}function _s(n,e){let r={};for(let t of Object.keys(e))r[t]=n[t]===void 0?e[t]:n[t];return Cr(r.lowS,"lowS"),Cr(r.prehash,"prehash"),r.format!==void 0&&Ta(r.format),r}var Lt={Err:class extends Error{constructor(n=""){super(n)}},_tlv:{encode:(n,e)=>{let{Err:r}=Lt;if(n<0||n>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");let t=e.length/2,i=ai(t);if(i.length/2&128)throw new r("tlv.encode: long form length too big");let s=t>127?ai(i.length/2|128):"";return ai(n)+s+i+e},decode(n,e){let{Err:r}=Lt,t=0;if(n<0||n>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[t++]!==n)throw new r("tlv.decode: wrong tlv");let i=e[t++],s=0;if(128&i){let o=127&i;if(!o)throw new r("tlv.decode(long): indefinite length not supported");if(o>4)throw new r("tlv.decode(long): byte length is too big");let c=e.subarray(t,t+o);if(c.length!==o)throw new r("tlv.decode: length bytes not complete");if(c[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let f of c)s=s<<8|f;if(t+=o,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;let a=e.subarray(t,t+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(t+s)}}},_int:{encode(n){let{Err:e}=Lt;if(n<Nt)throw new e("integer: negative integers are not allowed");let r=ai(n);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(n){let{Err:e}=Lt;if(128&n[0])throw new e("invalid signature integer: negative");if(n[0]===0&&!(128&n[1]))throw new e("invalid signature integer: unnecessary leading zero");return Is(n)}},toSig(n){let{Err:e,_int:r,_tlv:t}=Lt,i=le("signature",n),{v:s,l:a}=t.decode(48,i);if(a.length)throw new e("invalid signature: left bytes after parsing");let{v:o,l:c}=t.decode(2,s),{v:f,l:h}=t.decode(2,c);if(h.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(f)}},hexFromSig(n){let{_tlv:e,_int:r}=Lt,t=e.encode(2,r.encode(n.r))+e.encode(2,r.encode(n.s));return e.encode(48,t)}},Nt=BigInt(0),_r=BigInt(1),P2=BigInt(2),hi=BigInt(3),au=BigInt(4);function Yr(n,e){let{BYTES:r}=n,t;if(typeof e=="bigint")t=e;else{let i=le("private key",e);try{t=n.fromBytes(i)}catch{throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!n.isValidNot0(t))throw Error("invalid private key: out of range [1..N-1]");return t}function ou(n,e={}){let r=U2("weierstrass",n,e),{Fp:t,Fn:i}=r,s=r.CURVE,{h:a,n:o}=s;cn(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:c}=e;if(c&&(!t.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let f=x2(t,i);function h(){if(!t.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let u=e.toBytes||function(C,v,K){let{x:P,y:x}=v.toAffine(),T=t.toBytes(P);return Cr(K,"isCompressed"),K?(h(),ht(D2(!t.isOdd(x)),T)):ht(Uint8Array.of(4),T,t.toBytes(x))},y=e.fromBytes||function(C){lt(C,void 0,"Point");let{publicKey:v,publicKeyUncompressed:K}=f,P=C.length,x=C[0],T=C.subarray(1);if(P!==v||x!==2&&x!==3){if(P===K&&x===4){let Q=t.BYTES,M=t.fromBytes(T.subarray(0,Q)),O=t.fromBytes(T.subarray(Q,2*Q));if(!p(M,O))throw Error("bad point: is not on curve");return{x:M,y:O}}throw Error(`bad point: got length ${P}, expected compressed=${v} or uncompressed=${K}`)}{let Q=t.fromBytes(T);if(!t.isValid(Q))throw Error("bad point: is not on curve, wrong x");let M=g(Q),O;try{O=t.sqrt(M)}catch(L){let F=L instanceof Error?": "+L.message:"";throw Error("bad point: is not on curve, sqrt error"+F)}return h(),!(1&~x)!==t.isOdd(O)&&(O=t.neg(O)),{x:Q,y:O}}};function g(C){let v=t.sqr(C),K=t.mul(v,C);return t.add(t.add(K,t.mul(C,s.a)),s.b)}function p(C,v){let K=t.sqr(v),P=g(C);return t.eql(K,P)}if(!p(s.Gx,s.Gy))throw Error("bad curve params: generator point");let w=t.mul(t.pow(s.a,hi),au),A=t.mul(t.sqr(s.b),BigInt(27));if(t.is0(t.add(w,A)))throw Error("bad curve params: a or b");function k(C,v,K=!1){if(!t.isValid(v)||K&&t.is0(v))throw Error("bad point coordinate "+C);return v}function S(C){if(!(C instanceof U))throw Error("ProjectivePoint expected")}function m(C){if(!c||!c.basises)throw Error("no endo");return function(v,K,P){let[[x,T],[Q,M]]=K,O=K1(M*v,P),L=K1(-T*v,P),F=v-O*x-L*Q,G=-O*T-L*M,N=F<Nt,H=G<Nt;N&&(F=-F),H&&(G=-G);let z=$n(Math.ceil(h2(P)/2))+_r;if(F<Nt||F>=z||G<Nt||G>=z)throw Error("splitScalar (endomorphism): failed, k="+v);return{k1neg:N,k1:F,k2neg:H,k2:G}}(C,c.basises,i.ORDER)}let E=is((C,v)=>{let{X:K,Y:P,Z:x}=C;if(t.eql(x,t.ONE))return{x:K,y:P};let T=C.is0();v==null&&(v=T?t.ONE:t.inv(x));let Q=t.mul(K,v),M=t.mul(P,v),O=t.mul(x,v);if(T)return{x:t.ZERO,y:t.ZERO};if(!t.eql(O,t.ONE))throw Error("invZ was invalid");return{x:Q,y:M}}),D=is(C=>{if(C.is0()){if(e.allowInfinityPoint&&!t.is0(C.Y))return;throw Error("bad point: ZERO")}let{x:v,y:K}=C.toAffine();if(!t.isValid(v)||!t.isValid(K))throw Error("bad point: x or y not field elements");if(!p(v,K))throw Error("bad point: equation left != right");if(!C.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function R(C,v,K,P,x){return K=new U(t.mul(K.X,C),K.Y,K.Z),v=cs(P,v),K=cs(x,K),v.add(K)}class U{constructor(v,K,P){this.X=k("x",v),this.Y=k("y",K,!0),this.Z=k("z",P),Object.freeze(this)}static CURVE(){return s}static fromAffine(v){let{x:K,y:P}=v||{};if(!v||!t.isValid(K)||!t.isValid(P))throw Error("invalid affine point");if(v instanceof U)throw Error("projective point not allowed");return t.is0(K)&&t.is0(P)?U.ZERO:new U(K,P,t.ONE)}static fromBytes(v){let K=U.fromAffine(y(lt(v,void 0,"point")));return K.assertValidity(),K}static fromHex(v){return U.fromBytes(le("pointHex",v))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(v=8,K=!0){return b.createCache(this,v),K||this.multiply(hi),this}assertValidity(){D(this)}hasEvenY(){let{y:v}=this.toAffine();if(!t.isOdd)throw Error("Field doesn't support isOdd");return!t.isOdd(v)}equals(v){S(v);let{X:K,Y:P,Z:x}=this,{X:T,Y:Q,Z:M}=v,O=t.eql(t.mul(K,M),t.mul(T,x)),L=t.eql(t.mul(P,M),t.mul(Q,x));return O&&L}negate(){return new U(this.X,t.neg(this.Y),this.Z)}double(){let{a:v,b:K}=s,P=t.mul(K,hi),{X:x,Y:T,Z:Q}=this,M=t.ZERO,O=t.ZERO,L=t.ZERO,F=t.mul(x,x),G=t.mul(T,T),N=t.mul(Q,Q),H=t.mul(x,T);return H=t.add(H,H),L=t.mul(x,Q),L=t.add(L,L),M=t.mul(v,L),O=t.mul(P,N),O=t.add(M,O),M=t.sub(G,O),O=t.add(G,O),O=t.mul(M,O),M=t.mul(H,M),L=t.mul(P,L),N=t.mul(v,N),H=t.sub(F,N),H=t.mul(v,H),H=t.add(H,L),L=t.add(F,F),F=t.add(L,F),F=t.add(F,N),F=t.mul(F,H),O=t.add(O,F),N=t.mul(T,Q),N=t.add(N,N),F=t.mul(N,H),M=t.sub(M,F),L=t.mul(N,G),L=t.add(L,L),L=t.add(L,L),new U(M,O,L)}add(v){S(v);let{X:K,Y:P,Z:x}=this,{X:T,Y:Q,Z:M}=v,O=t.ZERO,L=t.ZERO,F=t.ZERO,G=s.a,N=t.mul(s.b,hi),H=t.mul(K,T),z=t.mul(P,Q),j=t.mul(x,M),V=t.add(K,P),J=t.add(T,Q);V=t.mul(V,J),J=t.add(H,z),V=t.sub(V,J),J=t.add(K,x);let _=t.add(T,M);return J=t.mul(J,_),_=t.add(H,j),J=t.sub(J,_),_=t.add(P,x),O=t.add(Q,M),_=t.mul(_,O),O=t.add(z,j),_=t.sub(_,O),F=t.mul(G,J),O=t.mul(N,j),F=t.add(O,F),O=t.sub(z,F),F=t.add(z,F),L=t.mul(O,F),z=t.add(H,H),z=t.add(z,H),j=t.mul(G,j),J=t.mul(N,J),z=t.add(z,j),j=t.sub(H,j),j=t.mul(G,j),J=t.add(J,j),H=t.mul(z,J),L=t.add(L,H),H=t.mul(_,J),O=t.mul(V,O),O=t.sub(O,H),H=t.mul(V,z),F=t.mul(_,F),F=t.add(F,H),new U(O,L,F)}subtract(v){return this.add(v.negate())}is0(){return this.equals(U.ZERO)}multiply(v){let{endo:K}=e;if(!i.isValidNot0(v))throw Error("invalid scalar: out of range");let P,x,T=Q=>b.cached(this,Q,M=>br(U,M));if(K){let{k1neg:Q,k1:M,k2neg:O,k2:L}=m(v),{p:F,f:G}=T(M),{p:N,f:H}=T(L);x=G.add(H),P=R(K.beta,F,N,Q,O)}else{let{p:Q,f:M}=T(v);P=Q,x=M}return br(U,[P,x])[0]}multiplyUnsafe(v){let{endo:K}=e,P=this;if(!i.isValid(v))throw Error("invalid scalar: out of range");if(v===Nt||P.is0())return U.ZERO;if(v===_r)return P;if(b.hasCache(this))return this.multiply(v);if(K){let{k1neg:x,k1:T,k2neg:Q,k2:M}=m(v),{p1:O,p2:L}=function(F,G,N,H){let z=G,j=F.ZERO,V=F.ZERO;for(;N>on||H>on;)N&mr&&(j=j.add(z)),H&mr&&(V=V.add(z)),z=z.double(),N>>=mr,H>>=mr;return{p1:j,p2:V}}(U,P,T,M);return R(K.beta,O,L,x,Q)}return b.unsafe(P,v)}multiplyAndAddUnsafe(v,K,P){let x=this.multiplyUnsafe(K).add(v.multiplyUnsafe(P));return x.is0()?void 0:x}toAffine(v){return E(this,v)}isTorsionFree(){let{isTorsionFree:v}=e;return a===_r||(v?v(U,this):b.unsafe(this,o).is0())}clearCofactor(){let{clearCofactor:v}=e;return a===_r?this:v?v(U,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(v=!0){return Cr(v,"isCompressed"),this.assertValidity(),u(U,this,v)}toHex(v=!0){return Br(this.toBytes(v))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(v=!0){return this.toBytes(v)}_setWindowSize(v){this.precompute(v)}static normalizeZ(v){return br(U,v)}static msm(v,K){return C2(U,i,v,K)}static fromPrivateKey(v){return U.BASE.multiply(Yr(i,v))}}U.BASE=new U(s.Gx,s.Gy,t.ONE),U.ZERO=new U(t.ZERO,t.ONE,t.ZERO),U.Fp=t,U.Fn=i;let B=i.BITS,b=new us(U,e.endo?Math.ceil(B/2):B);return U.BASE.precompute(8),U}function D2(n){return Uint8Array.of(n?2:3)}function x2(n,e){return{secretKey:e.BYTES,publicKey:1+n.BYTES,publicKeyUncompressed:1+2*n.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function cu(n,e={}){let{Fn:r}=n,t=e.randomBytes||Bs,i=Object.assign(x2(n.Fp,r),{seed:b1(r.ORDER)});function s(h){try{return!!Yr(r,h)}catch{return!1}}function a(h=t(i.seed)){return function(u,y,g=!1){let p=u.length,w=w2(y),A=b1(y);if(p<16||p<A||p>1024)throw Error("expected "+A+"-1024 bytes of input, got "+p);let k=Be(g?Ur(u):Is(u),y-Le)+Le;return g?Ao(k,w):po(k,w)}(lt(h,i.seed,"seed"),r.ORDER)}function o(h,u=!0){return n.BASE.multiply(Yr(r,h)).toBytes(u)}function c(h){if(typeof h=="bigint")return!1;if(h instanceof n)return!0;let{secretKey:u,publicKey:y,publicKeyUncompressed:g}=i;if(r.allowedLengths||u===y)return;let p=le("key",h).length;return p===y||p===g}return Object.freeze({getPublicKey:o,getSharedSecret:function(h,u,y=!0){if(c(h)===!0)throw Error("first arg must be private key");if(c(u)===!1)throw Error("second arg must be public key");let g=Yr(r,h);return n.fromHex(u).multiply(g).toBytes(y)},keygen:function(h){let u=a(h);return{secretKey:u,publicKey:o(u)}},Point:n,utils:{isValidSecretKey:s,isValidPublicKey:function(h,u){let{publicKey:y,publicKeyUncompressed:g}=i;try{let p=h.length;return(u!==!0||p===y)&&(u!==!1||p===g)&&!!n.fromBytes(h)}catch{return!1}},randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:h=>Yr(r,h),precompute:(h=8,u=n.BASE)=>u.precompute(h,!1)},lengths:i})}function uu(n,e,r={}){a2(e),cn(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let t=r.randomBytes||Bs,i=r.hmac||((B,...b)=>I2(e,B,ht(...b))),{Fp:s,Fn:a}=n,{ORDER:o,BITS:c}=a,{keygen:f,getPublicKey:h,getSharedSecret:u,utils:y,lengths:g}=cu(n,r),p={prehash:!1,lowS:typeof r.lowS=="boolean"&&r.lowS,format:void 0,extraEntropy:!1},w="compact";function A(B){return B>o>>_r}function k(B,b){if(!a.isValidNot0(b))throw Error(`invalid signature ${B}: out of range 1..Point.Fn.ORDER`);return b}class S{constructor(b,C,v){this.r=k("r",b),this.s=k("s",C),v!=null&&(this.recovery=v),Object.freeze(this)}static fromBytes(b,C=w){let v;if(function(T,Q){Ta(Q);let M=g.signature;lt(T,Q==="compact"?M:Q==="recovered"?M+1:void 0,Q+" signature")}(b,C),C==="der"){let{r:T,s:Q}=Lt.toSig(lt(b));return new S(T,Q)}C==="recovered"&&(v=b[0],C="compact",b=b.subarray(1));let K=a.BYTES,P=b.subarray(0,K),x=b.subarray(K,2*K);return new S(a.fromBytes(P),a.fromBytes(x),v)}static fromHex(b,C){return this.fromBytes(ns(b),C)}addRecoveryBit(b){return new S(this.r,this.s,b)}recoverPublicKey(b){let C=s.ORDER,{r:v,s:K,recovery:P}=this;if(P==null||![0,1,2,3].includes(P))throw Error("recovery id invalid");if(o*P2<C&&P>1)throw Error("recovery id is ambiguous for h>1 curve");let x=P===2||P===3?v+o:v;if(!s.isValid(x))throw Error("recovery id 2 or 3 invalid");let T=s.toBytes(x),Q=n.fromBytes(ht(D2(!(1&P)),T)),M=a.inv(x),O=E(le("msgHash",b)),L=a.create(-O*M),F=a.create(K*M),G=n.BASE.multiplyUnsafe(L).add(Q.multiplyUnsafe(F));if(G.is0())throw Error("point at infinify");return G.assertValidity(),G}hasHighS(){return A(this.s)}toBytes(b=w){if(Ta(b),b==="der")return ns(Lt.hexFromSig(this));let C=a.toBytes(this.r),v=a.toBytes(this.s);if(b==="recovered"){if(this.recovery==null)throw Error("recovery bit must be present");return ht(Uint8Array.of(this.recovery),C,v)}return ht(C,v)}toHex(b){return Br(this.toBytes(b))}assertValidity(){}static fromCompact(b){return S.fromBytes(le("sig",b),"compact")}static fromDER(b){return S.fromBytes(le("sig",b),"der")}normalizeS(){return this.hasHighS()?new S(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Br(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Br(this.toBytes("compact"))}}let m=r.bits2int||function(B){if(B.length>8192)throw Error("input is too large");let b=Is(B),C=8*B.length-c;return C>0?b>>BigInt(C):b},E=r.bits2int_modN||function(B){return a.create(m(B))},D=$n(c);function R(B){return qn("num < 2^"+c,B,Nt,D),a.toBytes(B)}function U(B,b){return lt(B,void 0,"message"),b?lt(e(B),void 0,"prehashed message"):B}return Object.freeze({keygen:f,getPublicKey:h,getSharedSecret:u,utils:y,lengths:g,Point:n,sign:function(B,b,C={}){B=le("message",B);let{seed:v,k2sig:K}=function(x,T,Q){if(["recovered","canonical"].some(j=>j in Q))throw Error("sign() legacy options not supported");let{lowS:M,prehash:O,extraEntropy:L}=_s(Q,p);x=U(x,O);let F=E(x),G=Yr(a,T),N=[R(G),R(F)];if(L!=null&&L!==!1){let j=L===!0?t(g.secretKey):L;N.push(le("extraEntropy",j))}let H=ht(...N),z=F;return{seed:H,k2sig:function(j){let V=m(j);if(!a.isValidNot0(V))return;let J=a.inv(V),_=n.BASE.multiply(V).toAffine(),ee=a.create(_.x);if(ee===Nt)return;let $=a.create(J*a.create(z+ee*G));if($===Nt)return;let ne=(_.x===ee?0:2)|Number(_.y&_r),W=$;return M&&A($)&&(W=a.neg($),ne^=1),new S(ee,W,ne)}}}(B,b,C);return function(x,T,Q){if(typeof x!="number"||x<2)throw Error("hashLen must be a number");if(typeof T!="number"||T<2)throw Error("qByteLen must be a number");if(typeof Q!="function")throw Error("hmacFn must be a function");let M=V=>new Uint8Array(V),O=V=>Uint8Array.of(V),L=M(x),F=M(x),G=0,N=()=>{L.fill(1),F.fill(0),G=0},H=(...V)=>Q(F,L,...V),z=(V=M(0))=>{F=H(O(0),V),L=H(),V.length!==0&&(F=H(O(1),V),L=H())},j=()=>{if(G++>=1e3)throw Error("drbg: tried 1000 values");let V=0,J=[];for(;V<T;){L=H();let _=L.slice();J.push(_),V+=L.length}return ht(...J)};return(V,J)=>{let _;for(N(),z(V);!(_=J(j()));)z();return N(),_}}(e.outputLen,a.BYTES,i)(v,K)},verify:function(B,b,C,v={}){let{lowS:K,prehash:P,format:x}=_s(v,p);if(C=le("publicKey",C),b=U(le("message",b),P),"strict"in v)throw Error("options.strict was renamed to lowS");let T=x===void 0?function(Q){let M,O=typeof Q=="string"||Xn(Q),L=!O&&Q!==null&&typeof Q=="object"&&typeof Q.r=="bigint"&&typeof Q.s=="bigint";if(!O&&!L)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(L)M=new S(Q.r,Q.s);else if(O){try{M=S.fromBytes(le("sig",Q),"der")}catch(F){if(!(F instanceof Lt.Err))throw F}if(!M)try{M=S.fromBytes(le("sig",Q),"compact")}catch{return!1}}return M||!1}(B):S.fromBytes(le("sig",B),x);if(T===!1)return!1;try{let Q=n.fromBytes(C);if(K&&T.hasHighS())return!1;let{r:M,s:O}=T,L=E(b),F=a.inv(O),G=a.create(L*F),N=a.create(M*F),H=n.BASE.multiplyUnsafe(G).add(Q.multiplyUnsafe(N));return H.is0()?!1:a.create(H.x)===M}catch{return!1}},recoverPublicKey:function(B,b,C={}){let{prehash:v}=_s(C,p);return b=U(b,v),S.fromBytes(B,"recovered").recoverPublicKey(b).toBytes()},Signature:S,hash:e})}function hu(n){let{CURVE:e,curveOpts:r}=function(i){let s={a:i.a,b:i.b,p:i.Fp.ORDER,n:i.n,h:i.h,Gx:i.Gx,Gy:i.Gy},a=i.Fp,o=i.allowedPrivateKeyLengths?Array.from(new Set(i.allowedPrivateKeyLengths.map(c=>Math.ceil(c/2)))):void 0;return{CURVE:s,curveOpts:{Fp:a,Fn:Je(s.n,{BITS:i.nBitLength,allowedLengths:o,modFromBytes:i.wrapPrivateKey}),allowInfinityPoint:i.allowInfinityPoint,endo:i.endo,isTorsionFree:i.isTorsionFree,clearCofactor:i.clearCofactor,fromBytes:i.fromBytes,toBytes:i.toBytes}}}(n),t={hmac:n.hmac,randomBytes:n.randomBytes,lowS:n.lowS,bits2int:n.bits2int,bits2int_modN:n.bits2int_modN};return{CURVE:e,curveOpts:r,hash:n.hash,ecdsaOpts:t}}function fu(n){let{CURVE:e,curveOpts:r,hash:t,ecdsaOpts:i}=hu(n);return function(s,a){let o=a.Point;return Object.assign({},a,{ProjectivePoint:o,CURVE:Object.assign({},s,A2(o.Fn.ORDER,o.Fn.BITS))})}(n,uu(ou(e,r),t,i))}function Rr(n,e){let r=t=>fu(gt(ue({},n),{hash:t}));return gt(ue({},r(e)),{create:r})}var Q2={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},R2={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},T2={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},lu=Je(Q2.p),yu=Je(R2.p),gu=Je(T2.p),pu=Rr(gt(ue({},Q2),{Fp:lu,lowS:!1}),mo),du=Rr(gt(ue({},R2),{Fp:yu,lowS:!1}),B2),Au=Rr(gt(ue({},T2),{Fp:gu,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),v2),wu=BigInt(0),An=BigInt(1),mu=BigInt(2),bu=BigInt(7),ku=BigInt(256),Eu=BigInt(113),M2=[],F2=[],L2=[];for(let n=0,e=An,r=1,t=0;n<24;n++){[r,t]=[t,(2*r+3*t)%5],M2.push(2*(5*t+r)),F2.push((n+1)*(n+2)/2%64);let i=wu;for(let s=0;s<7;s++)e=(e<<An^(e>>bu)*Eu)%ku,e&mu&&(i^=An<<(An<<BigInt(s))-An);L2.push(i)}var N2=k2(L2,!0),vu=N2[0],Bu=N2[1],C1=(n,e,r)=>r>32?((t,i,s)=>i<<s-32|t>>>64-s)(n,e,r):((t,i,s)=>t<<s|i>>>32-s)(n,e,r),U1=(n,e,r)=>r>32?((t,i,s)=>t<<s-32|i>>>64-s)(n,e,r):((t,i,s)=>i<<s|t>>>32-s)(n,e,r),hs=class n extends Vn{constructor(e,r,t,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=t,this.enableXOF=i,this.rounds=s,jn(t),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");var a;this.state=new Uint8Array(200),this.state32=(a=this.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)))}clone(){return this._cloneInto()}keccak(){h1(this.state32),function(e,r=24){let t=new Uint32Array(10);for(let i=24-r;i<24;i++){for(let o=0;o<10;o++)t[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){let c=(o+8)%10,f=(o+2)%10,h=t[f],u=t[f+1],y=C1(h,u,1)^t[c],g=U1(h,u,1)^t[c+1];for(let p=0;p<50;p+=10)e[o+p]^=y,e[o+p+1]^=g}let s=e[2],a=e[3];for(let o=0;o<24;o++){let c=F2[o],f=C1(s,a,c),h=U1(s,a,c),u=M2[o];s=e[u],a=e[u+1],e[u]=f,e[u+1]=h}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)t[c]=e[o+c];for(let c=0;c<10;c++)e[o+c]^=~t[(c+2)%10]&t[(c+4)%10]}e[0]^=vu[i],e[1]^=Bu[i]}at(t)}(this.state32,this.rounds),h1(this.state32),this.posOut=0,this.pos=0}update(e){an(this),Pt(e=Wn(e));let{blockLen:r,state:t}=this,i=e.length;for(let s=0;s<i;){let a=Math.min(r-this.pos,i-s);for(let o=0;o<a;o++)t[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:r,pos:t,blockLen:i}=this;e[t]^=r,128&r&&t===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){an(this,!1),Pt(e),this.finish();let r=this.state,{blockLen:t}=this;for(let i=0,s=e.length;i<s;){this.posOut>=t&&this.keccak();let a=Math.min(t-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return jn(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(o2(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,at(this.state)}_cloneInto(e){let{blockLen:r,suffix:t,outputLen:i,rounds:s,enableXOF:a}=this;return e||(e=new n(r,t,i,a,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=t,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}},O2=(n,e,r)=>qt(()=>new hs(e,n,r)),Iu=O2(6,136,32),Su=O2(6,72,64),Ku=(n,e,r)=>function(t){let i=(a,o)=>t(o).update(Wn(a)).digest(),s=t({});return i.outputLen=s.outputLen,i.blockLen=s.blockLen,i.create=a=>t(a),i}((t={})=>new hs(e,n,t.dkLen===void 0?r:t.dkLen,!0)),Cu=Ku(31,136,32),er=BigInt(0),Ie=BigInt(1),Ys=BigInt(2),Uu=BigInt(8);function H2(n,e={}){let r=U2("edwards",n,e,e.FpFnLE),{Fp:t,Fn:i}=r,s=r.CURVE,{h:a}=s;cn(e,{},{uvRatio:"function"});let o=Ys<<BigInt(8*i.BYTES)-Ie,c=A=>t.create(A),f=e.uvRatio||((A,k)=>{try{return{isValid:!0,value:t.sqrt(t.div(A,k))}}catch{return{isValid:!1,value:er}}});if(!function(A,k,S,m){let E=A.sqr(S),D=A.sqr(m),R=A.add(A.mul(k.a,E),D),U=A.add(A.ONE,A.mul(k.d,A.mul(E,D)));return A.eql(R,U)}(t,s,s.Gx,s.Gy))throw Error("bad curve params: generator point");function h(A,k,S=!1){return qn("coordinate "+A,k,S?Ie:er,o),k}function u(A){if(!(A instanceof p))throw Error("ExtendedPoint expected")}let y=is((A,k)=>{let{X:S,Y:m,Z:E}=A,D=A.is0();k==null&&(k=D?Uu:t.inv(E));let R=c(S*k),U=c(m*k),B=t.mul(E,k);if(D)return{x:er,y:Ie};if(B!==Ie)throw Error("invZ was invalid");return{x:R,y:U}}),g=is(A=>{let{a:k,d:S}=s;if(A.is0())throw Error("bad point: ZERO");let{X:m,Y:E,Z:D,T:R}=A,U=c(m*m),B=c(E*E),b=c(D*D),C=c(b*b),v=c(U*k);if(c(b*c(v+B))!==c(C+c(S*c(U*B))))throw Error("bad point: equation left != right (1)");if(c(m*E)!==c(D*R))throw Error("bad point: equation left != right (2)");return!0});class p{constructor(k,S,m,E){this.X=h("x",k),this.Y=h("y",S),this.Z=h("z",m,!0),this.T=h("t",E),Object.freeze(this)}static CURVE(){return s}static fromAffine(k){if(k instanceof p)throw Error("extended point not allowed");let{x:S,y:m}=k||{};return h("x",S),h("y",m),new p(S,m,Ie,c(S*m))}static fromBytes(k,S=!1){let m=t.BYTES,{a:E,d:D}=s;k=p1(lt(k,m,"point")),Cr(S,"zip215");let R=p1(k),U=k[m-1];R[m-1]=-129&U;let B=Ur(R),b=S?o:t.ORDER;qn("point.y",B,er,b);let C=c(B*B),v=c(C-Ie),K=c(D*C-E),{isValid:P,value:x}=f(v,K);if(!P)throw Error("bad point: invalid y coordinate");let T=(x&Ie)===Ie,Q=!!(128&U);if(!S&&x===er&&Q)throw Error("bad point: x=0 and x_0=1");return Q!==T&&(x=c(-x)),p.fromAffine({x,y:B})}static fromHex(k,S=!1){return p.fromBytes(le("point",k),S)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(k=8,S=!0){return w.createCache(this,k),S||this.multiply(Ys),this}assertValidity(){g(this)}equals(k){u(k);let{X:S,Y:m,Z:E}=this,{X:D,Y:R,Z:U}=k,B=c(S*U),b=c(D*E),C=c(m*U),v=c(R*E);return B===b&&C===v}is0(){return this.equals(p.ZERO)}negate(){return new p(c(-this.X),this.Y,this.Z,c(-this.T))}double(){let{a:k}=s,{X:S,Y:m,Z:E}=this,D=c(S*S),R=c(m*m),U=c(Ys*c(E*E)),B=c(k*D),b=S+m,C=c(c(b*b)-D-R),v=B+R,K=v-U,P=B-R,x=c(C*K),T=c(v*P),Q=c(C*P),M=c(K*v);return new p(x,T,M,Q)}add(k){u(k);let{a:S,d:m}=s,{X:E,Y:D,Z:R,T:U}=this,{X:B,Y:b,Z:C,T:v}=k,K=c(E*B),P=c(D*b),x=c(U*m*v),T=c(R*C),Q=c((E+D)*(B+b)-K-P),M=T-x,O=T+x,L=c(P-S*K),F=c(Q*M),G=c(O*L),N=c(Q*L),H=c(M*O);return new p(F,G,H,N)}subtract(k){return this.add(k.negate())}multiply(k){if(!i.isValidNot0(k))throw Error("invalid scalar: expected 1 <= sc < curve.n");let{p:S,f:m}=w.cached(this,k,E=>br(p,E));return br(p,[S,m])[0]}multiplyUnsafe(k,S=p.ZERO){if(!i.isValid(k))throw Error("invalid scalar: expected 0 <= sc < curve.n");return k===er?p.ZERO:this.is0()||k===Ie?this:w.unsafe(this,k,m=>br(p,m),S)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return w.unsafe(this,s.n).is0()}toAffine(k){return y(this,k)}clearCofactor(){return a===Ie?this:this.multiplyUnsafe(a)}toBytes(){let{x:k,y:S}=this.toAffine(),m=t.toBytes(S);return m[m.length-1]|=k&Ie?128:0,m}toHex(){return Br(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(k){return br(p,k)}static msm(k,S){return C2(p,i,k,S)}_setWindowSize(k){this.precompute(k)}toRawBytes(){return this.toBytes()}}p.BASE=new p(s.Gx,s.Gy,Ie,c(s.Gx*s.Gy)),p.ZERO=new p(er,Ie,Ie,er),p.Fp=t,p.Fn=i;let w=new us(p,i.BITS);return p.BASE.precompute(8),p}function Pu(n,e,r={}){if(typeof e!="function")throw Error('"hash" function param is required');cn(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:t}=r,{BASE:i,Fp:s,Fn:a}=n,o=r.randomBytes||Bs,c=r.adjustScalarBytes||(m=>m),f=r.domain||((m,E,D)=>{if(Cr(D,"phflag"),E.length||D)throw Error("Contexts/pre-hash are not supported");return m});function h(m){return a.create(Ur(m))}function u(m){let{head:E,prefix:D,scalar:R}=function(b){let C=A.secretKey;b=le("private key",b,C);let v=le("hashed private key",e(b),2*C),K=c(v.slice(0,C));return{head:K,prefix:v.slice(C,2*C),scalar:h(K)}}(m),U=i.multiply(R),B=U.toBytes();return{head:E,prefix:D,scalar:R,point:U,pointBytes:B}}function y(m){return u(m).pointBytes}function g(m=Uint8Array.of(),...E){let D=ht(...E);return h(e(f(D,le("context",m),!!t)))}let p={zip215:!0},w=s.BYTES,A={secretKey:w,publicKey:w,signature:2*w,seed:w};function k(m=o(A.seed)){return lt(m,A.seed,"seed")}let S={getExtendedPublicKey:u,randomSecretKey:k,isValidSecretKey:function(m){return Xn(m)&&m.length===a.BYTES},isValidPublicKey:function(m,E){try{return!!n.fromBytes(m,E)}catch{return!1}},toMontgomery(m){let{y:E}=n.fromBytes(m),D=A.publicKey,R=D===32;if(!R&&D!==57)throw Error("only defined for 25519 and 448");let U=R?s.div(Ie+E,Ie-E):s.div(E-Ie,E+Ie);return s.toBytes(U)},toMontgomeryPriv(m){let E=A.secretKey;lt(m,E);let D=e(m.subarray(0,E));return c(D).subarray(0,E)},randomPrivateKey:k,precompute:(m=8,E=n.BASE)=>E.precompute(m,!1)};return Object.freeze({keygen:function(m){let E=S.randomSecretKey(m);return{secretKey:E,publicKey:y(E)}},getPublicKey:y,sign:function(m,E,D={}){m=le("message",m),t&&(m=t(m));let{prefix:R,scalar:U,pointBytes:B}=u(E),b=g(D.context,R,m),C=i.multiply(b).toBytes(),v=g(D.context,C,B,m),K=a.create(b+v*U);if(!a.isValid(K))throw Error("sign failed: invalid s");return lt(ht(C,a.toBytes(K)),A.signature,"result")},verify:function(m,E,D,R=p){let{context:U,zip215:B}=R,b=A.signature;m=le("signature",m,b),E=le("message",E),D=le("publicKey",D,A.publicKey),B!==void 0&&Cr(B,"zip215"),t&&(E=t(E));let C=b/2,v=m.subarray(0,C),K=Ur(m.subarray(C,b)),P,x,T;try{P=n.fromBytes(D,B),x=n.fromBytes(v,B),T=i.multiplyUnsafe(K)}catch{return!1}if(!B&&P.isSmallOrder())return!1;let Q=g(U,x.toBytes(),P.toBytes(),E);return x.add(P.multiplyUnsafe(Q)).subtract(T).clearCofactor().is0()},utils:S,Point:n,lengths:A})}var wn=BigInt(0),Or=BigInt(1),fi=BigInt(2);function Du(n){let e=(cn(r=n,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(ue({},r)));var r;let{P:t,type:i,adjustScalarBytes:s,powPminus2:a,randomBytes:o}=e,c=i==="x25519";if(!c&&i!=="x448")throw Error("invalid type");let f=o||Bs,h=c?255:448,u=c?32:56,y=BigInt(c?9:5),g=BigInt(c?121665:39081),p=c?fi**BigInt(254):fi**BigInt(447),w=c?BigInt(8)*fi**BigInt(251)-Or:BigInt(4)*fi**BigInt(445)-Or,A=p+w+Or,k=b=>Be(b,t),S=m(y);function m(b){return Ao(k(b),u)}function E(b,C){let v=function(K,P){qn("u",K,wn,t),qn("scalar",P,p,A);let x=P,T=K,Q=Or,M=wn,O=K,L=Or,F=wn;for(let N=BigInt(h-1);N>=wn;N--){let H=x>>N&Or;F^=H,{x_2:Q,x_3:O}=R(F,Q,O),{x_2:M,x_3:L}=R(F,M,L),F=H;let z=Q+M,j=k(z*z),V=Q-M,J=k(V*V),_=j-J,ee=O+L,$=k((O-L)*z),ne=k(ee*V),W=$+ne,ge=$-ne;O=k(W*W),L=k(T*k(ge*ge)),Q=k(j*J),M=k(_*(j+k(g*_)))}({x_2:Q,x_3:O}=R(F,Q,O)),{x_2:M,x_3:L}=R(F,M,L);let G=a(M);return k(Q*G)}(function(K){let P=le("u coordinate",K,u);return c&&(P[31]&=127),k(Ur(P))}(C),function(K){return Ur(s(le("scalar",K,u)))}(b));if(v===wn)throw Error("invalid private or public key received");return m(v)}function D(b){return E(b,S)}function R(b,C,v){let K=k(b*(C-v));return{x_2:C=k(C-K),x_3:v=k(v+K)}}let U={secretKey:u,publicKey:u,seed:u},B=(b=f(u))=>(Pt(b,U.seed),b);return{keygen:function(b){let C=B(b);return{secretKey:C,publicKey:D(C)}},getSharedSecret:(b,C)=>E(b,C),getPublicKey:b=>D(b),scalarMult:E,scalarMultBase:D,utils:{randomSecretKey:B,randomPrivateKey:B},GuBytes:S.slice(),lengths:U}}var Tr={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},xu=Object.assign({},Tr,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),Qu=qt(()=>Cu.create({dkLen:114})),Ru=BigInt(1),Ma=BigInt(2),P1=BigInt(3);BigInt(4);var Tu=BigInt(11),Mu=BigInt(22),D1=BigInt(44),Fu=BigInt(88),Lu=BigInt(223);function z2(n){let e=Tr.p,r=n*n*n%e,t=r*r*n%e,i=fe(t,P1,e)*t%e,s=fe(i,P1,e)*t%e,a=fe(s,Ma,e)*r%e,o=fe(a,Tu,e)*a%e,c=fe(o,Mu,e)*o%e,f=fe(c,D1,e)*c%e,h=fe(f,Fu,e)*f%e,u=fe(h,D1,e)*c%e,y=fe(u,Ma,e)*r%e,g=fe(y,Ru,e)*n%e;return fe(g,Lu,e)*y%e}function G2(n){return n[0]&=252,n[55]|=128,n[56]=0,n}function Nu(n,e){let r=Tr.p,t=Be(n*n*e,r),i=Be(t*n,r),s=Be(i*t*e,r),a=Be(i*z2(s),r),o=Be(a*a,r);return{isValid:Be(o*e,r)===n,value:a}}var Ou=Je(Tr.p,{BITS:456,isLE:!0}),x1=Je(Tr.n,{BITS:456,isLE:!0});function Hu(n,e,r){if(e.length>255)throw Error("context must be smaller than 255, got: "+e.length);return ht((t="SigEd448",Uint8Array.from(t,(i,s)=>{let a=i.charCodeAt(0);if(i.length!==1||a>127)throw Error(`string contains non-ASCII character "${t[s]}" with code ${a} at position ${s}`);return a})),new Uint8Array([r?1:0,e.length]),e,n);var t}var zu=function(n){let{CURVE:e,curveOpts:r,hash:t,eddsaOpts:i}=function(s){let a={a:s.a,d:s.d,p:s.Fp.ORDER,n:s.n,h:s.h,Gx:s.Gx,Gy:s.Gy},o={Fp:s.Fp,Fn:Je(a.n,s.nBitLength,!0),uvRatio:s.uvRatio},c={randomBytes:s.randomBytes,adjustScalarBytes:s.adjustScalarBytes,domain:s.domain,prehash:s.prehash,mapToCurve:s.mapToCurve};return{CURVE:a,curveOpts:o,hash:s.hash,eddsaOpts:c}}(n);return function(s,a){let o=a.Point;return Object.assign({},a,{ExtendedPoint:o,CURVE:s,nBitLength:o.Fn.BITS,nByteLength:o.Fn.BYTES})}(n,Pu(H2(e,r),t,i))}(gt(ue({},Tr),{Fp:Ou,Fn:x1,nBitLength:x1.BITS,hash:Qu,adjustScalarBytes:G2,domain:Hu,uvRatio:Nu}));H2(xu);var Gu=(()=>{let n=Tr.p;return Du({P:n,type:"x448",powPminus2:e=>Be(fe(z2(e),Ma,n)*e,n),adjustScalarBytes:G2})})(),Fa={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},ju={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Q1=BigInt(2);var La=Je(Fa.p,{sqrt:function(n){let e=Fa.p,r=BigInt(3),t=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),f=n*n*n%e,h=f*f*n%e,u=fe(h,r,e)*h%e,y=fe(u,r,e)*h%e,g=fe(y,Q1,e)*f%e,p=fe(g,i,e)*g%e,w=fe(p,s,e)*p%e,A=fe(w,o,e)*w%e,k=fe(A,c,e)*A%e,S=fe(k,o,e)*w%e,m=fe(S,r,e)*h%e,E=fe(m,a,e)*p%e,D=fe(E,t,e)*f%e,R=fe(D,Q1,e);if(!La.eql(La.sqr(R),n))throw Error("Cannot find square root");return R}}),Vu=Rr(gt(ue({},Fa),{Fp:La,lowS:!0,endo:ju}),mo),j2=mo,qu=su,R1=Je(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),_u=Rr({a:R1.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:R1,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},j2),V2=v2,q2=B2,T1=Je(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),Yu=Rr({a:T1.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:T1,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},q2),M1=Je(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),Zu=Rr({a:M1.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:M1,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},V2),Ju=new Map(Object.entries({nistP256:pu,nistP384:du,nistP521:Au,brainpoolP256r1:_u,brainpoolP384r1:Yu,brainpoolP512r1:Zu,secp256k1:Vu,x448:Gu,ed448:zu})),Xu=Object.freeze({__proto__:null,nobleCurves:Ju}),mn=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),tr=new Uint32Array(80),Na=class extends Pr{constructor(){super(64,20,8,!1),this.A=0|mn[0],this.B=0|mn[1],this.C=0|mn[2],this.D=0|mn[3],this.E=0|mn[4]}get(){let{A:e,B:r,C:t,D:i,E:s}=this;return[e,r,t,i,s]}set(e,r,t,i,s){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|i,this.E=0|s}process(e,r){for(let c=0;c<16;c++,r+=4)tr[c]=e.getUint32(r,!1);for(let c=16;c<80;c++)tr[c]=ar(tr[c-3]^tr[c-8]^tr[c-14]^tr[c-16],1);let{A:t,B:i,C:s,D:a,E:o}=this;for(let c=0;c<80;c++){let f,h;c<20?(f=m2(i,s,a),h=1518500249):c<40?(f=i^s^a,h=1859775393):c<60?(f=b2(i,s,a),h=2400959708):(f=i^s^a,h=3395469782);let u=ar(t,5)+f+o+h+tr[c]|0;o=a,a=s,s=ar(i,30),i=t,t=u}t=t+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,this.set(t,i,s,a,o)}roundClean(){at(tr)}destroy(){this.set(0,0,0,0,0),at(this.buffer)}},Wu=qt(()=>new Na),$u=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),_2=Uint8Array.from(Array(16).fill(0).map((n,e)=>e)),eh=_2.map(n=>(9*n+5)%16),Y2=(()=>{let n=[[_2],[eh]];for(let e=0;e<4;e++)for(let r of n)r.push(r[e].map(t=>$u[t]));return n})(),Z2=Y2[0],J2=Y2[1],X2=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(n=>Uint8Array.from(n)),th=Z2.map((n,e)=>n.map(r=>X2[e][r])),rh=J2.map((n,e)=>n.map(r=>X2[e][r])),nh=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),ih=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function F1(n,e,r,t){return n===0?e^r^t:n===1?e&r|~e&t:n===2?(e|~r)^t:n===3?e&t|r&~t:e^(r|~t)}var li=new Uint32Array(16),Oa=class extends Pr{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:e,h1:r,h2:t,h3:i,h4:s}=this;return[e,r,t,i,s]}set(e,r,t,i,s){this.h0=0|e,this.h1=0|r,this.h2=0|t,this.h3=0|i,this.h4=0|s}process(e,r){for(let g=0;g<16;g++,r+=4)li[g]=e.getUint32(r,!0);let t=0|this.h0,i=t,s=0|this.h1,a=s,o=0|this.h2,c=o,f=0|this.h3,h=f,u=0|this.h4,y=u;for(let g=0;g<5;g++){let p=4-g,w=nh[g],A=ih[g],k=Z2[g],S=J2[g],m=th[g],E=rh[g];for(let D=0;D<16;D++){let R=ar(t+F1(g,s,o,f)+li[k[D]]+w,m[D])+u|0;t=u,u=f,f=0|ar(o,10),o=s,s=R}for(let D=0;D<16;D++){let R=ar(i+F1(p,a,c,h)+li[S[D]]+A,E[D])+y|0;i=y,y=h,h=0|ar(c,10),c=a,a=R}}this.set(this.h1+o+h|0,this.h2+f+y|0,this.h3+u+i|0,this.h4+t+a|0,this.h0+s+c|0)}roundClean(){at(li)}destroy(){this.destroyed=!0,at(this.buffer),this.set(0,0,0,0,0)}},sh=Wu,ah=qt(()=>new Oa),oh=Array.from({length:64},(n,e)=>Math.floor(2**32*Math.abs(Math.sin(e+1)))),L1=(n,e,r)=>n&e^~n&r,yi=new Uint32Array([1732584193,4023233417,2562383102,271733878]),Zs=new Uint32Array(16),Ha=class extends Pr{constructor(){super(64,16,8,!0),this.A=0|yi[0],this.B=0|yi[1],this.C=0|yi[2],this.D=0|yi[3]}get(){let{A:e,B:r,C:t,D:i}=this;return[e,r,t,i]}set(e,r,t,i){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|i}process(e,r){for(let o=0;o<16;o++,r+=4)Zs[o]=e.getUint32(r,!0);let{A:t,B:i,C:s,D:a}=this;for(let o=0;o<64;o++){let c,f,h;o<16?(c=L1(i,s,a),f=o,h=[7,12,17,22]):o<32?(c=L1(a,i,s),f=(5*o+1)%16,h=[5,9,14,20]):o<48?(c=i^s^a,f=(3*o+5)%16,h=[4,11,16,23]):(c=s^(i|~a),f=7*o%16,h=[6,10,15,21]),c=c+t+oh[o]+Zs[f],t=a,a=s,s=i,i+=ar(c,h[o%4])}t=t+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,this.set(t,i,s,a)}roundClean(){Zs.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}},ch=new Map(Object.entries({md5:G3(()=>new Ha),sha1:sh,sha224:qu,sha256:j2,sha384:q2,sha512:V2,sha3_256:Iu,sha3_512:Su,ripemd160:ah})),uh=Object.freeze({__proto__:null,nobleHashes:ch}),Js=typeof Te=="object"&&"crypto"in Te?Te.crypto:void 0,Oe={},Y=function(n){var e,r=new Float64Array(16);if(n)for(e=0;e<n.length;e++)r[e]=n[e];return r},za=function(){throw Error("no PRNG")},W2=new Uint8Array(32);W2[0]=9;var Ga=Y(),fs=Y([1]),hh=Y([56129,1]),fh=Y([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),lh=Y([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),N1=Y([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O1=Y([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),yh=Y([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function H1(n,e,r,t){n[e]=r>>24&255,n[e+1]=r>>16&255,n[e+2]=r>>8&255,n[e+3]=255&r,n[e+4]=t>>24&255,n[e+5]=t>>16&255,n[e+6]=t>>8&255,n[e+7]=255&t}function $2(n,e,r,t){return function(i,s,a,o,c){var f,h=0;for(f=0;f<c;f++)h|=i[s+f]^a[o+f];return(1&h-1>>>8)-1}(n,e,r,t,32)}function or(n,e){var r;for(r=0;r<16;r++)n[r]=0|e[r]}function Xs(n){var e,r,t=1;for(e=0;e<16;e++)r=n[e]+t+65535,t=Math.floor(r/65536),n[e]=r-65536*t;n[0]+=t-1+37*(t-1)}function Zr(n,e,r){for(var t,i=~(r-1),s=0;s<16;s++)t=i&(n[s]^e[s]),n[s]^=t,e[s]^=t}function _n(n,e){var r,t,i,s=Y(),a=Y();for(r=0;r<16;r++)a[r]=e[r];for(Xs(a),Xs(a),Xs(a),t=0;t<2;t++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,Zr(a,s,1-i)}for(r=0;r<16;r++)n[2*r]=255&a[r],n[2*r+1]=a[r]>>8}function z1(n,e){var r=new Uint8Array(32),t=new Uint8Array(32);return _n(r,n),_n(t,e),$2(r,0,t,0)}function e0(n){var e=new Uint8Array(32);return _n(e,n),1&e[0]}function t0(n,e){var r;for(r=0;r<16;r++)n[r]=e[2*r]+(e[2*r+1]<<8);n[15]&=32767}function vt(n,e,r){for(var t=0;t<16;t++)n[t]=e[t]+r[t]}function St(n,e,r){for(var t=0;t<16;t++)n[t]=e[t]-r[t]}function re(n,e,r){var t,i,s=0,a=0,o=0,c=0,f=0,h=0,u=0,y=0,g=0,p=0,w=0,A=0,k=0,S=0,m=0,E=0,D=0,R=0,U=0,B=0,b=0,C=0,v=0,K=0,P=0,x=0,T=0,Q=0,M=0,O=0,L=0,F=r[0],G=r[1],N=r[2],H=r[3],z=r[4],j=r[5],V=r[6],J=r[7],_=r[8],ee=r[9],$=r[10],ne=r[11],W=r[12],ge=r[13],de=r[14],pe=r[15];s+=(t=e[0])*F,a+=t*G,o+=t*N,c+=t*H,f+=t*z,h+=t*j,u+=t*V,y+=t*J,g+=t*_,p+=t*ee,w+=t*$,A+=t*ne,k+=t*W,S+=t*ge,m+=t*de,E+=t*pe,a+=(t=e[1])*F,o+=t*G,c+=t*N,f+=t*H,h+=t*z,u+=t*j,y+=t*V,g+=t*J,p+=t*_,w+=t*ee,A+=t*$,k+=t*ne,S+=t*W,m+=t*ge,E+=t*de,D+=t*pe,o+=(t=e[2])*F,c+=t*G,f+=t*N,h+=t*H,u+=t*z,y+=t*j,g+=t*V,p+=t*J,w+=t*_,A+=t*ee,k+=t*$,S+=t*ne,m+=t*W,E+=t*ge,D+=t*de,R+=t*pe,c+=(t=e[3])*F,f+=t*G,h+=t*N,u+=t*H,y+=t*z,g+=t*j,p+=t*V,w+=t*J,A+=t*_,k+=t*ee,S+=t*$,m+=t*ne,E+=t*W,D+=t*ge,R+=t*de,U+=t*pe,f+=(t=e[4])*F,h+=t*G,u+=t*N,y+=t*H,g+=t*z,p+=t*j,w+=t*V,A+=t*J,k+=t*_,S+=t*ee,m+=t*$,E+=t*ne,D+=t*W,R+=t*ge,U+=t*de,B+=t*pe,h+=(t=e[5])*F,u+=t*G,y+=t*N,g+=t*H,p+=t*z,w+=t*j,A+=t*V,k+=t*J,S+=t*_,m+=t*ee,E+=t*$,D+=t*ne,R+=t*W,U+=t*ge,B+=t*de,b+=t*pe,u+=(t=e[6])*F,y+=t*G,g+=t*N,p+=t*H,w+=t*z,A+=t*j,k+=t*V,S+=t*J,m+=t*_,E+=t*ee,D+=t*$,R+=t*ne,U+=t*W,B+=t*ge,b+=t*de,C+=t*pe,y+=(t=e[7])*F,g+=t*G,p+=t*N,w+=t*H,A+=t*z,k+=t*j,S+=t*V,m+=t*J,E+=t*_,D+=t*ee,R+=t*$,U+=t*ne,B+=t*W,b+=t*ge,C+=t*de,v+=t*pe,g+=(t=e[8])*F,p+=t*G,w+=t*N,A+=t*H,k+=t*z,S+=t*j,m+=t*V,E+=t*J,D+=t*_,R+=t*ee,U+=t*$,B+=t*ne,b+=t*W,C+=t*ge,v+=t*de,K+=t*pe,p+=(t=e[9])*F,w+=t*G,A+=t*N,k+=t*H,S+=t*z,m+=t*j,E+=t*V,D+=t*J,R+=t*_,U+=t*ee,B+=t*$,b+=t*ne,C+=t*W,v+=t*ge,K+=t*de,P+=t*pe,w+=(t=e[10])*F,A+=t*G,k+=t*N,S+=t*H,m+=t*z,E+=t*j,D+=t*V,R+=t*J,U+=t*_,B+=t*ee,b+=t*$,C+=t*ne,v+=t*W,K+=t*ge,P+=t*de,x+=t*pe,A+=(t=e[11])*F,k+=t*G,S+=t*N,m+=t*H,E+=t*z,D+=t*j,R+=t*V,U+=t*J,B+=t*_,b+=t*ee,C+=t*$,v+=t*ne,K+=t*W,P+=t*ge,x+=t*de,T+=t*pe,k+=(t=e[12])*F,S+=t*G,m+=t*N,E+=t*H,D+=t*z,R+=t*j,U+=t*V,B+=t*J,b+=t*_,C+=t*ee,v+=t*$,K+=t*ne,P+=t*W,x+=t*ge,T+=t*de,Q+=t*pe,S+=(t=e[13])*F,m+=t*G,E+=t*N,D+=t*H,R+=t*z,U+=t*j,B+=t*V,b+=t*J,C+=t*_,v+=t*ee,K+=t*$,P+=t*ne,x+=t*W,T+=t*ge,Q+=t*de,M+=t*pe,m+=(t=e[14])*F,E+=t*G,D+=t*N,R+=t*H,U+=t*z,B+=t*j,b+=t*V,C+=t*J,v+=t*_,K+=t*ee,P+=t*$,x+=t*ne,T+=t*W,Q+=t*ge,M+=t*de,O+=t*pe,E+=(t=e[15])*F,a+=38*(R+=t*N),o+=38*(U+=t*H),c+=38*(B+=t*z),f+=38*(b+=t*j),h+=38*(C+=t*V),u+=38*(v+=t*J),y+=38*(K+=t*_),g+=38*(P+=t*ee),p+=38*(x+=t*$),w+=38*(T+=t*ne),A+=38*(Q+=t*W),k+=38*(M+=t*ge),S+=38*(O+=t*de),m+=38*(L+=t*pe),s=(t=(s+=38*(D+=t*G))+(i=1)+65535)-65536*(i=Math.floor(t/65536)),a=(t=a+i+65535)-65536*(i=Math.floor(t/65536)),o=(t=o+i+65535)-65536*(i=Math.floor(t/65536)),c=(t=c+i+65535)-65536*(i=Math.floor(t/65536)),f=(t=f+i+65535)-65536*(i=Math.floor(t/65536)),h=(t=h+i+65535)-65536*(i=Math.floor(t/65536)),u=(t=u+i+65535)-65536*(i=Math.floor(t/65536)),y=(t=y+i+65535)-65536*(i=Math.floor(t/65536)),g=(t=g+i+65535)-65536*(i=Math.floor(t/65536)),p=(t=p+i+65535)-65536*(i=Math.floor(t/65536)),w=(t=w+i+65535)-65536*(i=Math.floor(t/65536)),A=(t=A+i+65535)-65536*(i=Math.floor(t/65536)),k=(t=k+i+65535)-65536*(i=Math.floor(t/65536)),S=(t=S+i+65535)-65536*(i=Math.floor(t/65536)),m=(t=m+i+65535)-65536*(i=Math.floor(t/65536)),E=(t=E+i+65535)-65536*(i=Math.floor(t/65536)),s=(t=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(t/65536)),a=(t=a+i+65535)-65536*(i=Math.floor(t/65536)),o=(t=o+i+65535)-65536*(i=Math.floor(t/65536)),c=(t=c+i+65535)-65536*(i=Math.floor(t/65536)),f=(t=f+i+65535)-65536*(i=Math.floor(t/65536)),h=(t=h+i+65535)-65536*(i=Math.floor(t/65536)),u=(t=u+i+65535)-65536*(i=Math.floor(t/65536)),y=(t=y+i+65535)-65536*(i=Math.floor(t/65536)),g=(t=g+i+65535)-65536*(i=Math.floor(t/65536)),p=(t=p+i+65535)-65536*(i=Math.floor(t/65536)),w=(t=w+i+65535)-65536*(i=Math.floor(t/65536)),A=(t=A+i+65535)-65536*(i=Math.floor(t/65536)),k=(t=k+i+65535)-65536*(i=Math.floor(t/65536)),S=(t=S+i+65535)-65536*(i=Math.floor(t/65536)),m=(t=m+i+65535)-65536*(i=Math.floor(t/65536)),E=(t=E+i+65535)-65536*(i=Math.floor(t/65536)),s+=i-1+37*(i-1),n[0]=s,n[1]=a,n[2]=o,n[3]=c,n[4]=f,n[5]=h,n[6]=u,n[7]=y,n[8]=g,n[9]=p,n[10]=w,n[11]=A,n[12]=k,n[13]=S,n[14]=m,n[15]=E}function ft(n,e){re(n,e,e)}function r0(n,e){var r,t=Y();for(r=0;r<16;r++)t[r]=e[r];for(r=253;r>=0;r--)ft(t,t),r!==2&&r!==4&&re(t,t,e);for(r=0;r<16;r++)n[r]=t[r]}function n0(n,e,r){var t,i,s=new Uint8Array(32),a=new Float64Array(80),o=Y(),c=Y(),f=Y(),h=Y(),u=Y(),y=Y();for(i=0;i<31;i++)s[i]=e[i];for(s[31]=127&e[31]|64,s[0]&=248,t0(a,r),i=0;i<16;i++)c[i]=a[i],h[i]=o[i]=f[i]=0;for(o[0]=h[0]=1,i=254;i>=0;--i)Zr(o,c,t=s[i>>>3]>>>(7&i)&1),Zr(f,h,t),vt(u,o,f),St(o,o,f),vt(f,c,h),St(c,c,h),ft(h,u),ft(y,o),re(o,f,o),re(f,c,u),vt(u,o,f),St(o,o,f),ft(c,o),St(f,h,y),re(o,f,hh),vt(o,o,h),re(f,f,o),re(o,h,y),re(h,c,a),ft(c,u),Zr(o,c,t),Zr(f,h,t);for(i=0;i<16;i++)a[i+16]=o[i],a[i+32]=f[i],a[i+48]=c[i],a[i+64]=h[i];var g=a.subarray(32),p=a.subarray(16);return r0(g,g),re(p,p,g),_n(n,p),0}function G1(n,e){return n0(n,e,W2)}var j1=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function V1(n,e,r,t){for(var i,s,a,o,c,f,h,u,y,g,p,w,A,k,S,m,E,D,R,U,B,b,C,v,K,P,x=new Int32Array(16),T=new Int32Array(16),Q=n[0],M=n[1],O=n[2],L=n[3],F=n[4],G=n[5],N=n[6],H=n[7],z=e[0],j=e[1],V=e[2],J=e[3],_=e[4],ee=e[5],$=e[6],ne=e[7],W=0;t>=128;){for(R=0;R<16;R++)U=8*R+W,x[R]=r[U+0]<<24|r[U+1]<<16|r[U+2]<<8|r[U+3],T[R]=r[U+4]<<24|r[U+5]<<16|r[U+6]<<8|r[U+7];for(R=0;R<80;R++)if(i=Q,s=M,a=O,o=L,c=F,f=G,h=N,y=z,g=j,p=V,w=J,A=_,k=ee,S=$,C=65535&(b=ne),v=b>>>16,K=65535&(B=H),P=B>>>16,C+=65535&(b=(_>>>14|F<<18)^(_>>>18|F<<14)^(F>>>9|_<<23)),v+=b>>>16,K+=65535&(B=(F>>>14|_<<18)^(F>>>18|_<<14)^(_>>>9|F<<23)),P+=B>>>16,C+=65535&(b=_&ee^~_&$),v+=b>>>16,K+=65535&(B=F&G^~F&N),P+=B>>>16,C+=65535&(b=j1[2*R+1]),v+=b>>>16,K+=65535&(B=j1[2*R]),P+=B>>>16,B=x[R%16],v+=(b=T[R%16])>>>16,K+=65535&B,P+=B>>>16,K+=(v+=(C+=65535&b)>>>16)>>>16,C=65535&(b=D=65535&C|v<<16),v=b>>>16,K=65535&(B=E=65535&K|(P+=K>>>16)<<16),P=B>>>16,C+=65535&(b=(z>>>28|Q<<4)^(Q>>>2|z<<30)^(Q>>>7|z<<25)),v+=b>>>16,K+=65535&(B=(Q>>>28|z<<4)^(z>>>2|Q<<30)^(z>>>7|Q<<25)),P+=B>>>16,v+=(b=z&j^z&V^j&V)>>>16,K+=65535&(B=Q&M^Q&O^M&O),P+=B>>>16,u=65535&(K+=(v+=(C+=65535&b)>>>16)>>>16)|(P+=K>>>16)<<16,m=65535&C|v<<16,C=65535&(b=w),v=b>>>16,K=65535&(B=o),P=B>>>16,v+=(b=D)>>>16,K+=65535&(B=E),P+=B>>>16,M=i,O=s,L=a,F=o=65535&(K+=(v+=(C+=65535&b)>>>16)>>>16)|(P+=K>>>16)<<16,G=c,N=f,H=h,Q=u,j=y,V=g,J=p,_=w=65535&C|v<<16,ee=A,$=k,ne=S,z=m,R%16==15)for(U=0;U<16;U++)B=x[U],C=65535&(b=T[U]),v=b>>>16,K=65535&B,P=B>>>16,B=x[(U+9)%16],C+=65535&(b=T[(U+9)%16]),v+=b>>>16,K+=65535&B,P+=B>>>16,E=x[(U+1)%16],C+=65535&(b=((D=T[(U+1)%16])>>>1|E<<31)^(D>>>8|E<<24)^(D>>>7|E<<25)),v+=b>>>16,K+=65535&(B=(E>>>1|D<<31)^(E>>>8|D<<24)^E>>>7),P+=B>>>16,E=x[(U+14)%16],v+=(b=((D=T[(U+14)%16])>>>19|E<<13)^(E>>>29|D<<3)^(D>>>6|E<<26))>>>16,K+=65535&(B=(E>>>19|D<<13)^(D>>>29|E<<3)^E>>>6),P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,x[U]=65535&K|P<<16,T[U]=65535&C|v<<16;C=65535&(b=z),v=b>>>16,K=65535&(B=Q),P=B>>>16,B=n[0],v+=(b=e[0])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,n[0]=Q=65535&K|P<<16,e[0]=z=65535&C|v<<16,C=65535&(b=j),v=b>>>16,K=65535&(B=M),P=B>>>16,B=n[1],v+=(b=e[1])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,n[1]=M=65535&K|P<<16,e[1]=j=65535&C|v<<16,C=65535&(b=V),v=b>>>16,K=65535&(B=O),P=B>>>16,B=n[2],v+=(b=e[2])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,n[2]=O=65535&K|P<<16,e[2]=V=65535&C|v<<16,C=65535&(b=J),v=b>>>16,K=65535&(B=L),P=B>>>16,B=n[3],v+=(b=e[3])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,n[3]=L=65535&K|P<<16,e[3]=J=65535&C|v<<16,C=65535&(b=_),v=b>>>16,K=65535&(B=F),P=B>>>16,B=n[4],v+=(b=e[4])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,n[4]=F=65535&K|P<<16,e[4]=_=65535&C|v<<16,C=65535&(b=ee),v=b>>>16,K=65535&(B=G),P=B>>>16,B=n[5],v+=(b=e[5])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,n[5]=G=65535&K|P<<16,e[5]=ee=65535&C|v<<16,C=65535&(b=$),v=b>>>16,K=65535&(B=N),P=B>>>16,B=n[6],v+=(b=e[6])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,n[6]=N=65535&K|P<<16,e[6]=$=65535&C|v<<16,C=65535&(b=ne),v=b>>>16,K=65535&(B=H),P=B>>>16,B=n[7],v+=(b=e[7])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(v+=(C+=65535&b)>>>16)>>>16)>>>16,n[7]=H=65535&K|P<<16,e[7]=ne=65535&C|v<<16,W+=128,t-=128}return t}function Kn(n,e,r){var t,i=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,V1(i,s,e,r),r%=128,t=0;t<r;t++)a[t]=e[o-r+t];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,H1(a,r-8,o/536870912|0,o<<3),V1(i,s,a,r),t=0;t<8;t++)H1(n,8*t,i[t],s[t]);return 0}function ja(n,e){var r=Y(),t=Y(),i=Y(),s=Y(),a=Y(),o=Y(),c=Y(),f=Y(),h=Y();St(r,n[1],n[0]),St(h,e[1],e[0]),re(r,r,h),vt(t,n[0],n[1]),vt(h,e[0],e[1]),re(t,t,h),re(i,n[3],e[3]),re(i,i,lh),re(s,n[2],e[2]),vt(s,s,s),St(a,t,r),St(o,s,i),vt(c,s,i),vt(f,t,r),re(n[0],a,o),re(n[1],f,c),re(n[2],c,o),re(n[3],a,f)}function q1(n,e,r){var t;for(t=0;t<4;t++)Zr(n[t],e[t],r)}function Va(n,e){var r=Y(),t=Y(),i=Y();r0(i,e[2]),re(r,e[0],i),re(t,e[1],i),_n(n,t),n[31]^=e0(r)<<7}function i0(n,e,r){var t,i;for(or(n[0],Ga),or(n[1],fs),or(n[2],fs),or(n[3],Ga),i=255;i>=0;--i)q1(n,e,t=r[i/8|0]>>(7&i)&1),ja(e,n),ja(n,n),q1(n,e,t)}function qa(n,e){var r=[Y(),Y(),Y(),Y()];or(r[0],N1),or(r[1],O1),or(r[2],fs),re(r[3],N1,O1),i0(n,r,e)}function _1(n,e,r){var t,i=new Uint8Array(64),s=[Y(),Y(),Y(),Y()];for(r||za(e,32),Kn(i,e,32),i[0]&=248,i[31]&=127,i[31]|=64,qa(s,i),Va(n,s),t=0;t<32;t++)e[t+32]=n[t];return 0}var Ws=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function s0(n,e){var r,t,i,s;for(t=63;t>=32;--t){for(r=0,i=t-32,s=t-12;i<s;++i)e[i]+=r-16*e[t]*Ws[i-(t-32)],r=Math.floor((e[i]+128)/256),e[i]-=256*r;e[i]+=r,e[t]=0}for(r=0,i=0;i<32;i++)e[i]+=r-(e[31]>>4)*Ws[i],r=e[i]>>8,e[i]&=255;for(i=0;i<32;i++)e[i]-=r*Ws[i];for(t=0;t<32;t++)e[t+1]+=e[t]>>8,n[t]=255&e[t]}function $s(n){var e,r=new Float64Array(64);for(e=0;e<64;e++)r[e]=n[e];for(e=0;e<64;e++)n[e]=0;s0(n,r)}function gh(n,e){var r=Y(),t=Y(),i=Y(),s=Y(),a=Y(),o=Y(),c=Y();return or(n[2],fs),t0(n[1],e),ft(i,n[1]),re(s,i,fh),St(i,i,n[2]),vt(s,n[2],s),ft(a,s),ft(o,a),re(c,o,a),re(r,c,i),re(r,r,s),function(f,h){var u,y=Y();for(u=0;u<16;u++)y[u]=h[u];for(u=250;u>=0;u--)ft(y,y),u!==1&&re(y,y,h);for(u=0;u<16;u++)f[u]=y[u]}(r,r),re(r,r,i),re(r,r,s),re(r,r,s),re(n[0],r,s),ft(t,n[0]),re(t,t,s),z1(t,i)&&re(n[0],n[0],yh),ft(t,n[0]),re(t,t,s),z1(t,i)?-1:(e0(n[0])===e[31]>>7&&St(n[0],Ga,n[0]),re(n[3],n[0],n[1]),0)}var pr=64;function Hr(){for(var n=0;n<arguments.length;n++)if(!(arguments[n]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}Oe.scalarMult=function(n,e){if(Hr(n,e),n.length!==32)throw Error("bad n size");if(e.length!==32)throw Error("bad p size");var r=new Uint8Array(32);return n0(r,n,e),r},Oe.box={},Oe.box.keyPair=function(){var n=new Uint8Array(32),e=new Uint8Array(32);return function(r,t){za(t,32),G1(r,t)}(n,e),{publicKey:n,secretKey:e}},Oe.box.keyPair.fromSecretKey=function(n){if(Hr(n),n.length!==32)throw Error("bad secret key size");var e=new Uint8Array(32);return G1(e,n),{publicKey:e,secretKey:new Uint8Array(n)}},Oe.sign=function(n,e){if(Hr(n,e),e.length!==64)throw Error("bad secret key size");var r=new Uint8Array(pr+n.length);return function(t,i,s,a){var o,c,f=new Uint8Array(64),h=new Uint8Array(64),u=new Uint8Array(64),y=new Float64Array(64),g=[Y(),Y(),Y(),Y()];Kn(f,a,32),f[0]&=248,f[31]&=127,f[31]|=64;var p=s+64;for(o=0;o<s;o++)t[64+o]=i[o];for(o=0;o<32;o++)t[32+o]=f[32+o];for(Kn(u,t.subarray(32),s+32),$s(u),qa(g,u),Va(t,g),o=32;o<64;o++)t[o]=a[o];for(Kn(h,t,s+64),$s(h),o=0;o<64;o++)y[o]=0;for(o=0;o<32;o++)y[o]=u[o];for(o=0;o<32;o++)for(c=0;c<32;c++)y[o+c]+=h[o]*f[c];s0(t.subarray(32),y)}(r,n,n.length,e),r},Oe.sign.detached=function(n,e){for(var r=Oe.sign(n,e),t=new Uint8Array(pr),i=0;i<t.length;i++)t[i]=r[i];return t},Oe.sign.detached.verify=function(n,e,r){if(Hr(n,e,r),e.length!==pr)throw Error("bad signature size");if(r.length!==32)throw Error("bad public key size");var t,i=new Uint8Array(pr+n.length),s=new Uint8Array(pr+n.length);for(t=0;t<pr;t++)i[t]=e[t];for(t=0;t<n.length;t++)i[t+pr]=n[t];return function(a,o,c,f){var h,u=new Uint8Array(32),y=new Uint8Array(64),g=[Y(),Y(),Y(),Y()],p=[Y(),Y(),Y(),Y()];if(c<64||gh(p,f))return-1;for(h=0;h<c;h++)a[h]=o[h];for(h=0;h<32;h++)a[h+32]=f[h];if(Kn(y,a,c),$s(y),i0(g,p,y),qa(p,o.subarray(32)),ja(g,p),Va(u,g),c-=64,$2(o,0,u,0)){for(h=0;h<c;h++)a[h]=0;return-1}for(h=0;h<c;h++)a[h]=o[h+64];return c}(s,i,i.length,r)>=0},Oe.sign.keyPair=function(){var n=new Uint8Array(32),e=new Uint8Array(64);return _1(n,e),{publicKey:n,secretKey:e}},Oe.sign.keyPair.fromSecretKey=function(n){if(Hr(n),n.length!==64)throw Error("bad secret key size");for(var e=new Uint8Array(32),r=0;r<e.length;r++)e[r]=n[32+r];return{publicKey:e,secretKey:new Uint8Array(n)}},Oe.sign.keyPair.fromSeed=function(n){if(Hr(n),n.length!==32)throw Error("bad seed size");for(var e=new Uint8Array(32),r=new Uint8Array(64),t=0;t<32;t++)r[t]=n[t];return _1(e,r,!0),{publicKey:e,secretKey:r}},Oe.setPRNG=function(n){za=n},function(){Js&&Js.getRandomValues&&Oe.setPRNG(function(n,e){var r,t=new Uint8Array(e);for(r=0;r<e;r+=65536)Js.getRandomValues(t.subarray(r,r+Math.min(e-r,65536)));for(r=0;r<e;r++)n[r]=t[r];(function(i){for(var s=0;s<i.length;s++)i[s]=0})(t)})}();var Mr=Object.freeze({__proto__:null,default:Oe});function ea(n,e,r,t,i,s){let a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],f=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],u=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],y=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],g=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696],p,w,A,k,S,m,E,D,R,U,B=0,b=e.length,C=n.length===32?3:9;D=C===3?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],r&&(e=function(P){let x=8-P.length%8,T;if(!(x<8)){if(x===8)return P;throw Error("des: invalid padding")}T=0;let Q=new Uint8Array(P.length+x);for(let M=0;M<P.length;M++)Q[M]=P[M];for(let M=0;M<x;M++)Q[P.length+M]=T;return Q}(e),b=e.length);let v=new Uint8Array(b),K=0;for(;B<b;){for(m=e[B++]<<24|e[B++]<<16|e[B++]<<8|e[B++],E=e[B++]<<24|e[B++]<<16|e[B++]<<8|e[B++],A=252645135&(m>>>4^E),E^=A,m^=A<<4,A=65535&(m>>>16^E),E^=A,m^=A<<16,A=858993459&(E>>>2^m),m^=A,E^=A<<2,A=16711935&(E>>>8^m),m^=A,E^=A<<8,A=1431655765&(m>>>1^E),E^=A,m^=A<<1,m=m<<1|m>>>31,E=E<<1|E>>>31,w=0;w<C;w+=3){for(R=D[w+1],U=D[w+2],p=D[w];p!==R;p+=U)k=E^n[p],S=(E>>>4|E<<28)^n[p+1],A=m,m=E,E=A^(o[k>>>24&63]|f[k>>>16&63]|u[k>>>8&63]|g[63&k]|a[S>>>24&63]|c[S>>>16&63]|h[S>>>8&63]|y[63&S]);A=m,m=E,E=A}m=m>>>1|m<<31,E=E>>>1|E<<31,A=1431655765&(m>>>1^E),E^=A,m^=A<<1,A=16711935&(E>>>8^m),m^=A,E^=A<<8,A=858993459&(E>>>2^m),m^=A,E^=A<<2,A=65535&(m>>>16^E),E^=A,m^=A<<16,A=252645135&(m>>>4^E),E^=A,m^=A<<4,v[K++]=m>>>24,v[K++]=m>>>16&255,v[K++]=m>>>8&255,v[K++]=255&m,v[K++]=E>>>24,v[K++]=E>>>16&255,v[K++]=E>>>8&255,v[K++]=255&E}return r||(v=function(P){let x,T=null;if(x=0,!T){for(T=1;P[P.length-T]===x;)T++;T--}return P.subarray(0,P.length-T)}(v)),v}function ta(n){let e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],t=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],u=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],y=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],w=n.length>8?3:1,A=Array(32*w),k=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],S,m,E,D=0,R=0;for(let U=0;U<w;U++){let B=n[D++]<<24|n[D++]<<16|n[D++]<<8|n[D++],b=n[D++]<<24|n[D++]<<16|n[D++]<<8|n[D++];E=252645135&(B>>>4^b),b^=E,B^=E<<4,E=65535&(b>>>-16^B),B^=E,b^=E<<-16,E=858993459&(B>>>2^b),b^=E,B^=E<<2,E=65535&(b>>>-16^B),B^=E,b^=E<<-16,E=1431655765&(B>>>1^b),b^=E,B^=E<<1,E=16711935&(b>>>8^B),B^=E,b^=E<<8,E=1431655765&(B>>>1^b),b^=E,B^=E<<1,E=B<<8|b>>>20&240,B=b<<24|b<<8&16711680|b>>>8&65280|b>>>24&240,b=E;for(let C=0;C<16;C++)k[C]?(B=B<<2|B>>>26,b=b<<2|b>>>26):(B=B<<1|B>>>27,b=b<<1|b>>>27),B&=-15,b&=-15,S=e[B>>>28]|r[B>>>24&15]|t[B>>>20&15]|i[B>>>16&15]|s[B>>>12&15]|a[B>>>8&15]|o[B>>>4&15],m=c[b>>>28]|f[b>>>24&15]|h[b>>>20&15]|u[b>>>16&15]|y[b>>>12&15]|g[b>>>8&15]|p[b>>>4&15],E=65535&(m>>>16^S),A[R++]=S^E,A[R++]=m^E<<16}return A}function Cn(n){this.key=[];for(let e=0;e<3;e++)this.key.push(new Uint8Array(n.subarray(8*e,8*e+8)));this.encrypt=function(e){return ea(ta(this.key[2]),ea(ta(this.key[1]),ea(ta(this.key[0]),e,!0),!1),!0)}}function ph(){this.BlockSize=8,this.KeySize=16,this.setKey=function(a){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),a.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(a),!0},this.reset=function(){for(let a=0;a<16;a++)this.masking[a]=0,this.rotate[a]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(a){let o=Array(a.length);for(let c=0;c<a.length;c+=8){let f,h=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],u=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];f=u,u=h^r(u,this.masking[0],this.rotate[0]),h=f,f=u,u=h^t(u,this.masking[1],this.rotate[1]),h=f,f=u,u=h^i(u,this.masking[2],this.rotate[2]),h=f,f=u,u=h^r(u,this.masking[3],this.rotate[3]),h=f,f=u,u=h^t(u,this.masking[4],this.rotate[4]),h=f,f=u,u=h^i(u,this.masking[5],this.rotate[5]),h=f,f=u,u=h^r(u,this.masking[6],this.rotate[6]),h=f,f=u,u=h^t(u,this.masking[7],this.rotate[7]),h=f,f=u,u=h^i(u,this.masking[8],this.rotate[8]),h=f,f=u,u=h^r(u,this.masking[9],this.rotate[9]),h=f,f=u,u=h^t(u,this.masking[10],this.rotate[10]),h=f,f=u,u=h^i(u,this.masking[11],this.rotate[11]),h=f,f=u,u=h^r(u,this.masking[12],this.rotate[12]),h=f,f=u,u=h^t(u,this.masking[13],this.rotate[13]),h=f,f=u,u=h^i(u,this.masking[14],this.rotate[14]),h=f,f=u,u=h^r(u,this.masking[15],this.rotate[15]),h=f,o[c]=u>>>24&255,o[c+1]=u>>>16&255,o[c+2]=u>>>8&255,o[c+3]=255&u,o[c+4]=h>>>24&255,o[c+5]=h>>>16&255,o[c+6]=h>>>8&255,o[c+7]=255&h}return o},this.decrypt=function(a){let o=Array(a.length);for(let c=0;c<a.length;c+=8){let f,h=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],u=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];f=u,u=h^r(u,this.masking[15],this.rotate[15]),h=f,f=u,u=h^i(u,this.masking[14],this.rotate[14]),h=f,f=u,u=h^t(u,this.masking[13],this.rotate[13]),h=f,f=u,u=h^r(u,this.masking[12],this.rotate[12]),h=f,f=u,u=h^i(u,this.masking[11],this.rotate[11]),h=f,f=u,u=h^t(u,this.masking[10],this.rotate[10]),h=f,f=u,u=h^r(u,this.masking[9],this.rotate[9]),h=f,f=u,u=h^i(u,this.masking[8],this.rotate[8]),h=f,f=u,u=h^t(u,this.masking[7],this.rotate[7]),h=f,f=u,u=h^r(u,this.masking[6],this.rotate[6]),h=f,f=u,u=h^i(u,this.masking[5],this.rotate[5]),h=f,f=u,u=h^t(u,this.masking[4],this.rotate[4]),h=f,f=u,u=h^r(u,this.masking[3],this.rotate[3]),h=f,f=u,u=h^i(u,this.masking[2],this.rotate[2]),h=f,f=u,u=h^t(u,this.masking[1],this.rotate[1]),h=f,f=u,u=h^r(u,this.masking[0],this.rotate[0]),h=f,o[c]=u>>>24&255,o[c+1]=u>>>16&255,o[c+2]=u>>>8&255,o[c+3]=255&u,o[c+4]=h>>>24&255,o[c+5]=h>>16&255,o[c+6]=h>>8&255,o[c+7]=255&h}return o};let n=[,,,,];n[0]=[,,,,],n[0][0]=[4,0,13,15,12,14,8],n[0][1]=[5,2,16,18,17,19,10],n[0][2]=[6,3,23,22,21,20,9],n[0][3]=[7,1,26,25,27,24,11],n[1]=[,,,,],n[1][0]=[0,6,21,23,20,22,16],n[1][1]=[1,4,0,2,1,3,18],n[1][2]=[2,5,7,6,5,4,17],n[1][3]=[3,7,10,9,11,8,19],n[2]=[,,,,],n[2][0]=[4,0,13,15,12,14,8],n[2][1]=[5,2,16,18,17,19,10],n[2][2]=[6,3,23,22,21,20,9],n[2][3]=[7,1,26,25,27,24,11],n[3]=[,,,,],n[3][0]=[0,6,21,23,20,22,16],n[3][1]=[1,4,0,2,1,3,18],n[3][2]=[2,5,7,6,5,4,17],n[3][3]=[3,7,10,9,11,8,19];let e=[,,,,];function r(a,o,c){let f=o+a,h=f<<c|f>>>32-c;return(s[0][h>>>24]^s[1][h>>>16&255])-s[2][h>>>8&255]+s[3][255&h]}function t(a,o,c){let f=o^a,h=f<<c|f>>>32-c;return s[0][h>>>24]-s[1][h>>>16&255]+s[2][h>>>8&255]^s[3][255&h]}function i(a,o,c){let f=o-a,h=f<<c|f>>>32-c;return(s[0][h>>>24]+s[1][h>>>16&255]^s[2][h>>>8&255])-s[3][255&h]}e[0]=[,,,,],e[0][0]=[24,25,23,22,18],e[0][1]=[26,27,21,20,22],e[0][2]=[28,29,19,18,25],e[0][3]=[30,31,17,16,28],e[1]=[,,,,],e[1][0]=[3,2,12,13,8],e[1][1]=[1,0,14,15,13],e[1][2]=[7,6,8,9,3],e[1][3]=[5,4,10,11,7],e[2]=[,,,,],e[2][0]=[19,18,28,29,25],e[2][1]=[17,16,30,31,28],e[2][2]=[23,22,24,25,18],e[2][3]=[21,20,26,27,22],e[3]=[,,,,],e[3][0]=[8,9,7,6,3],e[3][1]=[10,11,5,4,7],e[3][2]=[12,13,3,2,8],e[3][3]=[14,15,1,0,13],this.keySchedule=function(a){let o=[,,,,,,,,],c=Array(32),f;for(let g=0;g<4;g++)f=4*g,o[g]=a[f]<<24|a[f+1]<<16|a[f+2]<<8|a[f+3];let h=[6,7,4,5],u,y=0;for(let g=0;g<2;g++)for(let p=0;p<4;p++){for(f=0;f<4;f++){let w=n[p][f];u=o[w[1]],u^=s[4][o[w[2]>>>2]>>>24-8*(3&w[2])&255],u^=s[5][o[w[3]>>>2]>>>24-8*(3&w[3])&255],u^=s[6][o[w[4]>>>2]>>>24-8*(3&w[4])&255],u^=s[7][o[w[5]>>>2]>>>24-8*(3&w[5])&255],u^=s[h[f]][o[w[6]>>>2]>>>24-8*(3&w[6])&255],o[w[0]]=u}for(f=0;f<4;f++){let w=e[p][f];u=s[4][o[w[0]>>>2]>>>24-8*(3&w[0])&255],u^=s[5][o[w[1]>>>2]>>>24-8*(3&w[1])&255],u^=s[6][o[w[2]>>>2]>>>24-8*(3&w[2])&255],u^=s[7][o[w[3]>>>2]>>>24-8*(3&w[3])&255],u^=s[4+f][o[w[4]>>>2]>>>24-8*(3&w[4])&255],c[y]=u,y++}}for(let g=0;g<16;g++)this.masking[g]=c[g],this.rotate[g]=31&c[16+g]};let s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Un(n){this.cast5=new ph,this.cast5.setKey(n),this.encrypt=function(e){return this.cast5.encrypt(e)}}Cn.keySize=Cn.prototype.keySize=24,Cn.blockSize=Cn.prototype.blockSize=8,Un.blockSize=Un.prototype.blockSize=8,Un.keySize=Un.prototype.keySize=16;var tt=4294967295;function dt(n,e){return(n<<e|n>>>32-e)&tt}function Rt(n,e){return n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24}function rr(n,e,r){n.splice(e,4,255&r,r>>>8&255,r>>>16&255,r>>>24&255)}function X(n,e){return n>>>8*e&255}function Pn(n){this.tf=function(){let e=null,r=null,t=-1,i=[],s=[[],[],[],[]];function a(h){return s[0][X(h,0)]^s[1][X(h,1)]^s[2][X(h,2)]^s[3][X(h,3)]}function o(h){return s[0][X(h,3)]^s[1][X(h,0)]^s[2][X(h,1)]^s[3][X(h,2)]}function c(h,u){let y=a(u[0]),g=o(u[1]);u[2]=dt(u[2]^y+g+i[4*h+8]&tt,31),u[3]=dt(u[3],1)^y+2*g+i[4*h+9]&tt,y=a(u[2]),g=o(u[3]),u[0]=dt(u[0]^y+g+i[4*h+10]&tt,31),u[1]=dt(u[1],1)^y+2*g+i[4*h+11]&tt}function f(h,u){let y=a(u[0]),g=o(u[1]);u[2]=dt(u[2],1)^y+g+i[4*h+10]&tt,u[3]=dt(u[3]^y+2*g+i[4*h+11]&tt,31),y=a(u[2]),g=o(u[3]),u[0]=dt(u[0],1)^y+g+i[4*h+8]&tt,u[1]=dt(u[1]^y+2*g+i[4*h+9]&tt,31)}return{name:"twofish",blocksize:16,open:function(h){let u,y,g,p,w;e=h;let A=[],k=[],S=[],m,E=[],D,R,U,B=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],b=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],C=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],v=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],K=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],P=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],x=[[],[]],T=[[],[],[],[]];function Q(G){return G^G>>2^[0,90,180,238][3&G]}function M(G){return G^G>>1^G>>2^[0,238,180,90][3&G]}function O(G,N){let H,z,j;for(H=0;H<8;H++)z=N>>>24,N=N<<8&tt|G>>>24,G=G<<8&tt,j=z<<1,128&z&&(j^=333),N^=z^j<<16,j^=z>>>1,1&z&&(j^=166),N^=j<<24|j<<8;return N}function L(G,N){let H=N>>4,z=15&N,j=B[G][H^z],V=b[G][K[z]^P[H]];return v[G][K[V]^P[j]]<<4|C[G][j^V]}function F(G,N){let H=X(G,0),z=X(G,1),j=X(G,2),V=X(G,3);switch(m){case 4:H=x[1][H]^X(N[3],0),z=x[0][z]^X(N[3],1),j=x[0][j]^X(N[3],2),V=x[1][V]^X(N[3],3);case 3:H=x[1][H]^X(N[2],0),z=x[1][z]^X(N[2],1),j=x[0][j]^X(N[2],2),V=x[0][V]^X(N[2],3);case 2:H=x[0][x[0][H]^X(N[1],0)]^X(N[0],0),z=x[0][x[1][z]^X(N[1],1)]^X(N[0],1),j=x[1][x[0][j]^X(N[1],2)]^X(N[0],2),V=x[1][x[1][V]^X(N[1],3)]^X(N[0],3)}return T[0][H]^T[1][z]^T[2][j]^T[3][V]}for(e=e.slice(0,32),u=e.length;u!==16&&u!==24&&u!==32;)e[u++]=0;for(u=0;u<e.length;u+=4)S[u>>2]=Rt(e,u);for(u=0;u<256;u++)x[0][u]=L(0,u),x[1][u]=L(1,u);for(u=0;u<256;u++)D=x[1][u],R=Q(D),U=M(D),T[0][u]=D+(R<<8)+(U<<16)+(U<<24),T[2][u]=R+(U<<8)+(D<<16)+(U<<24),D=x[0][u],R=Q(D),U=M(D),T[1][u]=U+(U<<8)+(R<<16)+(D<<24),T[3][u]=R+(D<<8)+(U<<16)+(R<<24);for(m=S.length/2,u=0;u<m;u++)y=S[u+u],A[u]=y,g=S[u+u+1],k[u]=g,E[m-u-1]=O(y,g);for(u=0;u<40;u+=2)y=16843009*u,g=y+16843009,y=F(y,A),g=dt(F(g,k),8),i[u]=y+g&tt,i[u+1]=dt(y+2*g,9);for(u=0;u<256;u++)switch(y=g=p=w=u,m){case 4:y=x[1][y]^X(E[3],0),g=x[0][g]^X(E[3],1),p=x[0][p]^X(E[3],2),w=x[1][w]^X(E[3],3);case 3:y=x[1][y]^X(E[2],0),g=x[1][g]^X(E[2],1),p=x[0][p]^X(E[2],2),w=x[0][w]^X(E[2],3);case 2:s[0][u]=T[0][x[0][x[0][y]^X(E[1],0)]^X(E[0],0)],s[1][u]=T[1][x[0][x[1][g]^X(E[1],1)]^X(E[0],1)],s[2][u]=T[2][x[1][x[0][p]^X(E[1],2)]^X(E[0],2)],s[3][u]=T[3][x[1][x[1][w]^X(E[1],3)]^X(E[0],3)]}},close:function(){i=[],s=[[],[],[],[]]},encrypt:function(h,u){r=h,t=u;let y=[Rt(r,t)^i[0],Rt(r,t+4)^i[1],Rt(r,t+8)^i[2],Rt(r,t+12)^i[3]];for(let g=0;g<8;g++)c(g,y);return rr(r,t,y[2]^i[4]),rr(r,t+4,y[3]^i[5]),rr(r,t+8,y[0]^i[6]),rr(r,t+12,y[1]^i[7]),t+=16,r},decrypt:function(h,u){r=h,t=u;let y=[Rt(r,t)^i[4],Rt(r,t+4)^i[5],Rt(r,t+8)^i[6],Rt(r,t+12)^i[7]];for(let g=7;g>=0;g--)f(g,y);rr(r,t,y[2]^i[0]),rr(r,t+4,y[3]^i[1]),rr(r,t+8,y[0]^i[2]),rr(r,t+12,y[1]^i[3]),t+=16},finalize:function(){return r}}}(),this.tf.open(Array.from(n),0),this.encrypt=function(e){return this.tf.encrypt(Array.from(e),0)}}function ct(){}function Dn(n){this.bf=new ct,this.bf.init(n),this.encrypt=function(e){return this.bf.encryptBlock(e)}}Pn.keySize=Pn.prototype.keySize=32,Pn.blockSize=Pn.prototype.blockSize=16,ct.prototype.BLOCKSIZE=8,ct.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],ct.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],ct.prototype.NN=16,ct.prototype._clean=function(n){return n<0&&(n=(2147483647&n)+2147483648),n},ct.prototype._F=function(n){let e,r=255&n,t=255&(n>>>=8),i=255&(n>>>=8),s=255&(n>>>=8);return e=this.sboxes[0][s]+this.sboxes[1][i],e^=this.sboxes[2][t],e+=this.sboxes[3][r],e},ct.prototype._encryptBlock=function(n){let e,r=n[0],t=n[1];for(e=0;e<this.NN;++e){r^=this.parray[e],t=this._F(r)^t;let i=r;r=t,t=i}r^=this.parray[this.NN+0],t^=this.parray[this.NN+1],n[0]=this._clean(t),n[1]=this._clean(r)},ct.prototype.encryptBlock=function(n){let e,r=[0,0],t=this.BLOCKSIZE/2;for(e=0;e<this.BLOCKSIZE/2;++e)r[0]=r[0]<<8|255&n[e+0],r[1]=r[1]<<8|255&n[e+t];this._encryptBlock(r);let i=[];for(e=0;e<this.BLOCKSIZE/2;++e)i[e+0]=r[0]>>>24-8*e&255,i[e+t]=r[1]>>>24-8*e&255;return i},ct.prototype._decryptBlock=function(n){let e,r=n[0],t=n[1];for(e=this.NN+1;e>1;--e){r^=this.parray[e],t=this._F(r)^t;let i=r;r=t,t=i}r^=this.parray[1],t^=this.parray[0],n[0]=this._clean(t),n[1]=this._clean(r)},ct.prototype.init=function(n){let e,r=0;for(this.parray=[],e=0;e<this.NN+2;++e){let i=0;for(let s=0;s<4;++s)i=i<<8|255&n[r],++r>=n.length&&(r=0);this.parray[e]=this.PARRAY[e]^i}for(this.sboxes=[],e=0;e<4;++e)for(this.sboxes[e]=[],r=0;r<256;++r)this.sboxes[e][r]=this.SBOXES[e][r];let t=[0,0];for(e=0;e<this.NN+2;e+=2)this._encryptBlock(t),this.parray[e+0]=t[0],this.parray[e+1]=t[1];for(e=0;e<4;++e)for(r=0;r<256;r+=2)this._encryptBlock(t),this.sboxes[e][r+0]=t[0],this.sboxes[e][r+1]=t[1]},Dn.keySize=Dn.prototype.keySize=16,Dn.blockSize=Dn.prototype.blockSize=8;var dh=new Map(Object.entries({tripledes:Cn,cast5:Un,twofish:Pn,blowfish:Dn})),Ah=Object.freeze({__proto__:null,legacyCiphers:dh});function zr(n,e,r,t){n[e]+=r[t],n[e+1]+=r[t+1]+(n[e]<r[t])}function Y1(n,e){n[0]+=e,n[1]+=n[0]<e}function nr(n,e,r,t,i,s,a,o){zr(n,r,n,t),zr(n,r,e,a);let c=n[s]^n[r],f=n[s+1]^n[r+1];n[s]=f,n[s+1]=c,zr(n,i,n,s),c=n[t]^n[i],f=n[t+1]^n[i+1],n[t]=c>>>24^f<<8,n[t+1]=f>>>24^c<<8,zr(n,r,n,t),zr(n,r,e,o),c=n[s]^n[r],f=n[s+1]^n[r+1],n[s]=c>>>16^f<<16,n[s+1]=f>>>16^c<<16,zr(n,i,n,s),c=n[t]^n[i],f=n[t+1]^n[i+1],n[t]=f>>>31^c<<1,n[t+1]=c>>>31^f<<1}var a0=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Re=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(n=>2*n));function Z1(n,e){let r=new Uint32Array(32),t=new Uint32Array(n.b.buffer,n.b.byteOffset,32);for(let s=0;s<16;s++)r[s]=n.h[s],r[s+16]=a0[s];r[24]^=n.t0[0],r[25]^=n.t0[1];let i=e?4294967295:0;r[28]^=i,r[29]^=i;for(let s=0;s<12;s++){let a=s<<4;nr(r,t,0,8,16,24,Re[a+0],Re[a+1]),nr(r,t,2,10,18,26,Re[a+2],Re[a+3]),nr(r,t,4,12,20,28,Re[a+4],Re[a+5]),nr(r,t,6,14,22,30,Re[a+6],Re[a+7]),nr(r,t,0,10,20,30,Re[a+8],Re[a+9]),nr(r,t,2,12,22,24,Re[a+10],Re[a+11]),nr(r,t,4,14,16,26,Re[a+12],Re[a+13]),nr(r,t,6,8,18,28,Re[a+14],Re[a+15])}for(let s=0;s<16;s++)n.h[s]^=r[s]^r[s+16]}var _a=class{constructor(e,r,t,i){let s=new Uint8Array(64);this.S={b:new Uint8Array(bn),h:new Uint32Array(Ya/4),t0:new Uint32Array(2),c:0,outlen:e},s[0]=e,r&&(s[1]=r.length),s[2]=1,s[3]=1,t&&s.set(t,32),i&&s.set(i,48);let a=new Uint32Array(s.buffer,s.byteOffset,s.length/Uint32Array.BYTES_PER_ELEMENT);for(let o=0;o<16;o++)this.S.h[o]=a0[o]^a[o];if(r){let o=new Uint8Array(bn);o.set(r),this.update(o)}}update(e){if(!(e instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let r=0;for(;r<e.length;){this.S.c===bn&&(Y1(this.S.t0,this.S.c),Z1(this.S,!1),this.S.c=0);let t=bn-this.S.c;this.S.b.set(e.subarray(r,r+t),this.S.c);let i=Math.min(t,e.length-r);this.S.c+=i,r+=i}return this}digest(e){Y1(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=bn,Z1(this.S,!0);let r=e||new Uint8Array(this.S.outlen);for(let t=0;t<this.S.outlen;t++)r[t]=this.S.h[t>>2]>>8*(3&t);return this.S.h=null,r.buffer}};function Bi(n,e,r,t){if(n>Ya)throw Error(`outlen must be at most ${Ya} (given: ${n})`);return new _a(n,e,r,t)}var Ya=64,bn=128,Tt=1024,wh=new Uint8Array(new Uint16Array([43981]).buffer)[0]===205;function He(n,e,r){return n[r+0]=e,n[r+1]=e>>8,n[r+2]=e>>16,n[r+3]=e>>24,n}function dr(n,e,r){if(e>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let t=e;for(let i=r;i<r+7;i++)n[i]=t,t=(t-n[i])/256;return n}function ra(n,e,r){let t=new Uint8Array(64),i=new Uint8Array(4+e.length);if(He(i,n,0),i.set(e,4),n<=64)return Bi(n).update(i).digest(r),r;let s=Math.ceil(n/32)-2;for(let o=0;o<s;o++)Bi(64).update(o===0?i:t).digest(t),r.set(t.subarray(0,32),32*o);let a=new Uint8Array(Bi(n-32*s).update(t).digest());return r.set(a,32*s),r}function J1(n,e,r,t){return n.fn.XOR(e.byteOffset,r.byteOffset,t.byteOffset),e}function mh(n,e,r,t){return n.fn.G(e.byteOffset,r.byteOffset,t.byteOffset,n.refs.gZ.byteOffset),t}function bh(n,e,r,t){return n.fn.G2(e.byteOffset,r.byteOffset,t.byteOffset,n.refs.gZ.byteOffset),t}function*kh(n,e,r,t,i,s,a,o){n.refs.prngTmp.fill(0);let c=n.refs.prngTmp.subarray(0,48);dr(c,e,0),dr(c,r,8),dr(c,t,16),dr(c,i,24),dr(c,s,32),dr(c,2,40);for(let f=1;f<=a;f++){dr(n.refs.prngTmp,f,c.length);let h=bh(n,n.refs.ZERO1024,n.refs.prngTmp,n.refs.prngR);for(let u=f===1?8*o:0;u<h.length;u+=8)yield h.subarray(u,u+8)}return[]}function Eh(n,{memory:e,instance:r}){if(!wh)throw Error("BigEndian system not supported");let t=function({type:b,version:C,tagLength:v,password:K,salt:P,ad:x,secret:T,parallelism:Q,memorySize:M,passes:O}){let L=(F,G,N,H)=>{if(G<N||G>H)throw Error(`${F} size should be between ${N} and ${H} bytes`)};if(b!==2||C!==19)throw Error("Unsupported type or version");return L("password",K,8,4294967295),L("salt",P,8,4294967295),L("tag",v,4,4294967295),L("memory",M,8*Q,4294967295),x&&L("associated data",x,0,4294967295),T&&L("secret",T,0,32),{type:b,version:C,tagLength:v,password:K,salt:P,ad:x,secret:T,lanes:Q,memorySize:M,passes:O}}(ue({type:2,version:19},n)),{G:i,G2:s,xor:a,getLZ:o}=r.exports,c={},f={};f.G=i,f.G2=s,f.XOR=a;let h=4*t.lanes*Math.floor(t.memorySize/(4*t.lanes)),u=h*Tt+10240;if(e.buffer.byteLength<u){let b=Math.ceil((u-e.buffer.byteLength)/65536);e.grow(b)}let y=0;c.gZ=new Uint8Array(e.buffer,y,Tt),y+=c.gZ.length,c.prngR=new Uint8Array(e.buffer,y,Tt),y+=c.prngR.length,c.prngTmp=new Uint8Array(e.buffer,y,Tt),y+=c.prngTmp.length,c.ZERO1024=new Uint8Array(e.buffer,y,1024),y+=c.ZERO1024.length;let g=new Uint32Array(e.buffer,y,2);y+=g.length*Uint32Array.BYTES_PER_ELEMENT;let p={fn:f,refs:c},w=new Uint8Array(e.buffer,y,Tt);y+=w.length;let A=new Uint8Array(e.buffer,y,t.memorySize*Tt),k=new Uint8Array(e.buffer,0,y),S=function(b){let C=Bi(64),v=new Uint8Array(4),K=new Uint8Array(24);He(K,b.lanes,0),He(K,b.tagLength,4),He(K,b.memorySize,8),He(K,b.passes,12),He(K,b.version,16),He(K,b.type,20);let P=[K];b.password?(P.push(He(new Uint8Array(4),b.password.length,0)),P.push(b.password)):P.push(v),b.salt?(P.push(He(new Uint8Array(4),b.salt.length,0)),P.push(b.salt)):P.push(v),b.secret?(P.push(He(new Uint8Array(4),b.secret.length,0)),P.push(b.secret)):P.push(v),b.ad?(P.push(He(new Uint8Array(4),b.ad.length,0)),P.push(b.ad)):P.push(v),C.update(function(T){if(T.length===1)return T[0];let Q=0;for(let L=0;L<T.length;L++){if(!(T[L]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");Q+=T[L].length}let M=new Uint8Array(Q),O=0;return T.forEach(L=>{M.set(L,O),O+=L.length}),M}(P));let x=C.digest();return new Uint8Array(x)}(t),m=h/t.lanes,E=Array(t.lanes).fill(null).map(()=>Array(m)),D=(b,C)=>(E[b][C]=A.subarray(b*m*1024+1024*C,b*m*1024+1024*C+Tt),E[b][C]);for(let b=0;b<t.lanes;b++){let C=new Uint8Array(S.length+8);C.set(S),He(C,0,S.length),He(C,b,S.length+4),ra(Tt,C,D(b,0)),He(C,1,S.length),ra(Tt,C,D(b,1))}let R=m/4;for(let b=0;b<t.passes;b++)for(let C=0;C<4;C++){let v=b===0&&C<=1;for(let K=0;K<t.lanes;K++){let P=C===0&&b===0?2:0,x=v?kh(p,b,K,C,h,t.passes,R,P):null;for(;P<R;P++){let T=C*R+P,Q=T>0?E[K][T-1]:E[K][m-1],M=v?x.next().value:Q;o(g.byteOffset,M.byteOffset,K,t.lanes,b,C,P,4,R);let O=g[0],L=g[1];b===0&&D(K,T),mh(p,Q,E[O][L],b>0?w:E[K][T]),b>0&&J1(p,E[K][T],w,E[K][T])}}}let U=E[0][m-1];for(let b=1;b<t.lanes;b++)J1(p,U,U,E[b][m-1]);let B=ra(t.tagLength,U,new Uint8Array(t.tagLength));return k.fill(0),e.grow(0),B}var gi;function vh(n,e){return I(this,null,function*(){let r=new WebAssembly.Memory({initial:1040,maximum:65536}),t=yield function(i,s,a){return I(this,null,function*(){let o={env:{memory:i}};if(gi===void 0)try{let c=yield s(o);return gi=!0,c}catch{gi=!1}return(gi?s:a)(o)})}(r,n,e);return i=>Eh(i,{instance:t.instance,memory:r})})}function X1(n,e,r,t){var i=null,s=Te.atob(r),a=s.length;i=new Uint8Array(new ArrayBuffer(a));for(var o=0;o<a;o++)i[o]=s.charCodeAt(o);return function(c,f,h){var u=h?WebAssembly.instantiateStreaming:WebAssembly.instantiate,y=h?WebAssembly.compileStreaming:WebAssembly.compile;return f?u(c,f):y(c)}(i,t,!1)}var W1,$1,ec,tc,rc,nc,ic,sc,Bh=Object.freeze({__proto__:null,default:()=>I(null,null,function*(){return vh(n=>X1(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",n),n=>X1(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",n))})});function Ih(){if($1)return W1;$1=1;var n=[0,1,3,7,15,31,63,127,255],e=function(r){this.stream=r,this.bitOffset=0,this.curByte=0,this.hasByte=!1};return e.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},e.prototype.read=function(r){for(var t=0;r>0;){this._ensureByte();var i=8-this.bitOffset;if(r>=i)t<<=i,t|=n[i]&this.curByte,this.hasByte=!1,this.bitOffset=0,r-=i;else{t<<=r;var s=i-r;t|=(this.curByte&n[r]<<s)>>s,this.bitOffset+=r,r=0}}return t},e.prototype.seek=function(r){var t=r%8,i=(r-t)/8;this.bitOffset=t,this.stream.seek(i),this.hasByte=!1},e.prototype.pi=function(){var r,t=new Uint8Array(6);for(r=0;r<t.length;r++)t[r]=this.read(8);return function(i){return Array.prototype.map.call(i,s=>("00"+s.toString(16)).slice(-2)).join("")}(t)},W1=e}var Sh=function(){if(sc)return ic;sc=1;var n,e=Ih(),r=function(){if(tc)return ec;tc=1;var u=function(){};return u.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},u.prototype.read=function(y,g,p){for(var w=0;w<p;){var A=this.readByte();if(A<0)return w===0?-1:w;y[g++]=A,w++}return w},u.prototype.seek=function(y){throw Error("abstract method seek() not implemented")},u.prototype.writeByte=function(y){throw Error("abstract method readByte() not implemented")},u.prototype.write=function(y,g,p){var w;for(w=0;w<p;w++)this.writeByte(y[g++]);return p},u.prototype.flush=function(){},ec=u}(),t=nc?rc:(nc=1,n=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),rc=function(){var u=4294967295;this.getCRC=function(){return~u>>>0},this.updateCRC=function(y){u=u<<8^n[255&(u>>>24^y)]},this.updateCRCRun=function(y,g){for(;g-- >0;)u=u<<8^n[255&(u>>>24^y)]}}),i=function(u,y){var g,p=u[y];for(g=y;g>0;g--)u[g]=u[g-1];return u[0]=p,p},s={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},a={};a[s.LAST_BLOCK]="Bad file checksum",a[s.NOT_BZIP_DATA]="Not bzip data",a[s.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",a[s.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",a[s.DATA_ERROR]="Data error",a[s.OUT_OF_MEMORY]="Out of memory",a[s.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var o=function(u,y){var g=a[u]||"unknown error";y&&(g+=": "+y);var p=new TypeError(g);throw p.errorCode=u,p},c=function(u,y){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(u,y)};c.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new t,!0):(this.writeCount=-1,!1)},c.prototype._start_bunzip=function(u,y){var g=new Uint8Array(4);u.read(g,0,4)===4&&String.fromCharCode(g[0],g[1],g[2])==="BZh"||o(s.NOT_BZIP_DATA,"bad magic");var p=g[3]-48;(p<1||p>9)&&o(s.NOT_BZIP_DATA,"level out of range"),this.reader=new e(u),this.dbufSize=1e5*p,this.nextoutput=0,this.outputStream=y,this.streamCRC=0},c.prototype._get_next_block=function(){var u,y,g,p=this.reader,w=p.pi();if(w==="177245385090")return!1;w!=="314159265359"&&o(s.NOT_BZIP_DATA),this.targetBlockCRC=p.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,p.read(1)&&o(s.OBSOLETE_INPUT);var A=p.read(24);A>this.dbufSize&&o(s.DATA_ERROR,"initial position out of bounds");var k=p.read(16),S=new Uint8Array(256),m=0;for(u=0;u<16;u++)if(k&1<<15-u){var E=16*u;for(g=p.read(16),y=0;y<16;y++)g&1<<15-y&&(S[m++]=E+y)}var D=p.read(3);(D<2||D>6)&&o(s.DATA_ERROR);var R=p.read(15);R===0&&o(s.DATA_ERROR);var U=new Uint8Array(256);for(u=0;u<D;u++)U[u]=u;var B=new Uint8Array(R);for(u=0;u<R;u++){for(y=0;p.read(1);y++)y>=D&&o(s.DATA_ERROR);B[u]=i(U,y)}var b,C=m+2,v=[];for(y=0;y<D;y++){var K,P,x=new Uint8Array(C),T=new Uint16Array(21);for(k=p.read(5),u=0;u<C;u++){for(;(k<1||k>20)&&o(s.DATA_ERROR),p.read(1);)p.read(1)?k--:k++;x[u]=k}for(K=P=x[0],u=1;u<C;u++)x[u]>P?P=x[u]:x[u]<K&&(K=x[u]);b={},v.push(b),b.permute=new Uint16Array(258),b.limit=new Uint32Array(22),b.base=new Uint32Array(21),b.minLen=K,b.maxLen=P;var Q=0;for(u=K;u<=P;u++)for(T[u]=b.limit[u]=0,k=0;k<C;k++)x[k]===u&&(b.permute[Q++]=k);for(u=0;u<C;u++)T[x[u]]++;for(Q=k=0,u=K;u<P;u++)Q+=T[u],b.limit[u]=Q-1,Q<<=1,k+=T[u],b.base[u+1]=Q-k;b.limit[P+1]=Number.MAX_VALUE,b.limit[P]=Q+T[P]-1,b.base[K]=0}var M=new Uint32Array(256);for(u=0;u<256;u++)U[u]=u;var O,L=0,F=0,G=0,N=this.dbuf=new Uint32Array(this.dbufSize);for(C=0;;){for(C--||(C=49,G>=R&&o(s.DATA_ERROR),b=v[B[G++]]),u=b.minLen,y=p.read(u);u>b.maxLen&&o(s.DATA_ERROR),!(y<=b.limit[u]);u++)y=y<<1|p.read(1);((y-=b.base[u])<0||y>=258)&&o(s.DATA_ERROR);var H=b.permute[y];if(H!==0&&H!==1){if(L)for(L=0,F+k>this.dbufSize&&o(s.DATA_ERROR),M[O=S[U[0]]]+=k;k--;)N[F++]=O;if(H>m)break;F>=this.dbufSize&&o(s.DATA_ERROR),M[O=S[O=i(U,u=H-1)]]++,N[F++]=O}else L||(L=1,k=0),k+=H===0?L:2*L,L<<=1}for((A<0||A>=F)&&o(s.DATA_ERROR),y=0,u=0;u<256;u++)g=y+M[u],M[u]=y,y=g;for(u=0;u<F;u++)N[M[O=255&N[u]]]|=u<<8,M[O]++;var z=0,j=0,V=0;return F&&(j=255&(z=N[A]),z>>=8,V=-1),this.writePos=z,this.writeCurrent=j,this.writeCount=F,this.writeRun=V,!0},c.prototype._read_bunzip=function(u,y){var g,p,w;if(this.writeCount<0)return 0;var A=this.dbuf,k=this.writePos,S=this.writeCurrent,m=this.writeCount;this.outputsize;for(var E=this.writeRun;m;){for(m--,p=S,S=255&(k=A[k]),k>>=8,E++==3?(g=S,w=p,S=-1):(g=1,w=S),this.blockCRC.updateCRCRun(w,g);g--;)this.outputStream.writeByte(w),this.nextoutput++;S!=p&&(E=0)}return this.writeCount=m,this.blockCRC.getCRC()!==this.targetBlockCRC&&o(s.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var f=function(u){if("readByte"in u)return u;var y=new r;return y.pos=0,y.readByte=function(){return u[this.pos++]},y.seek=function(g){this.pos=g},y.eof=function(){return this.pos>=u.length},y},h=function(u){var y=new r,g=!0;if(u)if(typeof u=="number")y.buffer=new Uint8Array(u),g=!1;else{if("writeByte"in u)return u;y.buffer=u,g=!1}else y.buffer=new Uint8Array(16384);return y.pos=0,y.writeByte=function(p){if(g&&this.pos>=this.buffer.length){var w=new Uint8Array(2*this.buffer.length);w.set(this.buffer),this.buffer=w}this.buffer[this.pos++]=p},y.getBuffer=function(){if(this.pos!==this.buffer.length){if(!g)throw new TypeError("outputsize does not match decoded input");var p=new Uint8Array(this.pos);p.set(this.buffer.subarray(0,this.pos)),this.buffer=p}return this.buffer},y._coerced=!0,y};return ic={Bunzip:c,Stream:r,Err:s,decode:function(u,y,g){for(var p=f(u),w=h(y),A=new c(p,w);!("eof"in p)||!p.eof();)if(A._init_block())A._read_bunzip();else{var k=A.reader.read(32)>>>0;if(k!==A.streamCRC&&o(s.DATA_ERROR,"Bad stream CRC (got "+A.streamCRC.toString(16)+" expected "+k.toString(16)+")"),!g||!("eof"in p)||p.eof())break;A._start_bunzip(p,w)}if("getBuffer"in w)return w.getBuffer()},decodeBlock:function(u,y,g){var p=f(u),w=h(g),A=new c(p,w);if(A.reader.seek(y),A._get_next_block()&&(A.blockCRC=new t,A.writeCopies=0,A._read_bunzip()),"getBuffer"in w)return w.getBuffer()},table:function(u,y,g){var p=new r;p.delegate=f(u),p.pos=0,p.readByte=function(){return this.pos++,this.delegate.readByte()},p.delegate.eof&&(p.eof=p.delegate.eof.bind(p.delegate));var w=new r;w.pos=0,w.writeByte=function(){this.pos++};for(var A=new c(p,w),k=A.dbufSize;!("eof"in p)||!p.eof();){var S=8*p.pos+A.reader.bitOffset;if(A.reader.hasByte&&(S-=8),A._init_block()){var m=w.pos;A._read_bunzip(),y(S,w.pos-m)}else{if(A.reader.read(32),!g||!("eof"in p)||p.eof())break;A._start_bunzip(p,w),console.assert(A.dbufSize===k,"shouldn't change block size within multistream file")}}}}}(),Kh=c0({__proto__:null},[Sh]);var o0=new Bo(()=>!1);var Mh=(()=>{class n{get progress(){return!!this.tail.length}constructor(r){this._http=r,this.tail=[]}sendRequest(a,o){return I(this,arguments,function*(r,t,i={},s={}){r=r.toLocaleLowerCase(),s.headers&&s.headers.Authorization&&(s.context=s.context||new Map,s.context.set(o0,!0));try{switch(r){case"get":return this.request(this._http.get(t,ue({params:i},s)));case"post":return this.request(this._http.post(t,i,ue({},s)));case"put":return this.request(this._http.put(t,i,ue({},s)));case"delete":return this.request(this._http.delete(t,ue({},s)));default:throw new Error("Method not provided or unsupported")}}catch(c){throw console.error("Error in sendRequest:",c),c}})}request(r){return r.toPromise().then(t=>t).catch(t=>{throw t})}setPublicKey(r){this.publicKey=r}encryptMessage(r){return I(this,null,function*(){if(!r)return r;if(!this.publicKey)throw new Error("cannot_encrypt_message");let t=yield n2({armoredKey:this.publicKey});return yield s2({message:yield i2({text:r}),encryptionKeys:t})})}static{this.\u0275fac=function(t){return new(t||n)(vo(Io))}}static{this.\u0275prov=Eo({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{Mh as a};
