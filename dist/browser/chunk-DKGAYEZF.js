var f=class n{constructor(e){this.domain=e.domain||"",this.domainConfig=this.buildDomainConfig(e.domainConfig),this.faceBase64=e.faceBase64,this.masterPassword=e.masterPassword,this.ipfsHash=e.ipfsHash,this.createdAt=e.createdAt,this.updatedAt=e.updatedAt,this.ipfs=e.ipfs,this.zelfProof=e.zelfProof,this.expiresAt=e.expiresAt,this.subscriptionId=e.subscriptionId,this.previousDomain=e.previousDomain,this.type=e.type}buildDomainConfig(e){let t=e?.domainConfig||e;return{name:t?.name||"",type:t?.type||"custom",holdSuffix:t?.holdSuffix||".hold",status:t?.status||"inactive",owner:t?.owner||"",description:t?.description||"",limits:{tags:t?.limits?.tags||1e4,zelfkeys:t?.limits?.zelfkeys||1e4},features:t?.features||[{name:"Zelf Name System",code:"zns",description:"Encryptions, Decryptions, previews of ZelfProofs",enabled:!0},{name:"Zelf Keys",code:"zelfkeys",description:"Zelf Keys: Passwords, Notes, Credit Cards, etc.",enabled:!0}],validation:{minLength:t?.validation?.minLength||3,maxLength:t?.validation?.maxLength||50,allowedChars:t?.validation?.allowedChars||/^[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]$/,reserved:t?.validation?.reserved||["www","api","admin","support","help"],customRules:t?.validation?.customRules||[]},storage:{keyPrefix:t?.storage?.keyPrefix||"tagName",ipfsEnabled:t?.storage?.ipfsEnabled||!0,arweaveEnabled:t?.storage?.arweaveEnabled||!0,walrusEnabled:t?.storage?.walrusEnabled||!0},tagPaymentSettings:{methods:t?.tagPaymentSettings?.methods||["coinbase","crypto","stripe"],currencies:t?.tagPaymentSettings?.currencies||["USD","BTC","ETH","SOL"],whitelist:t?.tagPaymentSettings?.whitelist||{},pricingTable:t?.tagPaymentSettings?.pricingTable||this.getDefaultPricingTable()},metadata:{launchDate:t?.metadata?.launchDate||new Date().toISOString().split("T")[0],version:t?.metadata?.version||"1.0.0",documentation:t?.metadata?.documentation||"",community:t?.metadata?.community,enterprise:t?.metadata?.enterprise,support:t?.metadata?.support||"standard"}}}getDefaultPricingTable(){return{1:{1:240,2:432,3:612,4:768,5:900,lifetime:3600},2:{1:120,2:216,3:306,4:384,5:450,lifetime:1800},3:{1:72,2:130,3:184,4:230,5:270,lifetime:1080},4:{1:36,2:65,3:92,4:115,5:135,lifetime:540},5:{1:30,2:54,3:76,4:96,5:112,lifetime:450},"6-15":{1:24,2:43,3:61,4:77,5:90,lifetime:360},16:{1:23,2:41,3:59,4:74,5:86,lifetime:345},17:{1:22,2:40,3:56,4:70,5:82,lifetime:330},18:{1:21,2:38,3:54,4:67,5:79,lifetime:315},19:{1:20,2:36,3:51,4:64,5:75,lifetime:300},20:{1:19,2:34,3:48,4:61,5:72,lifetime:285},21:{1:18,2:32,3:46,4:58,5:68,lifetime:270},22:{1:17,2:31,3:43,4:54,5:64,lifetime:255},23:{1:16,2:29,3:41,4:51,5:60,lifetime:240},24:{1:15,2:27,3:38,4:48,5:56,lifetime:225},25:{1:14,2:25,3:36,4:45,5:53,lifetime:210},26:{1:13,2:23,3:33,4:42,5:49,lifetime:195},27:{1:12,2:22,3:31,4:38,5:45,lifetime:180}}}getIPFSData(){return this.ipfs}getIPFSHash(){return this.ipfs?.IpfsHash||this.ipfsHash}getIPFSUrl(){return this.ipfs?.url}getIPFSMetadata(){return this.ipfs?.metadata}getZelfProof(){return this.zelfProof}getExpirationDate(){return this.expiresAt?new Date(this.expiresAt):void 0}isExpired(){return this.expiresAt?new Date(this.expiresAt)<new Date:!1}getSubscriptionId(){return this.subscriptionId}getPreviousDomain(){return this.previousDomain}getLicenseType(){return this.type||this.domainConfig.type}isActive(){return this.domainConfig.status==="active"}supportsFeature(e){return this.domainConfig.features.some(t=>t.code===e&&t.enabled)}getPrice(e,t="1",a=""){if(!e)return{price:0,currency:"USD",reward:0,discount:0,priceWithoutDiscount:0,discountType:"percentage"};let u=e.split("."),r=a.replace(".hold",""),o=u[0].length;if(!this.domainConfig.tagPaymentSettings.pricingTable)return{price:0,currency:"USD",reward:0,discount:0,priceWithoutDiscount:0,discountType:"percentage"};if(!["1","2","3","4","5","lifetime"].includes(t))throw new Error("Invalid duration. Use '1', '2', '3', '4', '5' or 'lifetime'.");let i=24;if(o>=6&&o<=15)i=this.domainConfig.tagPaymentSettings.pricingTable["6-15"][t];else if(this.domainConfig.tagPaymentSettings.pricingTable[o])i=this.domainConfig.tagPaymentSettings.pricingTable[o][t];else throw new Error("Invalid name length. Length must be between 1 and 27.");let p=Number(i),s=0,l="percentage",d=this.domainConfig.tagPaymentSettings.whitelist||{};if(Object.keys(d).length&&r&&d[r]){let m=d[r];m.includes("%")?(l="percentage",s=parseInt(m),i=i-i*(s/100)):(s=parseInt(m),l="amount",i=i-s)}else r&&(i=i-i*.1);return{price:Math.max(Math.ceil(i*100)/100,0),currency:"USD",reward:Math.max(Math.ceil(i/10*100)/100,0),discount:s,priceWithoutDiscount:p,discountType:l}}validateTagName(e){if(e.length<this.domainConfig.validation.minLength)return{valid:!1,error:`Tag name must be at least ${this.domainConfig.validation.minLength} characters long`};if(e.length>this.domainConfig.validation.maxLength)return{valid:!1,error:`Tag name must be no more than ${this.domainConfig.validation.maxLength} characters long`};if(!this.domainConfig.validation.allowedChars.test(e))return{valid:!1,error:`Tag name contains invalid characters. Allowed pattern: ${this.domainConfig.validation.allowedChars}`};if(this.domainConfig.validation.reserved.includes(e.toLowerCase()))return{valid:!1,error:`Tag name '${e}' is reserved`};for(let t of this.domainConfig.validation.customRules)if(typeof t=="function"){let a=t(e);if(!a.valid)return a}return{valid:!0}}getStorageConfig(){return this.domainConfig.storage}getPaymentMethods(){return this.domainConfig.tagPaymentSettings.methods}getSupportedCurrencies(){return this.domainConfig.tagPaymentSettings.currencies}getLimits(){return this.domainConfig.limits}generateHoldDomain(e){return`${e}${this.domainConfig.holdSuffix}.${this.domain}`}toJSON(){return{domain:this.domain,domainConfig:this.domainConfig,faceBase64:this.faceBase64,masterPassword:this.masterPassword,ipfsHash:this.ipfsHash,createdAt:this.createdAt,updatedAt:this.updatedAt,ipfs:this.ipfs,zelfProof:this.zelfProof,expiresAt:this.expiresAt,subscriptionId:this.subscriptionId,previousDomain:this.previousDomain,type:this.type}}static fromJSON(e){return new n(e)}static fromAPIResponse(e){let t={domain:e.domain,domainConfig:{name:e.name,type:e.type,holdSuffix:e.holdSuffix,status:e.status,owner:e.owner,description:e.description,limits:e.limits,features:e.features,validation:e.validation,storage:e.storage,tagPaymentSettings:e.tagPaymentSettings,metadata:e.metadata},ipfs:e.ipfs,zelfProof:e.zelfProof,expiresAt:e.expiresAt,subscriptionId:e.subscriptionId,previousDomain:e.previousDomain,type:e.type};return new n(t)}static fromAPIResponseWithWrapper(e){let t=e.data||e;return n.fromAPIResponse(t)}static createEmpty(e){return new n({domain:e,domainConfig:{name:e,type:"custom",holdSuffix:".hold",status:"inactive",owner:"zelf-team",description:`Custom domain: ${e}`,limits:{tags:1e4,zelfkeys:1e4},features:[{name:"Zelf Name System",code:"zns",description:"Encryptions, Decryptions, previews of ZelfProofs",enabled:!0},{name:"Zelf Keys",code:"zelfkeys",description:"Zelf Keys: Passwords, Notes, Credit Cards, etc.",enabled:!0}],validation:{minLength:3,maxLength:50,allowedChars:/^[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]$/,reserved:["www","api","admin","support","help"],customRules:[]},storage:{keyPrefix:"tagName",ipfsEnabled:!0,arweaveEnabled:!0,walrusEnabled:!0},tagPaymentSettings:{methods:["coinbase","crypto","stripe"],currencies:["USD","BTC","ETH","SOL"],whitelist:{},pricingTable:{}},metadata:{launchDate:new Date().toISOString().split("T")[0],version:"1.0.0",documentation:"",support:"standard"}}})}};export{f as a};
