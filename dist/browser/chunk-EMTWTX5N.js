import{a as n}from"./chunk-E6ENPQNB.js";import{z as c}from"./chunk-RXE653LG.js";import{Y as r,aa as a,ga as l,p as o}from"./chunk-UOZRKCH4.js";import{g as i}from"./chunk-TSRGIXR5.js";var S=(()=>{class s{constructor(){this._httpClient=l(c),this._sessionToken=null}getSessionToken(){return this._sessionToken||(this._sessionToken=localStorage.getItem("sessionToken")),this._sessionToken}setSessionToken(e){this._sessionToken=e,localStorage.setItem("sessionToken",e)}clearSessionToken(){this._sessionToken=null,localStorage.removeItem("sessionToken")}createSession(e){return this._httpClient.post(`${n.apiUrl}/api/sessions`,e).pipe(r(t=>{t&&t.data&&t.data.token&&this.setSessionToken(t.data.token)}))}getPublicKey(e){return this._httpClient.get(`${n.apiUrl}/api/sessions/yek-cilbup`,{params:e})}decryptContent(e){return this._httpClient.post(`${n.apiUrl}/api/sessions/decrypt-content`,e)}generateSessionIdentifier(){let e=Date.now(),t=Math.random().toString(36).substring(2,9);return`session_${e}_${t}`}hasSessionToken(){return!!this.getSessionToken()}initializePaymentSession(){return i(this,null,function*(){if(this.hasSessionToken())return null;try{let e=this.generateSessionIdentifier();return(yield o(this.createSession({identifier:e,isWebExtension:!1,type:"general"})))||null}catch(e){return console.error("Failed to create session:",e),null}})}static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275prov=a({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{S as a};
