import{a as nt}from"./chunk-6ETROX6A.js";import{c as et}from"./chunk-5A4CLC4T.js";import{c as it}from"./chunk-EVPYPNUG.js";import"./chunk-MCJLLZNO.js";import"./chunk-GCWISREG.js";import{a as tt}from"./chunk-NL2GQIJH.js";import"./chunk-LU5ZPOGU.js";import{k as $,n as X}from"./chunk-3GEO6YUQ.js";import"./chunk-QJBLCKSO.js";import"./chunk-JYHC2XGO.js";import{b as H,f as W,g as L,l as O,o as Y,p as Z,x as J,y as K,z as Q}from"./chunk-VTBKW2GH.js";import{b as G,c as A}from"./chunk-AWGMSRYJ.js";import{ca as V,fa as D,ia as j}from"./chunk-XLOSQDG4.js";import{a as g}from"./chunk-2PUMVMOA.js";import{a as q}from"./chunk-VFSGURZL.js";import{d as R}from"./chunk-BIZJNN6K.js";import{k as U}from"./chunk-4QULIMQU.js";import{Ab as f,Bc as M,Ib as d,Mc as N,Ob as z,Pb as c,Rb as T,Sb as I,Tb as n,Ub as a,Vb as p,Zb as b,aa as B,dc as y,fc as u,ga as C,gb as l,hb as v,qc as o,ra as S,rc as k,sa as P,sc as h,ta as E,ua as w,ub as F}from"./chunk-J6ZWT2MN.js";import{g as _}from"./chunk-TSRGIXR5.js";var ot=(()=>{class e{constructor(){this._httpClient=C(R),this._httpWrapper=C(q)}getSubscriptionPlans(){return _(this,null,function*(){try{let t=new Promise((m,x)=>setTimeout(()=>x(new Error("Request timeout after 10 seconds")),1e4)),i=this._httpWrapper.sendRequest("get",`${g.apiUrl}${g.endpoints.subscriptionPlans.list}`);return(yield Promise.race([i,t])).data||[]}catch(t){throw t}})}getSubscriptionPlan(t){return _(this,null,function*(){try{return(yield this._httpWrapper.sendRequest("get",`${g.apiUrl}${g.endpoints.subscriptionPlans.getById}/${t}`)).data}catch(i){throw i}})}subscribe(t){return _(this,null,function*(){try{let i=yield this._httpWrapper.sendRequest("post",`${g.apiUrl}${g.endpoints.subscriptionPlans.subscribe}`,t);return i.data?i.data:i}catch(i){throw i}})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var rt=(e,r)=>({"ring-4 ring-primary":e,"hover:ring-2 hover:ring-primary/50":r});function st(e,r){e&1&&(n(0,"div",10)(1,"mat-icon",16),o(2,"refresh"),a(),n(3,"span",17),o(4,"Loading plans..."),a()())}function ct(e,r){if(e&1&&(n(0,"div",11)(1,"fuse-alert",18),o(2),a()()),e&2){let t=u();l(),d("appearance","outline")("type","error"),l(),h(" ",t.error," ")}}function dt(e,r){if(e&1&&(n(0,"div",34)(1,"div",35),o(2),a(),n(3,"div",36),o(4),a()(),n(5,"div",37)(6,"div"),o(7),a()()),e&2){let t=u().$implicit,i=u(2);l(2),k(i.getCheapestPrice(t).currency.toUpperCase()),l(2),h(" ",i.formatPrice(i.getCheapestPrice(t).unit_amount,i.getCheapestPrice(t).currency)," "),l(3),h("",i.getCheapestPrice(t).recurring.interval," billing")}}function mt(e,r){e&1&&(n(0,"div",27),o(1,"Contact"),a())}function pt(e,r){e&1&&o(0," Core features, including: ")}function ut(e,r){e&1&&o(0," Personal features, plus: ")}function _t(e,r){e&1&&o(0," Premium features, plus: ")}function ft(e,r){e&1&&(n(0,"b"),o(1,"50"),a(),o(2," active users "))}function gt(e,r){e&1&&(n(0,"b"),o(1,"500"),a(),o(2," active users "))}function xt(e,r){e&1&&(n(0,"b"),o(1,"1,250"),a(),o(2," active users "))}function ht(e,r){e&1&&(n(0,"b"),o(1,"3,000"),a(),o(2," active users "))}function vt(e,r){e&1&&(n(0,"b"),o(1,"10,000"),a(),o(2," active users "))}function Ct(e,r){e&1&&(n(0,"b"),o(1,"Unlimited"),a(),o(2," active users "))}function St(e,r){e&1&&(n(0,"b"),o(1,"50"),a(),o(2," encryptions/month "))}function Pt(e,r){e&1&&(n(0,"b"),o(1,"Unlimited"),a(),o(2," encryptions "))}function bt(e,r){e&1&&(n(0,"div",31),p(1,"mat-icon",32),n(2,"div",33),o(3,"Priority support"),a()()),e&2&&(l(),d("svgIcon","heroicons_solid:check"))}function yt(e,r){e&1&&(n(0,"div",31),p(1,"mat-icon",32),n(2,"div",33)(3,"b"),o(4,"Dedicated"),a(),o(5," infrastructure"),a()()),e&2&&(l(),d("svgIcon","heroicons_solid:check"))}function Bt(e,r){e&1&&(n(0,"div",31),p(1,"mat-icon",32),n(2,"div",33),o(3,"Advanced analytics"),a()()),e&2&&(l(),d("svgIcon","heroicons_solid:check"))}function Et(e,r){e&1&&(n(0,"div",31),p(1,"mat-icon",32),n(2,"div",33),o(3,"24/7 support"),a()()),e&2&&(l(),d("svgIcon","heroicons_solid:check"))}function wt(e,r){if(e&1){let t=b();n(0,"fuse-card",22),y("click",function(){let s=S(t).$implicit,m=u(2);return P(m.selectPlan(s.id))}),n(1,"div",23)(2,"div",24),o(3),a(),n(4,"div",25),o(5),a(),p(6,"div",26),f(7,dt,8,3)(8,mt,2,0,"div",27),n(9,"div",28)(10,"div",29),f(11,pt,1,0)(12,ut,1,0)(13,_t,1,0),a(),n(14,"div",30)(15,"div",31),p(16,"mat-icon",32),n(17,"div",33),f(18,ft,3,0)(19,gt,3,0)(20,xt,3,0)(21,ht,3,0)(22,vt,3,0)(23,Ct,3,0),a()(),n(24,"div",31),p(25,"mat-icon",32),n(26,"div",33),f(27,St,3,0)(28,Pt,3,0),a()(),f(29,bt,4,1,"div",31)(30,yt,6,1,"div",31)(31,Bt,4,1,"div",31)(32,Et,4,1,"div",31),a()()()()}if(e&2){let t=r.$implicit,i=u(2);d("ngClass",M(13,rt,i.isPlanSelected(t.id),!i.isPlanSelected(t.id))),l(3),h(" ",i.getPlanDisplayName(t.metadata.zelfPlan)," "),l(2),h(" ",t.description||t.name," "),l(2),c(i.getCheapestPrice(t)?7:8),l(4),c(t.metadata.zelfPlan==="zelfBasic"?11:t.metadata.zelfPlan==="zelfGold"?12:13),l(5),d("svgIcon","heroicons_solid:check"),l(2),c(t.metadata.zelfPlan==="zelfBasic"?18:t.metadata.zelfPlan==="zelfStartUp"?19:t.metadata.zelfPlan==="zelfBusiness"?20:t.metadata.zelfPlan==="zelfGold"?21:t.metadata.zelfPlan==="zelfEnterprise"?22:23),l(7),d("svgIcon","heroicons_solid:check"),l(2),c(t.metadata.zelfPlan==="zelfBasic"?27:28),l(2),c(t.metadata.zelfPlan!=="zelfBasic"&&t.metadata.zelfPlan!=="zelfStartUp"?29:-1),l(),c(t.metadata.zelfPlan==="zelfEnterprise"?30:-1),l(),c(t.metadata.zelfPlan==="zelfGold"||t.metadata.zelfPlan==="zelfBusiness"||t.metadata.zelfPlan==="zelfEnterprise"?31:-1),l(),c(t.metadata.zelfPlan==="zelfEnterprise"?32:-1)}}function Ft(e,r){if(e&1&&(n(0,"div",12)(1,"div",19)(2,"div",20),T(3,wt,33,16,"fuse-card",21,z().trackByFn,!0),a()()()),e&2){let t=u();l(3),I(t.plans)}}function zt(e,r){e&1&&(n(0,"div",13),o(1,"No subscription plans available."),a())}function Tt(e,r){if(e&1&&(n(0,"form",14),p(1,"input",38),a()),e&2){let t=u();d("formGroup",t.planBillingForm),l(),d("formControlName","plan")}}function It(e,r){e&1&&(n(0,"mat-icon",40),o(1,"refresh"),a(),o(2," Creating Checkout Session... "))}function kt(e,r){e&1&&o(0," Save Changes ")}function Mt(e,r){e&1&&o(0," Subscribe ")}function Nt(e,r){if(e&1){let t=b();n(0,"div",15)(1,"button",39),y("click",function(){S(t);let s=u();return P(s.onSubscribe())}),f(2,It,3,0)(3,kt,1,0)(4,Mt,1,0),a()()}if(e&2){let t,i=u();l(),d("color","primary")("disabled",!((t=i.planBillingForm.get("plan"))!=null&&t.value)||i.subscribing),l(),c(i.subscribing?2:i.hasSubscription?3:4)}}var ee=(()=>{class e{constructor(t,i,s){this._formBuilder=t,this._subscriptionPlansService=i,this._cdr=s,this.plans=[],this.loading=!1,this.subscribing=!1,this.error=null,this.hasSubscription=!1}ngOnInit(){return _(this,null,function*(){this.checkSubscriptionStatus(),this.planBillingForm=this._formBuilder.group({plan:[""],cardHolder:["Brian Hughes"],cardNumber:[""],cardExpiration:[""],cardCVC:[""],country:["usa"],zip:[""]}),yield this.loadSubscriptionPlans()})}loadSubscriptionPlans(){return _(this,null,function*(){this.loading=!0,this.error=null;try{let t=yield this._subscriptionPlansService.getSubscriptionPlans();this.plans=t,t.length>0&&this.planBillingForm.patchValue({plan:t[0].id}),this._cdr.detectChanges()}catch(t){this.error=`Failed to load subscription plans: ${t.message||"Unknown error"}`}finally{this.loading=!1,this._cdr.detectChanges()}})}checkSubscriptionStatus(){try{let t=localStorage.getItem("subscription");this.hasSubscription=t!==null&&t!=="null"&&t!==""}catch{this.hasSubscription=!1}}trackByFn(t,i){return i.id||t}formatPrice(t,i){return new Intl.NumberFormat("en-US",{style:"currency",currency:i.toUpperCase()}).format(t/100)}getCheapestPrice(t){if(!t.prices||t.prices.length===0)return null;let i=t.prices.filter(s=>s.active&&s.unit_amount>0).sort((s,m)=>s.unit_amount-m.unit_amount);return i.length>0?i[0]:null}getPlanDisplayName(t){return{zelfBasic:"BASIC",ZelfGold:"GOLD",zelfBusiness:"BUSINESS",zelfStartUp:"STARTUP",zelfEnterprise:"ENTERPRISE"}[t]||t.toUpperCase()}selectPlan(t){this.planBillingForm.patchValue({plan:t}),this._cdr.detectChanges()}isPlanSelected(t){return this.planBillingForm.get("plan")?.value===t}onSubscribe(){return _(this,null,function*(){let t=this.planBillingForm.get("plan")?.value;if(!t)return;let i=this.plans.find(m=>m.id===t);if(!i)return;let s=this.getCheapestPrice(i);if(s){this.subscribing=!0,this.error=null,this._cdr.detectChanges();try{let m={productId:i.id,priceId:s.id,customerEmail:null},x=yield this._subscriptionPlansService.subscribe(m);if(x&&x.success&&x.url){window.location.href=x.url;return}throw new Error("Failed to create checkout session")}catch(m){this.error=`Failed to create checkout session: ${m.message||"Unknown error"}`}finally{this.subscribing=!1,this._cdr.detectChanges()}}})}static{this.\u0275fac=function(i){return new(i||e)(v(J),v(ot),v(N))}}static{this.\u0275cmp=F({type:e,selectors:[["settings-plan-billing"]],decls:22,vars:6,consts:[[1,"relative","flex","min-w-0","flex-auto","flex-col","overflow-hidden"],[1,"relative","overflow-hidden","px-6","pb-12","pt-8","sm:px-16","sm:pb-24","sm:pt-20"],["viewBox","0 0 960 540","width","100%","height","100%","preserveAspectRatio","xMidYMax slice","xmlns","http://www.w3.org/2000/svg",1,"-z-1","absolute","inset-0"],["fill","none","stroke","currentColor","stroke-width","100",1,"opacity-40","text-gray-200","dark:text-gray-800"],["r","234","cx","196","cy","23"],["r","234","cx","790","cy","491"],[1,"flex","flex-col","items-center"],[1,"text-xl","font-semibold"],[1,"mt-1","text-center","text-4xl","font-extrabold","leading-tight","tracking-tight","sm:text-7xl"],[1,"text-secondary","mt-3","text-center","tracking-tight","sm:text-2xl"],[1,"mt-8","flex","justify-center"],[1,"mt-8"],[1,"mt-10","flex","justify-center","sm:mt-20"],[1,"mt-8","text-center","text-secondary"],[1,"hidden",3,"formGroup"],[1,"mt-8","flex","items-center","justify-center"],[1,"animate-spin"],[1,"ml-2"],[3,"appearance","type"],[1,"w-full","max-w-sm","md:max-w-5xl"],[1,"grid","grid-cols-1","gap-8","md:grid-cols-2"],[1,"relative","flex","flex-col","overflow-hidden","transition-all","duration-300","hover:shadow-xl","cursor-pointer",3,"ngClass"],[1,"relative","flex","flex-col","overflow-hidden","transition-all","duration-300","hover:shadow-xl","cursor-pointer",3,"click","ngClass"],[1,"flex","flex-col","h-full","p-10"],[1,"text-4xl","font-bold","leading-tight","tracking-tight","text-center"],[1,"text-secondary","mt-4","text-center","text-base","leading-relaxed"],[1,"my-6","h-1","w-12","rounded","bg-accent","mx-auto"],[1,"text-6xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8","flex","flex-col"],[1,"font-semibold"],[1,"mt-4","space-y-2"],[1,"flex"],[1,"text-green-600","icon-size-5",3,"svgIcon"],[1,"ml-2","leading-5"],[1,"flex","items-baseline","whitespace-nowrap","justify-center"],[1,"mr-2","text-2xl"],[1,"text-6xl","font-semibold","leading-tight","tracking-tight"],[1,"text-secondary","mt-2","text-center"],["type","hidden",3,"formControlName"],["mat-flat-button","","type","button",1,"px-12","py-3","text-lg","font-semibold","bg-primary","text-white",3,"click","color","disabled"],[1,"animate-spin","mr-2"]],template:function(i,s){i&1&&(n(0,"div",0)(1,"div",1),E(),n(2,"svg",2)(3,"g",3),p(4,"circle",4)(5,"circle",5),a()(),w(),n(6,"div",6)(7,"h2",7),o(8,"SUBSCRIPTION PLANS"),a(),n(9,"div",8),o(10,"Choose your perfect plan"),a(),n(11,"div",9)(12,"div"),o(13,"Upgrade or downgrade your current plan."),a(),n(14,"div"),o(15,"Take control of your productivity."),a()()(),f(16,st,5,0,"div",10)(17,ct,3,3,"div",11)(18,Ft,5,0,"div",12)(19,zt,2,0,"div",13)(20,Tt,2,2,"form",14)(21,Nt,5,3,"div",15),a()()),i&2&&(l(16),c(s.loading?16:-1),l(),c(s.error?17:-1),l(),c(!s.loading&&!s.error&&s.plans.length>0?18:-1),l(),c(!s.loading&&!s.error&&s.plans.length===0?19:-1),l(),c(!s.loading&&!s.error&&s.plans.length>0?20:-1),l(),c(!s.loading&&!s.error&&s.plans.length>0?21:-1))},dependencies:[K,O,H,W,L,Q,Y,Z,tt,nt,et,U,A,G,$,X,it,V,j,D],encapsulation:2,changeDetection:0})}}return e})();export{ee as SettingsPlanBillingComponent};
