import{a as H}from"./chunk-WC6UW6FO.js";import{c as z}from"./chunk-7DGHLOZR.js";import{i as M}from"./chunk-B4I74HQQ.js";import{a as N}from"./chunk-LW2DGXIP.js";import{a as F,d as j}from"./chunk-CWADPOBT.js";import{a as R,b as W}from"./chunk-KBHPG72G.js";import{A as G,b as D,d as w,f as K,g as J,l as V,o as q,q as L,y as U,z as B}from"./chunk-OLKRQMP7.js";import{d as I}from"./chunk-AH65Y7SD.js";import{ea as T,fa as A}from"./chunk-3S5Q73EG.js";import"./chunk-HFS7MMEA.js";import{d as P}from"./chunk-6ZNT62BP.js";import{j as C,q as E}from"./chunk-53Z5H5E5.js";import{Ab as g,Ib as d,Mb as v,Pb as b,Pc as k,Ub as e,Vb as t,Wb as h,ec as f,gb as n,gc as S,hb as m,rc as r,sc as y,tc as x,ub as _}from"./chunk-3HE7R7QB.js";import"./chunk-TSRGIXR5.js";function O(o,p){if(o&1&&(e(0,"div",2)(1,"div",38)(2,"div",39)(3,"div",40)(4,"mat-icon",7),r(5),t()(),e(6,"span",41),r(7),t()()()()),o&2){let a=S();n(),v(a.alertType==="success"?"bg-green-50 border-green-200 text-green-800 dark:bg-green-900/20 dark:border-green-800 dark:text-green-300":"bg-red-50 border-red-200 text-red-800 dark:bg-red-900/20 dark:border-red-800 dark:text-red-300"),n(2),v(a.alertType==="success"?"bg-green-100 text-green-600 dark:bg-green-800 dark:text-green-200":"bg-red-100 text-red-600 dark:bg-red-800 dark:text-red-200"),n(2),y(a.alertType==="success"?"check":"priority_high"),n(2),y(a.alertMessage)}}function Z(o,p){o&1&&(e(0,"span",42),r(1,"Password is required"),t())}function Q(o,p){o&1&&(e(0,"span",42),r(1,"At least 8 characters required"),t())}function X(o,p){o&1&&(e(0,"span",42),r(1,"Passwords do not match"),t())}function Y(o,p){o&1&&h(0,"mat-spinner",43)}function $(o,p){o&1&&(e(0,"span",44),r(1,"No token found"),t())}var fe=(()=>{class o{constructor(a,s,i,l,c,u){this._formBuilder=a,this._httpWrapper=s,this._cdr=i,this._router=l,this._saveConfirmationService=c,this._translocoService=u,this.showAlert=!1,this.alertMessage="",this.alertType="success",this.isLoading=!1,this.isLoadingApiKey=!1,this.apiKey="",this.showApiKey=!1,this.jwtToken="",this.showJwt=!1}ngOnInit(){this.securityForm=this._formBuilder.group({newPassword:["",[w.required,w.minLength(8)]],confirmPassword:["",[w.required]]},{validators:this.passwordMatchValidator}),this.loadJwtToken(),this.loadApiKeyFromStorage()}ngAfterViewInit(){this.loadJwtToken(),this.loadApiKeyFromStorage()}passwordMatchValidator(a){let s=a.get("newPassword"),i=a.get("confirmPassword");return s&&i&&s.value!==i.value?(i.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):(i?.hasError("passwordMismatch")&&i.setErrors(null),null)}loadJwtToken(){this.jwtToken=localStorage.getItem("accessToken")||"",this._cdr.detectChanges()}loadApiKeyFromStorage(){this.apiKey=sessionStorage.getItem("apiKey")||"",this._cdr.detectChanges()}loadApiKey(){let a={operation:"loadApiKey",faceBase64:"",masterPassword:""};this._saveConfirmationService.setSaveData({domain:null,domainConfig:null,redirectUrl:"/settings/security",operation:{title:this._translocoService.translate("saving_operations.load_api_key.title"),description:this._translocoService.translate("saving_operations.load_api_key.description"),action:this._translocoService.translate("saving_operations.load_api_key.action"),itemName:this._translocoService.translate("saving_operations.load_api_key.itemName")},securityData:a}),this._router.navigate(["/save-confirmation"],{queryParams:{redirect:"/settings/security"}})}toggleApiKeyVisibility(){this.showApiKey=!this.showApiKey,this._cdr.detectChanges()}toggleJwtVisibility(){this.showJwt=!this.showJwt,this._cdr.detectChanges()}savePassword(){if(this.securityForm.invalid){this.showError("Please fill in all required fields correctly");return}let a=this.securityForm.value,s={newPassword:a.newPassword,confirmPassword:a.confirmPassword,operation:"changePassword",faceBase64:"",masterPassword:""};this._saveConfirmationService.setSaveData({domain:null,domainConfig:null,redirectUrl:"/settings/security",operation:{title:this._translocoService.translate("saving_operations.password_change.title"),description:this._translocoService.translate("saving_operations.password_change.description"),action:this._translocoService.translate("saving_operations.password_change.action"),itemName:this._translocoService.translate("saving_operations.password_change.itemName")},securityData:s}),this._router.navigate(["/save-confirmation"],{queryParams:{redirect:"/settings/security"}})}cancel(){this.securityForm.reset(),this.showAlert=!1,this._cdr.detectChanges()}showSuccess(a){this.alertMessage=a,this.alertType="success",this.showAlert=!0,setTimeout(()=>{this.showAlert=!1,this._cdr.detectChanges()},5e3),this._cdr.detectChanges()}showError(a){this.alertMessage=a,this.alertType="error",this.showAlert=!0,setTimeout(()=>{this.showAlert=!1,this._cdr.detectChanges()},5e3),this._cdr.detectChanges()}static{this.\u0275fac=function(s){return new(s||o)(m(U),m(N),m(k),m(P),m(H),m(F))}}static{this.\u0275cmp=_({type:o,selectors:[["settings-security"]],decls:73,vars:15,consts:[[1,"flex","flex-col","min-h-screen","bg-gray-50/50","dark:bg-gray-900","w-full"],[1,"flex-auto","px-4","py-8","sm:px-6","sm:py-12","md:px-8","w-full","max-w-4xl","mx-auto"],[1,"mb-6","animate-fade-in"],[1,"bg-white","dark:bg-slate-800","rounded-3xl","shadow-xl","overflow-hidden","mb-8","border","border-gray-100","dark:border-gray-700/50"],[1,"p-8","sm:p-10"],[1,"flex","items-center","gap-3","mb-6"],[1,"w-10","h-10","rounded-full","bg-orange-100","dark:bg-orange-900/30","flex","items-center","justify-center","text-orange-600","dark:text-orange-400"],[1,"icon-size-5"],[1,"text-xl","font-bold","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"mb-8","p-4","bg-orange-50","dark:bg-orange-900/10","border","border-orange-100","dark:border-orange-800/30","rounded-xl","flex","items-start","gap-3"],[1,"icon-size-5","text-orange-500","mt-0.5","shrink-0"],[1,"text-sm","text-orange-800","dark:text-orange-200"],[1,"font-medium","mb-1"],[1,"opacity-90"],[3,"formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"space-y-1.5"],[1,"text-sm","font-semibold","text-gray-700","dark:text-gray-300","ml-1"],[1,"relative"],["type","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"w-full","bg-gray-50","dark:bg-gray-900/50","text-gray-900","dark:text-white","border","border-gray-200","dark:border-gray-700","rounded-xl","px-4","py-3","focus:outline-none","focus:ring-2","focus:ring-gray-900","dark:focus:ring-gray-100","transition-all","font-medium",3,"formControlName"],[1,"h-4","pl-1"],["class","text-xs text-red-500 font-medium",4,"ngIf"],[1,"flex","items-center","justify-end","gap-3","mt-6"],[1,"px-5","py-2.5","bg-white","border","border-gray-200","hover:bg-gray-50","dark:bg-transparent","dark:border-gray-600","dark:text-white","dark:hover:bg-gray-800","text-gray-700","rounded-xl","font-medium","text-sm","transition-all","shadow-sm",3,"click","disabled"],[1,"px-5","py-2.5","bg-gray-900","hover:bg-gray-800","dark:bg-white","dark:hover:bg-gray-200","text-white","dark:text-gray-900","rounded-xl","font-medium","text-sm","transition-all","shadow-lg","shadow-gray-200","dark:shadow-none","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["diameter","20","class","mr-2",4,"ngIf"],[1,"bg-white","dark:bg-slate-800","rounded-3xl","shadow-xl","overflow-hidden","border","border-gray-100","dark:border-gray-700/50"],[1,"w-10","h-10","rounded-full","bg-indigo-100","dark:bg-indigo-900/30","flex","items-center","justify-center","text-indigo-600","dark:text-indigo-400"],[1,"space-y-6"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-xs","font-medium","text-indigo-600","dark:text-indigo-400","hover:text-indigo-800","dark:hover:text-indigo-300","flex","items-center","gap-1",3,"click"],[1,"icon-size-4"],[1,"relative","group"],[1,"w-full","bg-gray-50","dark:bg-gray-900/50","text-gray-600","dark:text-gray-300","border","border-gray-200","dark:border-gray-700","rounded-xl","px-4","py-3","font-mono","text-sm","break-all","transition-all","min-h-[3rem]","flex","items-center"],["class","text-gray-400 italic",4,"ngIf"],[1,"mt-2","text-xs","text-gray-500","dark:text-gray-400","ml-1"],[1,"h-12"],[1,"flex","items-center","justify-between","p-4","rounded-2xl","shadow-sm","border","transaction-all","duration-300"],[1,"flex","items-center","gap-3"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center","shrink-0"],[1,"font-medium","text-sm"],[1,"text-xs","text-red-500","font-medium"],["diameter","20",1,"mr-2"],[1,"text-gray-400","italic"]],template:function(s,i){if(s&1&&(e(0,"div",0)(1,"div",1),g(2,O,8,6,"div",2),e(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"mat-icon",7),r(8,"lock_reset"),t()(),e(9,"div")(10,"h2",8),r(11,"Change Password"),t(),e(12,"p",9),r(13,"Update your account password"),t()()(),e(14,"div",10)(15,"mat-icon",11),r(16,"info"),t(),e(17,"div",12)(18,"p",13),r(19,"Security Policy"),t(),e(20,"p",14),r(21," For your security, you can only change your password once every 24 hours. Use a strong password with at least 8 characters, including numbers and symbols. "),t()()(),e(22,"form",15)(23,"div",16)(24,"div",17)(25,"label",18),r(26,"New Password"),t(),e(27,"div",19),h(28,"input",20),t(),e(29,"div",21),g(30,Z,2,0,"span",22)(31,Q,2,0,"span",22),t()(),e(32,"div",17)(33,"label",18),r(34,"Confirm Password"),t(),e(35,"div",19),h(36,"input",20),t(),e(37,"div",21),g(38,X,2,0,"span",22),t()()(),e(39,"div",23)(40,"button",24),f("click",function(){return i.cancel()}),r(41," Cancel "),t(),e(42,"button",25),f("click",function(){return i.savePassword()}),g(43,Y,1,0,"mat-spinner",26),e(44,"span"),r(45),t()()()()()(),e(46,"div",27)(47,"div",4)(48,"div",5)(49,"div",28)(50,"mat-icon",7),r(51,"api"),t()(),e(52,"div")(53,"h2",8),r(54,"API Access"),t(),e(55,"p",9),r(56,"Manage your authentication tokens"),t()()(),e(57,"div",29)(58,"div")(59,"div",30)(60,"label",18),r(61,"JWT Access Token"),t(),e(62,"button",31),f("click",function(){return i.toggleJwtVisibility()}),e(63,"mat-icon",32),r(64),t(),r(65),t()(),e(66,"div",33)(67,"div",34),r(68),g(69,$,2,0,"span",35),t()(),e(70,"p",36),r(71," Use this token to authenticate your requests to the Zelf API. Do not share this token with anyone. "),t()()()()(),h(72,"div",37),t()()),s&2){let l,c,u;n(2),b(i.showAlert?2:-1),n(20),d("formGroup",i.securityForm),n(6),d("formControlName","newPassword"),n(2),d("ngIf",((l=i.securityForm.get("newPassword"))==null?null:l.hasError("required"))&&((l=i.securityForm.get("newPassword"))==null?null:l.touched)),n(),d("ngIf",((c=i.securityForm.get("newPassword"))==null?null:c.hasError("minlength"))&&((c=i.securityForm.get("newPassword"))==null?null:c.touched)),n(5),d("formControlName","confirmPassword"),n(2),d("ngIf",((u=i.securityForm.get("confirmPassword"))==null?null:u.hasError("passwordMismatch"))&&((u=i.securityForm.get("confirmPassword"))==null?null:u.touched)),n(2),d("disabled",i.isLoading),n(2),d("disabled",i.isLoading||i.securityForm.invalid),n(),d("ngIf",i.isLoading),n(2),y(i.isLoading?"Saving...":"Update Password"),n(19),y(i.showJwt?"visibility_off":"visibility"),n(),x(" ",i.showJwt?"Hide":"Show"," "),n(3),x(" ",i.showJwt?i.jwtToken:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"," "),n(),d("ngIf",!i.jwtToken)}},dependencies:[E,C,B,V,D,K,J,G,q,L,M,A,T,z,I,W,R,j],encapsulation:2,changeDetection:0})}}return o})();export{fe as SettingsSecurityComponent};
