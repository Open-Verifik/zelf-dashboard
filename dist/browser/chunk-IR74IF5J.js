import{a as le}from"./chunk-TJ4OT6D3.js";import{b as se}from"./chunk-NFUOMC3G.js";import"./chunk-IY2LCN2B.js";import"./chunk-HKZCOKJ5.js";import{a as re}from"./chunk-TUSM5AIO.js";import"./chunk-3YT6FQTV.js";import{c as oe}from"./chunk-7DGHLOZR.js";import{i as j}from"./chunk-B4I74HQQ.js";import{a as Y}from"./chunk-LW2DGXIP.js";import{a as x}from"./chunk-E6ENPQNB.js";import{A as ae,b as J,f as K,g as Q,l as X,o as ee,q as te,y as ie,z as ne}from"./chunk-OLKRQMP7.js";import{a as G,d as q}from"./chunk-AH65Y7SD.js";import{aa as R,ea as W,fa as O,m as T}from"./chunk-3S5Q73EG.js";import{c as Z}from"./chunk-YKMDIVBT.js";import"./chunk-HFS7MMEA.js";import{h as A,w as L}from"./chunk-53Z5H5E5.js";import{Ab as g,Dc as V,Ib as c,Mb as N,Ob as F,Pb as d,Pc as H,Sb as B,Tb as k,Ub as i,Vb as n,Wb as p,_b as y,aa as z,ec as S,ga as I,gb as r,gc as m,hb as w,hc as $,ic as P,qa as U,ra as C,rc as a,sa as b,sc as h,ta as M,tc as _,ub as E,uc as D}from"./chunk-3HE7R7QB.js";import{g as f}from"./chunk-TSRGIXR5.js";var me=[[["","fuseCardFront",""]],[["","fuseCardBack",""]],"*",[["","fuseCardExpansion",""]]],ue=["[fuseCardFront]","[fuseCardBack]","*","[fuseCardExpansion]"];function fe(t,s){t&1&&(i(0,"div",0),P(1),n(),i(2,"div",1),P(3,1),n())}function ge(t,s){t&1&&(i(0,"div",2),P(1,3),n()),t&2&&c("@expandCollapse",void 0)}function _e(t,s){if(t&1&&(P(0,2),g(1,ge,2,1,"div",2)),t&2){let e=m();r(),d(e.expanded?1:-1)}}var de=(()=>{class t{constructor(){this.expanded=!1,this.face="front",this.flippable=!1}get classList(){return{"fuse-card-expanded":this.expanded,"fuse-card-face-back":this.flippable&&this.face==="back","fuse-card-face-front":this.flippable&&this.face==="front","fuse-card-flippable":this.flippable}}ngOnChanges(e){"expanded"in e&&(this.expanded=T(e.expanded.currentValue)),"flippable"in e&&(this.flippable=T(e.flippable.currentValue))}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=E({type:t,selectors:[["fuse-card"]],hostVars:2,hostBindings:function(o,l){o&2&&N(l.classList)},inputs:{expanded:"expanded",face:"face",flippable:"flippable"},exportAs:["fuseCard"],features:[U],ngContentSelectors:ue,decls:2,vars:2,consts:[[1,"fuse-card-front"],[1,"fuse-card-back"],[1,"fuse-card-expansion"]],template:function(o,l){o&1&&($(me),g(0,fe,4,0)(1,_e,2,1)),o&2&&(d(l.flippable?0:-1),r(),d(l.flippable?-1:1))},styles:[`fuse-card{position:relative;display:flex;overflow:hidden;--tw-bg-opacity: 1;background-color:rgba(var(--fuse-bg-card-rgb),var(--tw-bg-opacity));border-radius:1rem;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}fuse-card.fuse-card-flippable{border-radius:0;overflow:visible;transform-style:preserve-3d;transition:transform 1s;perspective:600px;background:transparent;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}fuse-card.fuse-card-flippable.fuse-card-face-back .fuse-card-front{visibility:hidden;opacity:0;transform:rotateY(180deg)}fuse-card.fuse-card-flippable.fuse-card-face-back .fuse-card-back{visibility:visible;opacity:1;transform:rotateY(360deg)}fuse-card.fuse-card-flippable .fuse-card-front,fuse-card.fuse-card-flippable .fuse-card-back{display:flex;flex-direction:column;flex:1 1 auto;z-index:10;transition:transform .5s ease-out 0s,visibility 0s ease-in .2s,opacity 0s ease-in .2s;backface-visibility:hidden;--tw-bg-opacity: 1;background-color:rgba(var(--fuse-bg-card-rgb),var(--tw-bg-opacity));border-radius:1rem;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}fuse-card.fuse-card-flippable .fuse-card-front{position:relative;opacity:1;visibility:visible;transform:rotateY(0);overflow:hidden}fuse-card.fuse-card-flippable .fuse-card-back{position:absolute;inset:0;opacity:0;visibility:hidden;transform:rotateY(180deg);overflow:hidden auto}
`],encapsulation:2,data:{animation:Z}})}}return t})();var pe=(()=>{class t{constructor(){this._httpClient=I(L),this._httpWrapper=I(Y)}getSubscriptionPlans(){return f(this,null,function*(){try{let e=new Promise((u,v)=>setTimeout(()=>v(new Error("Request timeout after 10 seconds")),1e4)),o=this._httpWrapper.sendRequest("get",`${x.apiUrl}${x.endpoints.subscriptionPlans.list}`);return(yield Promise.race([o,e])).data||[]}catch(e){throw e}})}getSubscriptionPlan(e){return f(this,null,function*(){try{return(yield this._httpWrapper.sendRequest("get",`${x.apiUrl}${x.endpoints.subscriptionPlans.getById}/${e}`)).data}catch(o){throw o}})}subscribe(e){return f(this,null,function*(){try{let o=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}${x.endpoints.subscriptionPlans.subscribe}`,e);return o.data?o.data:o}catch(o){throw o}})}getMySubscription(){return f(this,null,function*(){try{return(yield this._httpWrapper.sendRequest("get",`${x.apiUrl}${x.endpoints.subscriptionPlans.mySubscription}`)).data}catch(e){throw e}})}createStripePortalSession(){return f(this,null,function*(){try{let e=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}${x.endpoints.subscriptionPlans.createPortalSession}`);return e.data||e}catch(e){throw e}})}cancelSubscription(e){return f(this,null,function*(){try{let o=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}${x.endpoints.subscriptionPlans.cancelSubscription}`,{subscriptionId:e});return o.data||o}catch(o){throw o}})}upgradeSubscription(e,o){return f(this,null,function*(){try{let l=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}${x.endpoints.subscriptionPlans.upgradeSubscription}`,{subscriptionId:e,newPriceId:o});return l.data||l}catch(l){throw l}})}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var he=(t,s)=>s.id,ve=(t,s)=>({"ring-4 ring-primary":t,"hover:ring-2 hover:ring-primary/50":s});function Ce(t,s){t&1&&a(0," Your Active Plan ")}function be(t,s){t&1&&a(0," Choose your perfect plan ")}function Se(t,s){t&1&&(i(0,"div"),a(1,"Manage your subscription and billing."),n(),i(2,"div"),a(3,"Take control of your productivity."),n())}function ye(t,s){t&1&&(i(0,"div"),a(1,"Upgrade or downgrade your current plan."),n(),i(2,"div"),a(3,"Take control of your productivity."),n())}function Pe(t,s){if(t&1&&(i(0,"div",6)(1,"h2",11),a(2,"SUBSCRIPTION MANAGEMENT"),n(),i(3,"div",12),g(4,Ce,1,0)(5,be,1,0),n(),i(6,"div",13),g(7,Se,4,0)(8,ye,4,0),n()()),t&2){let e=m();r(4),d(e.hasSubscription?4:5),r(3),d(e.hasSubscription?7:8)}}function we(t,s){t&1&&(i(0,"div",7)(1,"div",14)(2,"mat-icon",15),a(3,"refresh"),n(),i(4,"div",11),a(5,"Loading subscription details..."),n(),i(6,"div",16),a(7,"Please wait while we fetch your plan information"),n()()())}function Ee(t,s){if(t&1&&(i(0,"div",8)(1,"fuse-alert",17),a(2),n()()),t&2){let e=m();r(),c("appearance","outline")("type","error"),r(),_(" ",e.error," ")}}function Be(t,s){t&1&&(i(0,"div",42),p(1,"mat-icon",43),i(2,"span",44)(3,"b"),a(4,"50"),n(),a(5," active users"),n()(),i(6,"div",42),p(7,"mat-icon",43),i(8,"span",44)(9,"b"),a(10,"50"),n(),a(11," encryptions/month"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"))}function ke(t,s){t&1&&(i(0,"div",42),p(1,"mat-icon",43),i(2,"span",44)(3,"b"),a(4,"500"),n(),a(5," active users"),n()(),i(6,"div",42),p(7,"mat-icon",43),i(8,"span",44)(9,"b"),a(10,"Unlimited"),n(),a(11," encryptions"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"))}function Ie(t,s){t&1&&(i(0,"div",42),p(1,"mat-icon",43),i(2,"span",44)(3,"b"),a(4,"1,250"),n(),a(5," active users"),n()(),i(6,"div",42),p(7,"mat-icon",43),i(8,"span",44)(9,"b"),a(10,"Unlimited"),n(),a(11," encryptions"),n()(),i(12,"div",42),p(13,"mat-icon",43),i(14,"span",44),a(15,"Priority support"),n()(),i(16,"div",42),p(17,"mat-icon",43),i(18,"span",44),a(19,"Advanced analytics"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"),r(4),c("svgIcon","heroicons_solid:check"))}function Fe(t,s){t&1&&(i(0,"div",42),p(1,"mat-icon",43),i(2,"span",44)(3,"b"),a(4,"3,000"),n(),a(5," active users"),n()(),i(6,"div",42),p(7,"mat-icon",43),i(8,"span",44)(9,"b"),a(10,"Unlimited"),n(),a(11," encryptions"),n()(),i(12,"div",42),p(13,"mat-icon",43),i(14,"span",44),a(15,"Priority support"),n()(),i(16,"div",42),p(17,"mat-icon",43),i(18,"span",44),a(19,"Advanced analytics"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"),r(4),c("svgIcon","heroicons_solid:check"))}function Te(t,s){t&1&&(i(0,"div",42),p(1,"mat-icon",43),i(2,"span",44)(3,"b"),a(4,"10,000"),n(),a(5," active users"),n()(),i(6,"div",42),p(7,"mat-icon",43),i(8,"span",44)(9,"b"),a(10,"Unlimited"),n(),a(11," encryptions"),n()(),i(12,"div",42),p(13,"mat-icon",43),i(14,"span",44)(15,"b"),a(16,"Dedicated"),n(),a(17," infrastructure"),n()(),i(18,"div",42),p(19,"mat-icon",43),i(20,"span",44),a(21,"24/7 support"),n()(),i(22,"div",42),p(23,"mat-icon",43),i(24,"span",44),a(25,"Advanced analytics"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"),r(6),c("svgIcon","heroicons_solid:check"),r(4),c("svgIcon","heroicons_solid:check"))}function ze(t,s){if(t&1&&(i(0,"div",52)(1,"div",23),a(2),n(),i(3,"div",54),a(4),n()()),t&2){let e=m().$implicit,o=m(3);r(2),_(" ",o.formatPrice(o.getCheapestPrice(e).unit_amount,o.getCheapestPrice(e).currency)," "),r(2),_(" ",o.getCheapestPrice(e).recurring.interval," billing ")}}function Ue(t,s){if(t&1){let e=y();i(0,"fuse-card",48),S("click",function(){let l=C(e).$implicit,u=m(3);return b(u.showUpgradeComparison(l))}),i(1,"div",49)(2,"div",14)(3,"h4",50),a(4),n(),i(5,"p",51),a(6),n(),g(7,ze,5,2,"div",52),i(8,"div",52)(9,"button",53),S("click",function(){let l=C(e).$implicit,u=m(3);return b(u.upgradeToPlan(l))}),a(10),n()()()()()}if(t&2){let e=s.$implicit,o=m(3);r(4),h(o.getPlanDisplayName(e.metadata.zelfPlan)),r(2),h(e.description),r(),d(o.getCheapestPrice(e)?7:-1),r(2),c("color","primary"),r(),_(" Upgrade to ",o.getPlanDisplayName(e.metadata.zelfPlan)," ")}}function Me(t,s){if(t&1&&(i(0,"div",8)(1,"h3",45),a(2,"Available Upgrades"),n(),i(3,"div",46),B(4,Ue,11,5,"fuse-card",47,F().trackByFn,!0),n()()),t&2){let e=m(2);r(4),k(e.getUpgradePlans())}}function Ne(t,s){if(t&1&&(i(0,"div",57)(1,"div",58)(2,"div",59),a(3),n(),i(4,"div",60),a(5),n(),i(6,"div",60),a(7),n()(),i(8,"div",25)(9,"div",61),a(10),n(),i(11,"span",62),a(12),n()()()),t&2){let e=s.$implicit,o=m(4);r(3),h(e.description),r(2),_("Invoice ID: ",e.id,""),r(2),_(" ",o.formatDate(e.date)," "),r(3),_(" ",o.formatPrice(e.amount,e.currency)," "),r(),c("ngClass",o.getStatusBadgeColor(e.status)),r(),_(" ",e.status.toUpperCase()," ")}}function $e(t,s){if(t&1&&(i(0,"div",55),B(1,Ne,13,6,"div",57,he),n()),t&2){let e=m(3);r(),k(e.billingHistory)}}function De(t,s){t&1&&(i(0,"div",56)(1,"mat-icon",63),a(2,"receipt_long"),n(),i(3,"p"),a(4,"No billing history available"),n()())}function Ve(t,s){if(t&1&&(i(0,"div",8)(1,"h3",45),a(2,"Billing History"),n(),i(3,"fuse-card")(4,"div",49),g(5,$e,3,0,"div",55)(6,De,5,0,"div",56),n()()()),t&2){let e=m(2);r(5),d(e.billingHistory.length>0?5:6)}}function He(t,s){if(t&1){let e=y();i(0,"div",7)(1,"div",18)(2,"fuse-card",19)(3,"div",20)(4,"div",21)(5,"div")(6,"div",22)(7,"h3",23),a(8),n(),i(9,"span",24),a(10),n()(),i(11,"p",16),a(12),n()(),i(13,"div",25)(14,"div",26),a(15),n(),i(16,"div",27),a(17),n()()()(),i(18,"div",28)(19,"div",29)(20,"h4",30),a(21,"Plan Features"),n(),i(22,"div",31),g(23,Be,12,2)(24,ke,12,2)(25,Ie,20,4)(26,Fe,20,4)(27,Te,26,5),n()(),i(28,"div",8)(29,"div",32)(30,"button",33),S("click",function(){C(e);let l=m();return b(l.openStripePortal())}),i(31,"mat-icon",34),a(32,"payment"),n(),a(33," Manage Billing "),n()()()()(),i(34,"fuse-card",35)(35,"div",28)(36,"h4",36),a(37,"Billing Information"),n(),i(38,"div",37)(39,"div",38)(40,"div",39),a(41,"Subscription ID"),n(),i(42,"div",40),a(43),n()(),i(44,"div",38)(45,"div",39),a(46,"Current Period"),n(),i(47,"div",41),a(48),n()(),i(49,"div",38)(50,"div",39),a(51,"Next Billing"),n(),i(52,"div",41),a(53),n()()()()(),g(54,Me,6,0,"div",8)(55,Ve,7,1,"div",8),n()()}if(t&2){let e=m();r(8),h(e.getCurrentPlan().name),r(),c("ngClass",e.getStatusBadgeColor(e.getCurrentSubscription().status)),r(),_(" ",e.getCurrentSubscription().status.toUpperCase()," "),r(2),h(e.getCurrentPlan().description),r(3),_(" ",e.formatPrice(e.getCurrentSubscription().plan.amount,e.getCurrentSubscription().plan.currency)," "),r(2),_("",e.getCurrentSubscription().plan.interval," billing"),r(6),d(e.getCurrentPlan().metadata.zelfPlan==="zelfBasic"?23:e.getCurrentPlan().metadata.zelfPlan==="zelfStartUp"?24:e.getCurrentPlan().metadata.zelfPlan==="zelfBusiness"?25:e.getCurrentPlan().metadata.zelfPlan==="zelfGold"?26:e.getCurrentPlan().metadata.zelfPlan==="zelfEnterprise"?27:-1),r(7),c("color","accent"),r(13),h(e.getCurrentSubscription().id),r(5),D(" ",e.formatDate(e.getCurrentSubscription().current_period_start)," - ",e.formatDate(e.getCurrentSubscription().current_period_end)," "),r(5),h(e.formatDate(e.getCurrentSubscription().current_period_end)),r(),d(e.showPlanComparison&&e.getUpgradePlans().length>0?54:-1),r(),d(e.billingHistory&&e.billingHistory.length>0?55:-1)}}function Ae(t,s){if(t&1&&(i(0,"div",79)(1,"div",80),a(2),n(),i(3,"div",81),a(4),n()(),i(5,"div",82)(6,"div"),a(7),n()()),t&2){let e=m().$implicit,o=m(2);r(2),h(o.getCheapestPrice(e).currency.toUpperCase()),r(2),_(" ",o.formatPrice(o.getCheapestPrice(e).unit_amount,o.getCheapestPrice(e).currency)," "),r(3),_("",o.getCheapestPrice(e).recurring.interval," billing")}}function Le(t,s){t&1&&(i(0,"div",74),a(1,"Contact"),n())}function Re(t,s){t&1&&a(0," Core features, including: ")}function je(t,s){t&1&&a(0," Personal features, plus: ")}function Ge(t,s){t&1&&a(0," Premium features, plus: ")}function qe(t,s){t&1&&(i(0,"b"),a(1,"50"),n(),a(2," active users "))}function We(t,s){t&1&&(i(0,"b"),a(1,"500"),n(),a(2," active users "))}function Oe(t,s){t&1&&(i(0,"b"),a(1,"1,250"),n(),a(2," active users "))}function Ye(t,s){t&1&&(i(0,"b"),a(1,"3,000"),n(),a(2," active users "))}function Ze(t,s){t&1&&(i(0,"b"),a(1,"10,000"),n(),a(2," active users "))}function Je(t,s){t&1&&(i(0,"b"),a(1,"Unlimited"),n(),a(2," active users "))}function Ke(t,s){t&1&&(i(0,"b"),a(1,"50"),n(),a(2," encryptions/month "))}function Qe(t,s){t&1&&(i(0,"b"),a(1,"Unlimited"),n(),a(2," encryptions "))}function Xe(t,s){t&1&&(i(0,"div",77),p(1,"mat-icon",43),i(2,"div",78),a(3,"Priority support"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"))}function et(t,s){t&1&&(i(0,"div",77),p(1,"mat-icon",43),i(2,"div",78)(3,"b"),a(4,"Dedicated"),n(),a(5," infrastructure"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"))}function tt(t,s){t&1&&(i(0,"div",77),p(1,"mat-icon",43),i(2,"div",78),a(3,"Advanced analytics"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"))}function it(t,s){t&1&&(i(0,"div",77),p(1,"mat-icon",43),i(2,"div",78),a(3,"24/7 support"),n()()),t&2&&(r(),c("svgIcon","heroicons_solid:check"))}function nt(t,s){if(t&1){let e=y();i(0,"fuse-card",69),S("click",function(){let l=C(e).$implicit,u=m(2);return b(u.selectPlan(l.id))}),i(1,"div",70)(2,"div",71),a(3),n(),i(4,"div",72),a(5),n(),p(6,"div",73),g(7,Ae,8,3)(8,Le,2,0,"div",74),i(9,"div",75)(10,"div",59),g(11,Re,1,0)(12,je,1,0)(13,Ge,1,0),n(),i(14,"div",76)(15,"div",77),p(16,"mat-icon",43),i(17,"div",78),g(18,qe,3,0)(19,We,3,0)(20,Oe,3,0)(21,Ye,3,0)(22,Ze,3,0)(23,Je,3,0),n()(),i(24,"div",77),p(25,"mat-icon",43),i(26,"div",78),g(27,Ke,3,0)(28,Qe,3,0),n()(),g(29,Xe,4,1,"div",77)(30,et,6,1,"div",77)(31,tt,4,1,"div",77)(32,it,4,1,"div",77),n()()()()}if(t&2){let e=s.$implicit,o=m(2);c("ngClass",V(13,ve,o.isPlanSelected(e.id),!o.isPlanSelected(e.id))),r(3),_(" ",o.getPlanDisplayName(e.metadata.zelfPlan)," "),r(2),_(" ",e.description||e.name," "),r(2),d(o.getCheapestPrice(e)?7:8),r(4),d(e.metadata.zelfPlan==="zelfBasic"?11:e.metadata.zelfPlan==="zelfGold"?12:13),r(5),c("svgIcon","heroicons_solid:check"),r(2),d(e.metadata.zelfPlan==="zelfBasic"?18:e.metadata.zelfPlan==="zelfStartUp"?19:e.metadata.zelfPlan==="zelfBusiness"?20:e.metadata.zelfPlan==="zelfGold"?21:e.metadata.zelfPlan==="zelfEnterprise"?22:23),r(7),c("svgIcon","heroicons_solid:check"),r(2),d(e.metadata.zelfPlan==="zelfBasic"?27:28),r(2),d(e.metadata.zelfPlan!=="zelfBasic"&&e.metadata.zelfPlan!=="zelfStartUp"?29:-1),r(),d(e.metadata.zelfPlan==="zelfEnterprise"?30:-1),r(),d(e.metadata.zelfPlan==="zelfGold"||e.metadata.zelfPlan==="zelfBusiness"||e.metadata.zelfPlan==="zelfEnterprise"?31:-1),r(),d(e.metadata.zelfPlan==="zelfEnterprise"?32:-1)}}function at(t,s){t&1&&(i(0,"mat-icon",83),a(1,"refresh"),n(),a(2," Creating Checkout Session... "))}function ot(t,s){t&1&&a(0," Subscribe ")}function rt(t,s){if(t&1){let e=y();i(0,"div",7)(1,"div",64)(2,"div",65),B(3,nt,33,16,"fuse-card",66,F().trackByFn,!0),n()()(),i(5,"div",67)(6,"button",68),S("click",function(){C(e);let l=m();return b(l.onSubscribe())}),g(7,at,3,0)(8,ot,1,0),n()()}if(t&2){let e,o=m();r(3),k(o.plans),r(3),c("color","primary")("disabled",!((e=o.planBillingForm.get("plan"))!=null&&e.value)||o.subscribing),r(),d(o.subscribing?7:8)}}function lt(t,s){t&1&&(i(0,"div",9),a(1,"No subscription plans available."),n())}function st(t,s){if(t&1&&(i(0,"form",10),p(1,"input",84),n()),t&2){let e=m();c("formGroup",e.planBillingForm),r(),c("formControlName","plan")}}var $t=(()=>{class t{constructor(e,o,l){this._formBuilder=e,this._subscriptionPlansService=o,this._cdr=l,this.plans=[],this.loading=!1,this.subscribing=!1,this.error=null,this.hasSubscription=!1,this.mySubscription=null,this.showPlanComparison=!1,this.selectedUpgradePlan=null,this.showBillingHistory=!1,this.billingHistory=[],this.initialLoading=!0}ngOnInit(){return f(this,null,function*(){this.checkSubscriptionStatus(),this.planBillingForm=this._formBuilder.group({plan:[""],cardHolder:["Brian Hughes"],cardNumber:[""],cardExpiration:[""],cardCVC:[""],country:["usa"],zip:[""]});try{yield this.loadMyPlan(),yield this.loadSubscriptionPlans()}finally{this.initialLoading=!1,this._cdr.detectChanges()}})}loadMyPlan(){return f(this,null,function*(){try{this.mySubscription=yield this._subscriptionPlansService.getMySubscription(),this.hasSubscription=this.mySubscription&&this.mySubscription.subscription&&this.mySubscription.subscription.status==="active",this._cdr.detectChanges()}catch(e){console.error("Failed to load subscription:",e),this.hasSubscription=!1}})}loadSubscriptionPlans(){return f(this,null,function*(){this.loading=!0,this.error=null;try{let e=yield this._subscriptionPlansService.getSubscriptionPlans();this.plans=e,e.length>0&&this.planBillingForm.patchValue({plan:e[0].id}),this._cdr.detectChanges()}catch(e){this.error=`Failed to load subscription plans: ${e.message||"Unknown error"}`}finally{this.loading=!1,this._cdr.detectChanges()}})}checkSubscriptionStatus(){try{let e=localStorage.getItem("subscription");this.hasSubscription=e!==null&&e!=="null"&&e!==""}catch{this.hasSubscription=!1}}trackByFn(e,o){return o.id||e}formatPrice(e,o){return new Intl.NumberFormat("en-US",{style:"currency",currency:o.toUpperCase()}).format(e/100)}getCheapestPrice(e){if(!e.prices||e.prices.length===0)return null;let o=e.prices.filter(l=>l.active&&l.unit_amount>0).sort((l,u)=>l.unit_amount-u.unit_amount);return o.length>0?o[0]:null}getPlanDisplayName(e){return{zelfBasic:"BASIC",ZelfGold:"GOLD",zelfBusiness:"BUSINESS",zelfStartUp:"STARTUP",zelfEnterprise:"ENTERPRISE"}[e]||e.toUpperCase()}selectPlan(e){this.planBillingForm.patchValue({plan:e}),this._cdr.detectChanges()}isPlanSelected(e){return this.planBillingForm.get("plan")?.value===e}onSubscribe(){return f(this,null,function*(){let e=this.planBillingForm.get("plan")?.value;if(!e)return;let o=this.plans.find(u=>u.id===e);if(!o)return;let l=this.getCheapestPrice(o);if(l){this.subscribing=!0,this.error=null,this._cdr.detectChanges();try{let u={productId:o.id,priceId:l.id,customerEmail:null},v=yield this._subscriptionPlansService.subscribe(u);if(v&&v.success&&v.url){window.location.href=v.url;return}throw new Error("Failed to create checkout session")}catch(u){this.error=`Failed to create checkout session: ${u.message||"Unknown error"}`}finally{this.subscribing=!1,this._cdr.detectChanges()}}})}getCurrentPlan(){return!this.mySubscription||!this.mySubscription.product?null:this.mySubscription.product}getCurrentSubscription(){return!this.mySubscription||!this.mySubscription.subscription?null:this.mySubscription.subscription}formatDate(e){return new Date(e*1e3).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}getStatusColor(e){switch(e){case"active":return"text-green-600";case"canceled":return"text-red-600";case"past_due":return"text-yellow-600";case"unpaid":return"text-red-600";default:return"text-gray-600"}}getStatusBadgeColor(e){switch(e){case"active":return"bg-green-100 text-green-800";case"canceled":return"bg-red-100 text-red-800";case"past_due":return"bg-yellow-100 text-yellow-800";case"unpaid":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}showUpgradeComparison(e){this.selectedUpgradePlan=e,this.showPlanComparison=!0,this._cdr.detectChanges()}hidePlanComparison(){this.showPlanComparison=!1,this.selectedUpgradePlan=null,this._cdr.detectChanges()}getUpgradePlans(){if(!this.mySubscription||!this.mySubscription.subscription)return this.plans;let e=this.mySubscription.subscription.plan.amount;return this.plans.filter(o=>{let l=this.getCheapestPrice(o);return l&&l.unit_amount>e})}openStripePortal(){return f(this,null,function*(){try{let e=yield this._subscriptionPlansService.createStripePortalSession();if(e&&e.success&&e.url){window.location.href=e.url;return}throw new Error("Failed to create portal session")}catch(e){this.error=`Failed to open billing portal: ${e.message||"Unknown error"}`,this._cdr.detectChanges()}})}cancelSubscription(){return f(this,null,function*(){if(confirm("Are you sure you want to cancel your subscription? This action cannot be undone."))try{let e=this.getCurrentSubscription();if(!e)throw new Error("No active subscription found");let o=yield this._subscriptionPlansService.cancelSubscription(e.id);if(o&&o.success)yield this.loadMyPlan(),alert("Subscription cancelled successfully.");else throw new Error(o?.message||"Failed to cancel subscription")}catch(e){this.error=`Failed to cancel subscription: ${e.message||"Unknown error"}`,this._cdr.detectChanges()}})}upgradeToPlan(e){return f(this,null,function*(){try{let o=this.getCurrentSubscription();if(!o)throw new Error("No active subscription found");let l=this.getCheapestPrice(e);if(!l)throw new Error("No valid price found for this plan");let u=yield this._subscriptionPlansService.upgradeSubscription(o.id,l.id);if(u&&u.success&&u.url){window.location.href=u.url;return}throw new Error("Failed to create upgrade session")}catch(o){this.error=`Failed to upgrade plan: ${o.message||"Unknown error"}`,this._cdr.detectChanges()}})}toggleBillingHistory(){this.showBillingHistory=!this.showBillingHistory,this.showBillingHistory&&this.billingHistory.length===0&&this.loadBillingHistory(),this._cdr.detectChanges()}loadBillingHistory(){return f(this,null,function*(){try{this.billingHistory=[{id:"in_1SIBhPFO6i3ofqGHMzmmHGNA",amount:99900,currency:"usd",status:"paid",date:1760461667,description:"Zelf Business - Monthly subscription"}],this._cdr.detectChanges()}catch(e){console.error("Failed to load billing history:",e)}})}getPlanUsage(){if(!this.mySubscription||!this.mySubscription.domainConfig)return null;let e=this.mySubscription.domainConfig;return{activeUsers:this.getActiveUserLimit(),encryptions:this.getEncryptionLimit(),storage:e.storage||{},features:e.features||[]}}getActiveUserLimit(){let e=this.getCurrentPlan();if(!e)return 0;switch(e.metadata.zelfPlan){case"zelfBasic":return 50;case"zelfStartUp":return 500;case"zelfBusiness":return 1250;case"zelfGold":return 3e3;case"zelfEnterprise":return 1e4;default:return 0}}getEncryptionLimit(){let e=this.getCurrentPlan();return e?e.metadata.zelfPlan==="zelfBasic"?50:"Unlimited":0}static{this.\u0275fac=function(o){return new(o||t)(w(ie),w(pe),w(H))}}static{this.\u0275cmp=E({type:t,selectors:[["settings-plan-billing"]],decls:13,vars:7,consts:[[1,"relative","flex","min-w-0","flex-auto","flex-col","overflow-hidden"],[1,"relative","overflow-hidden","px-2","pb-6","pt-4","sm:px-8","sm:pb-12","sm:pt-10"],["viewBox","0 0 960 540","width","100%","height","100%","preserveAspectRatio","xMidYMax slice","xmlns","http://www.w3.org/2000/svg",1,"-z-1","absolute","inset-0"],["fill","none","stroke","currentColor","stroke-width","100",1,"opacity-40","text-gray-200","dark:text-gray-800"],["r","234","cx","196","cy","23"],["r","234","cx","790","cy","491"],[1,"flex","flex-col","items-center"],[1,"mt-10","flex","justify-center","sm:mt-20"],[1,"mt-8"],[1,"mt-8","text-center","text-secondary"],[1,"hidden",3,"formGroup"],[1,"text-xl","font-semibold"],[1,"mt-1","text-center","text-4xl","font-extrabold","leading-tight","tracking-tight","sm:text-7xl"],[1,"text-secondary","mt-3","text-center","tracking-tight","sm:text-2xl"],[1,"text-center"],[1,"animate-spin","text-6xl","text-primary","mb-4"],[1,"text-secondary","mt-2"],[3,"appearance","type"],[1,"w-full","max-w-4xl"],[1,"relative","overflow-hidden"],[1,"bg-gradient-to-r","from-primary/10","to-accent/10","p-8"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"text-3xl","font-bold"],[1,"px-3","py-1","rounded-full","text-sm","font-medium",3,"ngClass"],[1,"text-right"],[1,"text-4xl","font-bold"],[1,"text-secondary"],[1,"p-8"],[1,"mb-8"],[1,"text-lg","font-semibold","mb-4"],[1,"space-y-3"],[1,"flex","flex-col","sm:flex-row","gap-3","mb-4"],["mat-flat-button","",1,"flex-1","px-6","py-3","text-base","font-medium",3,"click","color"],[1,"mr-2"],[1,"mt-6"],[1,"text-lg","font-semibold","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-sm","text-secondary","mb-2"],[1,"font-mono","text-sm","break-all"],[1,"text-sm"],[1,"flex","items-center"],[1,"text-green-600","icon-size-5",3,"svgIcon"],[1,"ml-2"],[1,"text-2xl","font-bold","text-center","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"relative","overflow-hidden","transition-all","duration-300","hover:shadow-lg","cursor-pointer","border-2","border-primary/20","hover:border-primary/50"],[1,"relative","overflow-hidden","transition-all","duration-300","hover:shadow-lg","cursor-pointer","border-2","border-primary/20","hover:border-primary/50",3,"click"],[1,"p-6"],[1,"text-xl","font-bold"],[1,"text-secondary","text-sm","mt-2"],[1,"mt-4"],["mat-flat-button","",1,"w-full",3,"click","color"],[1,"text-secondary","text-sm"],[1,"space-y-4"],[1,"text-center","text-secondary","py-8"],[1,"flex","items-center","justify-between","p-4","border","rounded-lg"],[1,"flex-1"],[1,"font-semibold"],[1,"text-sm","text-secondary"],[1,"font-bold","text-lg"],[1,"px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-6xl","mb-4"],[1,"w-full","max-w-sm","md:max-w-5xl"],[1,"grid","grid-cols-1","gap-8","md:grid-cols-2"],[1,"relative","flex","flex-col","overflow-hidden","transition-all","duration-300","hover:shadow-xl","cursor-pointer",3,"ngClass"],[1,"mt-8","flex","items-center","justify-center"],["mat-flat-button","","type","button",1,"px-12","py-3","text-lg","font-semibold","bg-primary","text-white",3,"click","color","disabled"],[1,"relative","flex","flex-col","overflow-hidden","transition-all","duration-300","hover:shadow-xl","cursor-pointer",3,"click","ngClass"],[1,"flex","flex-col","h-full","p-10"],[1,"text-4xl","font-bold","leading-tight","tracking-tight","text-center"],[1,"text-secondary","mt-4","text-center","text-base","leading-relaxed"],[1,"my-6","h-1","w-12","rounded","bg-accent","mx-auto"],[1,"text-6xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8","flex","flex-col"],[1,"mt-4","space-y-2"],[1,"flex"],[1,"ml-2","leading-5"],[1,"flex","items-baseline","whitespace-nowrap","justify-center"],[1,"mr-2","text-2xl"],[1,"text-6xl","font-semibold","leading-tight","tracking-tight"],[1,"text-secondary","mt-2","text-center"],[1,"animate-spin","mr-2"],["type","hidden",3,"formControlName"]],template:function(o,l){o&1&&(i(0,"div",0)(1,"div",1),M(),i(2,"svg",2)(3,"g",3),p(4,"circle",4)(5,"circle",5),n()(),g(6,Pe,9,2,"div",6)(7,we,8,0,"div",7)(8,Ee,3,3,"div",8)(9,He,56,14,"div",7)(10,rt,9,3)(11,lt,2,0,"div",9)(12,st,2,2,"form",10),n()()),o&2&&(r(6),d(l.initialLoading?-1:6),r(),d(l.initialLoading?7:-1),r(),d(l.error?8:-1),r(),d(!l.initialLoading&&!l.error&&l.hasSubscription&&l.getCurrentPlan()?9:-1),r(),d(!l.initialLoading&&!l.error&&!l.hasSubscription&&l.plans.length>0?10:-1),r(),d(!l.initialLoading&&!l.error&&l.plans.length===0?11:-1),r(),d(!l.initialLoading&&!l.error&&l.plans.length>0?12:-1))},dependencies:[ne,X,J,K,Q,ae,ee,te,re,de,le,A,O,W,j,oe,se,R,q,G],encapsulation:2,changeDetection:0})}}return t})();export{$t as SettingsPlanBillingComponent};
