var f=class a{constructor(e){this.domain=e.domain||"",this.domainConfig=this.buildDomainConfig(e.domainConfig),this.faceBase64=e.faceBase64,this.masterPassword=e.masterPassword,this.ipfsHash=e.ipfsHash,this.createdAt=e.createdAt,this.updatedAt=e.updatedAt,this.ipfs=e.ipfs,this.zelfProof=e.zelfProof,this.expiresAt=e.expiresAt,this.subscriptionId=e.subscriptionId,this.previousDomain=e.previousDomain,this.type=e.type}buildDomainConfig(e){let t=e?.domainConfig||e;return{name:t?.name||"",type:t?.type||"custom",holdSuffix:t?.holdSuffix||".hold",status:t?.status||"inactive",owner:t?.owner||"",description:t?.description||"",startDate:t?.startDate||"",endDate:t?.endDate||"",tags:{minLength:t?.tags?.minLength||3,maxLength:t?.tags?.maxLength||50,allowedChars:t?.tags?.allowedChars||/^[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]$/,reserved:t?.tags?.reserved||["www","api","admin","support","help"],customRules:t?.tags?.customRules||[],payment:{methods:t?.tags?.payment?.methods||["coinbase","crypto","stripe"],currencies:t?.tags?.payment?.currencies||["USD","BTC","ETH","SOL"],discounts:t?.tags?.payment?.discounts||{yearly:.1,lifetime:.2},rewardPrice:t?.tags?.payment?.rewardPrice||10,whitelist:t?.tags?.payment?.whitelist||{},pricingTable:t?.tags?.payment?.pricingTable||this.getDefaultPricingTable()},storage:{keyPrefix:t?.tags?.storage?.keyPrefix||"tagName",ipfsEnabled:t?.tags?.storage?.ipfsEnabled||!0,arweaveEnabled:t?.tags?.storage?.arweaveEnabled||!0,walrusEnabled:t?.tags?.storage?.walrusEnabled||!0,backupEnabled:t?.tags?.storage?.backupEnabled||!1}},zelfkeys:{plans:t?.zelfkeys?.plans||[],payment:{whitelist:t?.zelfkeys?.payment?.whitelist||{},pricingTable:t?.zelfkeys?.payment?.pricingTable||{}},storage:{keyPrefix:t?.zelfkeys?.storage?.keyPrefix||"tagName",ipfsEnabled:t?.zelfkeys?.storage?.ipfsEnabled||!0,arweaveEnabled:t?.zelfkeys?.storage?.arweaveEnabled||!0,walrusEnabled:t?.zelfkeys?.storage?.walrusEnabled||!0,backupEnabled:t?.zelfkeys?.storage?.backupEnabled||!1}},stripe:{productId:t?.stripe?.productId||"",priceId:t?.stripe?.priceId||"",latestInvoiceId:t?.stripe?.latestInvoiceId||"",amountPaid:t?.stripe?.amountPaid||0,paidAt:t?.stripe?.paidAt||""},limits:{tags:t?.limits?.tags||100,zelfkeys:t?.limits?.zelfkeys||100,zelfProofs:t?.limits?.zelfProofs||100},metadata:{launchDate:t?.metadata?.launchDate||new Date().toISOString().split("T")[0],version:t?.metadata?.version||"1.0.0",documentation:t?.metadata?.documentation||"",community:t?.metadata?.community,enterprise:t?.metadata?.enterprise,support:t?.metadata?.support||"standard"}}}getDefaultPricingTable(){return{1:{1:240,2:432,3:612,4:768,5:900,lifetime:3600},2:{1:120,2:216,3:306,4:384,5:450,lifetime:1800},3:{1:72,2:130,3:184,4:230,5:270,lifetime:1080},4:{1:36,2:65,3:92,4:115,5:135,lifetime:540},5:{1:30,2:54,3:76,4:96,5:112,lifetime:450},"6-15":{1:24,2:43,3:61,4:77,5:90,lifetime:360},16:{1:23,2:41,3:59,4:74,5:86,lifetime:345},17:{1:22,2:40,3:56,4:70,5:82,lifetime:330},18:{1:21,2:38,3:54,4:67,5:79,lifetime:315},19:{1:20,2:36,3:51,4:64,5:75,lifetime:300},20:{1:19,2:34,3:48,4:61,5:72,lifetime:285},21:{1:18,2:32,3:46,4:58,5:68,lifetime:270},22:{1:17,2:31,3:43,4:54,5:64,lifetime:255},23:{1:16,2:29,3:41,4:51,5:60,lifetime:240},24:{1:15,2:27,3:38,4:48,5:56,lifetime:225},25:{1:14,2:25,3:36,4:45,5:53,lifetime:210},26:{1:13,2:23,3:33,4:42,5:49,lifetime:195},27:{1:12,2:22,3:31,4:38,5:45,lifetime:180}}}getIPFSData(){return this.ipfs}getIPFSHash(){return this.ipfs?.IpfsHash||this.ipfsHash}getIPFSUrl(){return this.ipfs?.url}getIPFSMetadata(){return this.ipfs?.metadata}getZelfProof(){return this.zelfProof}getExpirationDate(){return this.expiresAt?new Date(this.expiresAt):void 0}isExpired(){return this.expiresAt?new Date(this.expiresAt)<new Date:!1}getSubscriptionId(){return this.subscriptionId}getPreviousDomain(){return this.previousDomain}getLicenseType(){return this.type||this.domainConfig.type}isActive(){return this.domainConfig.status==="active"}supportsFeature(e){return!0}getPrice(e,t="1",r=""){if(!e)return{price:0,currency:"USD",reward:0,discount:0,priceWithoutDiscount:0,discountType:"percentage"};let m=e.split("."),n=r.replace(".hold",""),o=m[0].length;if(!this.domainConfig.tags.payment.pricingTable)return{price:0,currency:"USD",reward:0,discount:0,priceWithoutDiscount:0,discountType:"percentage"};if(!["1","2","3","4","5","lifetime"].includes(t))throw new Error("Invalid duration. Use '1', '2', '3', '4', '5' or 'lifetime'.");let i=24;if(o>=6&&o<=15)i=this.domainConfig.tags.payment.pricingTable["6-15"][t];else if(this.domainConfig.tags.payment.pricingTable[o])i=this.domainConfig.tags.payment.pricingTable[o][t];else throw new Error("Invalid name length. Length must be between 1 and 27.");let u=Number(i),s=0,l="percentage",p=this.domainConfig.tags.payment.whitelist||{};if(Object.keys(p).length&&n&&p[n]){let d=p[n];d.includes("%")?(l="percentage",s=parseInt(d),i=i-i*(s/100)):(s=parseInt(d),l="amount",i=i-s)}else n&&(i=i-i*.1);return{price:Math.max(Math.ceil(i*100)/100,0),currency:"USD",reward:Math.max(Math.ceil(i/this.domainConfig.tags.payment.rewardPrice*100)/100,0),discount:s,priceWithoutDiscount:u,discountType:l}}validateTagName(e){if(e.length<this.domainConfig.tags.minLength)return{valid:!1,error:`Tag name must be at least ${this.domainConfig.tags.minLength} characters long`};if(e.length>this.domainConfig.tags.maxLength)return{valid:!1,error:`Tag name must be no more than ${this.domainConfig.tags.maxLength} characters long`};if(!this.domainConfig.tags.allowedChars.test(e))return{valid:!1,error:`Tag name contains invalid characters. Allowed pattern: ${this.domainConfig.tags.allowedChars}`};if(this.domainConfig.tags.reserved.includes(e.toLowerCase()))return{valid:!1,error:`Tag name '${e}' is reserved`};for(let t of this.domainConfig.tags.customRules)if(typeof t=="function"){let r=t(e);if(!r.valid)return r}return{valid:!0}}getStorageConfig(){return this.domainConfig.tags.storage}getZelfkeysStorageConfig(){return this.domainConfig.zelfkeys.storage}getPaymentMethods(){return this.domainConfig.tags.payment.methods}getSupportedCurrencies(){return this.domainConfig.tags.payment.currencies}getLimits(){return this.domainConfig.limits}generateHoldDomain(e){return`${e}${this.domainConfig.holdSuffix}.${this.domain}`}toJSON(){return{domain:this.domain,domainConfig:this.domainConfig,faceBase64:this.faceBase64,masterPassword:this.masterPassword,ipfsHash:this.ipfsHash,createdAt:this.createdAt,updatedAt:this.updatedAt,ipfs:this.ipfs,zelfProof:this.zelfProof,expiresAt:this.expiresAt,subscriptionId:this.subscriptionId,previousDomain:this.previousDomain,type:this.type}}static fromJSON(e){return new a(e)}static fromAPIResponse(e){let t={domain:e.domain,domainConfig:{name:e.name,holdSuffix:e.holdSuffix,status:e.status,owner:e.owner,description:e.description,startDate:e.startDate,endDate:e.endDate,tags:e.tags,zelfkeys:e.zelfkeys,stripe:e.stripe,limits:e.limits,metadata:e.metadata},ipfs:e.ipfs,zelfProof:e.zelfProof,expiresAt:e.expiresAt,subscriptionId:e.subscriptionId,previousDomain:e.previousDomain,type:e.type};return new a(t)}static fromAPIResponseWithWrapper(e){let t=e.data||e;return a.fromAPIResponse(t)}static createEmpty(e){return new a({domain:e,domainConfig:{name:e,holdSuffix:".hold",status:"inactive",owner:"zelf-team",description:`Custom domain: ${e}`,startDate:"",endDate:"",tags:{minLength:3,maxLength:50,allowedChars:/^[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]$/,reserved:["www","api","admin","support","help"],customRules:[],payment:{methods:["coinbase","crypto","stripe"],currencies:["USD","BTC","ETH","SOL"],discounts:{yearly:.1,lifetime:.2},rewardPrice:10,whitelist:{},pricingTable:{}},storage:{keyPrefix:"tagName",ipfsEnabled:!0,arweaveEnabled:!0,walrusEnabled:!0,backupEnabled:!1}},zelfkeys:{plans:[],payment:{whitelist:{},pricingTable:{}},storage:{keyPrefix:"tagName",ipfsEnabled:!0,arweaveEnabled:!0,walrusEnabled:!0,backupEnabled:!1}},stripe:{productId:"",priceId:"",latestInvoiceId:"",amountPaid:0,paidAt:""},limits:{tags:100,zelfkeys:100,zelfProofs:100},metadata:{launchDate:new Date().toISOString().split("T")[0],version:"1.0.0",documentation:"",support:"standard"}}})}};export{f as a};
