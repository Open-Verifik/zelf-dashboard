import{a as it}from"./chunk-VL6CI64D.js";import{b as nt}from"./chunk-FK6MMEI5.js";import"./chunk-YOTJB2IK.js";import"./chunk-6MVDTPQV.js";import{a as Z,c as J,d as K}from"./chunk-HO6TKSQT.js";import{c as et}from"./chunk-JJWLRRW7.js";import{j as L}from"./chunk-N6LPVSL5.js";import{a as W,d as A}from"./chunk-DXVBJCLH.js";import{A as tt,y as X,z as Y}from"./chunk-QH2I47VF.js";import{a as Q}from"./chunk-EBTKBAUO.js";import{aa as q,ea as G,fa as O}from"./chunk-3CSJK4TT.js";import{a as x}from"./chunk-E6ENPQNB.js";import"./chunk-PIQLBEWE.js";import{b as D,d as N}from"./chunk-FXKMXYKD.js";import{h as H,r as V,y as j}from"./chunk-XX57SXRU.js";import{Ab as f,Hc as s,Ib as B,Ic as c,Ob as $,Pb as b,Pc as R,Sb as I,Tb as k,Ub as a,Vb as i,Wb as F,_b as C,aa as T,ec as w,ga as E,gb as o,gc as g,hb as v,ra as S,rc as n,sa as y,sc as _,ta as U,tc as p,ua as z,ub as M,uc as P}from"./chunk-FFNUM7ZM.js";import{g as u}from"./chunk-TSRGIXR5.js";var at=(()=>{class r{constructor(){this._httpClient=E(j),this._httpWrapper=E(Q)}getSubscriptionPlans(){return u(this,null,function*(){try{let t=new Promise((m,h)=>setTimeout(()=>h(new Error("Request timeout after 10 seconds")),1e4)),e=this._httpWrapper.sendRequest("get",`${x.apiUrl}${x.endpoints.subscriptionPlans.list}`);return(yield Promise.race([e,t])).data||[]}catch(t){throw t}})}getSubscriptionPlan(t){return u(this,null,function*(){try{return(yield this._httpWrapper.sendRequest("get",`${x.apiUrl}${x.endpoints.subscriptionPlans.getById}/${t}`)).data}catch(e){throw e}})}subscribe(t){return u(this,null,function*(){try{let e=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}${x.endpoints.subscriptionPlans.subscribe}`,t);return e.data?e.data:e}catch(e){throw e}})}getMySubscription(){return u(this,null,function*(){try{return(yield this._httpWrapper.sendRequest("get",`${x.apiUrl}${x.endpoints.subscriptionPlans.mySubscription}`)).data}catch(t){throw t}})}createStripePortalSession(){return u(this,null,function*(){try{let t=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}${x.endpoints.subscriptionPlans.createPortalSession}`);return t.data||t}catch(t){throw t}})}cancelSubscription(t){return u(this,null,function*(){try{let e=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}${x.endpoints.subscriptionPlans.cancelSubscription}`,{subscriptionId:t});return e.data||e}catch(e){throw e}})}upgradeSubscription(t,e){return u(this,null,function*(){try{let l=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}${x.endpoints.subscriptionPlans.upgradeSubscription}`,{subscriptionId:t,newPriceId:e});return l.data||l}catch(l){throw l}})}verifySession(t){return u(this,null,function*(){try{let e=yield this._httpWrapper.sendRequest("post",`${x.apiUrl}/api/subscription-plans/verify-session`,{sessionId:t});return e.data||e}catch(e){throw e}})}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=T({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var st=(r,d)=>d.id;function ct(r,d){r&1&&(a(0,"div",2)(1,"mat-icon",4),n(2,"refresh"),i(),a(3,"div",5),n(4),s(5,"transloco"),i(),a(6,"div",6),n(7),s(8,"transloco"),i()()),r&2&&(o(4),p(" ",c(5,2,"saving_operations.plan_billing_page.loading_title")," "),o(3),_(c(8,4,"saving_operations.plan_billing_page.loading_description")))}function pt(r,d){if(r&1&&(a(0,"div",3)(1,"div",7)(2,"mat-icon",8),n(3,"error_outline"),i(),a(4,"span",9),n(5),i()()()),r&2){let t=g();o(5),_(t.error)}}function dt(r,d){if(r&1&&(a(0,"div",38)(1,"div",39)(2,"div",40)(3,"div",41)(4,"mat-icon",8),n(5,"bar_chart"),i()(),a(6,"div")(7,"h2",42),n(8),s(9,"transloco"),i(),a(10,"p",43),n(11),s(12,"transloco"),i()()(),a(13,"div",44)(14,"div",45)(15,"div",46),n(16),s(17,"transloco"),i(),a(18,"div",47),n(19),i()(),a(20,"div",45)(21,"div",46),n(22),s(23,"transloco"),i(),a(24,"div",47),n(25),i()(),a(26,"div",45)(27,"div",46),n(28),s(29,"transloco"),i(),a(30,"div",47),n(31),i()()()()()),r&2){let t=g(3);o(8),p(" ",c(9,8,"saving_operations.plan_billing_page.limits.title")," "),o(3),p(" ",c(12,10,"saving_operations.plan_billing_page.limits.subtitle")," "),o(5),p(" ",c(17,12,"saving_operations.plan_billing_page.limits.tags")," "),o(3),p(" ",t.mySubscription.subscriptionIPFS.limits.tags||0," "),o(3),p(" ",c(23,14,"saving_operations.plan_billing_page.limits.zelfkeys")," "),o(3),p(" ",t.mySubscription.subscriptionIPFS.limits.zelfkeys||0," "),o(3),p(" ",c(29,16,"saving_operations.plan_billing_page.limits.zelfproofs")," "),o(3),p(" ",t.mySubscription.subscriptionIPFS.limits.zelfProofs||0," ")}}function mt(r,d){if(r&1){let t=C();a(0,"div",12)(1,"div",13),U(),a(2,"svg",14),F(3,"path",15),i()(),z(),a(4,"div",16)(5,"div",17)(6,"div")(7,"div",18)(8,"span",19),n(9),i(),a(10,"span",20),n(11),s(12,"transloco"),i()(),a(13,"h3",21),n(14),i(),a(15,"p",22),n(16),i()(),a(17,"div",23)(18,"div",24),n(19),i(),a(20,"div",25),n(21),s(22,"transloco"),i()()(),F(23,"div",26),a(24,"div",27)(25,"div")(26,"h4",28),n(27),s(28,"transloco"),i(),a(29,"div",29)(30,"div",30)(31,"span",31),n(32),s(33,"transloco"),i(),a(34,"span",32),n(35),i()(),a(36,"div",30)(37,"span",31),n(38),s(39,"transloco"),i(),a(40,"span",33),n(41),i()(),a(42,"div",30)(43,"span",31),n(44),s(45,"transloco"),i(),a(46,"span",34),n(47),i()()()(),a(48,"div")(49,"h4",28),n(50),s(51,"transloco"),i(),a(52,"div",35)(53,"button",36),w("click",function(){S(t);let l=g(2);return y(l.openStripePortal())}),a(54,"mat-icon",37),n(55,"payment"),i(),n(56),s(57,"transloco"),i()()()()()(),f(58,dt,32,18,"div",38)}if(r&2){let t=g(2);o(9),p(" ",t.getCurrentSubscription().status," "),o(2),_(c(12,18,"saving_operations.plan_billing_page.active_subscription.title")),o(3),_(t.getCurrentPlan().name),o(2),_(t.getCurrentPlan().description),o(3),p(" ",t.formatPrice(t.getCurrentSubscription().plan.amount,t.getCurrentSubscription().plan.currency)," "),o(2),P(" ",c(22,20,"saving_operations.plan_billing_page.active_subscription.per")," ",t.getCurrentSubscription().plan.interval," "),o(6),p(" ",c(28,22,"saving_operations.plan_billing_page.details.title")," "),o(5),_(c(33,24,"saving_operations.plan_billing_page.details.next_billing")),o(3),_(t.formatDate(t.getCurrentSubscription().current_period_end)),o(3),_(c(39,26,"saving_operations.plan_billing_page.details.current_period")),o(3),P(" ",t.formatDate(t.getCurrentSubscription().current_period_start)," - ",t.formatDate(t.getCurrentSubscription().current_period_end)," "),o(3),_(c(45,28,"saving_operations.plan_billing_page.details.subscription_id")),o(3),_(t.getCurrentSubscription().id),o(3),p(" ",c(51,30,"saving_operations.plan_billing_page.actions.title")," "),o(6),p(" ",c(57,32,"saving_operations.plan_billing_page.actions.manage_billing")," "),o(2),b(!(t.mySubscription==null||t.mySubscription.subscriptionIPFS==null)&&t.mySubscription.subscriptionIPFS.limits?58:-1)}}function ut(r,d){if(r&1){let t=C();a(0,"div",48)(1,"h3",47),n(2),s(3,"transloco"),i(),a(4,"button",52),w("click",function(){S(t);let l=g(3);return y(l.hidePlanComparison())}),a(5,"mat-icon"),n(6,"close"),i(),n(7),s(8,"transloco"),i()()}r&2&&(o(2),p(" ",c(3,2,"saving_operations.plan_billing_page.available_upgrades.title")," "),o(5),p(" ",c(8,4,"saving_operations.plan_billing_page.available_upgrades.cancel")," "))}function gt(r,d){r&1&&(a(0,"h3",49),n(1),s(2,"transloco"),i()),r&2&&(o(),p(" ",c(2,1,"saving_operations.plan_billing_page.select_plan")," "))}function _t(r,d){if(r&1&&(a(0,"div",56)(1,"span",61),n(2),i(),a(3,"span",62),n(4),i()()),r&2){let t=g().$implicit,e=g(3);o(2),p(" ",e.formatPrice(e.getCheapestPrice(t).unit_amount,e.getCheapestPrice(t).currency)," "),o(2),p("/ ",e.getCheapestPrice(t).recurring.interval,"")}}function xt(r,d){r&1&&(a(0,"div",63)(1,"mat-icon",64),n(2,"check_circle"),i(),a(3,"span",65)(4,"b"),n(5,"50"),i(),n(6),s(7,"transloco"),i()(),a(8,"div",63)(9,"mat-icon",64),n(10,"check_circle"),i(),a(11,"span",65)(12,"b"),n(13,"50"),i(),n(14),s(15,"transloco"),i()()),r&2&&(o(6),p(" ",c(7,2,"saving_operations.plan_billing_page.features.active_users"),""),o(8),p(" ",c(15,4,"saving_operations.plan_billing_page.features.encryptions_mo"),""))}function bt(r,d){r&1&&(a(0,"div",63)(1,"mat-icon",64),n(2,"check_circle"),i(),a(3,"span",65)(4,"b"),n(5,"500"),i(),n(6),s(7,"transloco"),i()(),a(8,"div",63)(9,"mat-icon",64),n(10,"check_circle"),i(),a(11,"span",65)(12,"b"),n(13),s(14,"transloco"),i(),n(15),s(16,"transloco"),i()()),r&2&&(o(6),p(" ",c(7,3,"saving_operations.plan_billing_page.features.active_users"),""),o(7),_(c(14,5,"saving_operations.plan_billing_page.features.unlimited")),o(2),p(" ",c(16,7,"saving_operations.plan_billing_page.features.encryptions"),""))}function ht(r,d){r&1&&(a(0,"div",63)(1,"mat-icon",64),n(2,"check_circle"),i(),a(3,"span",65)(4,"b"),n(5,"1,250"),i(),n(6),s(7,"transloco"),i()(),a(8,"div",63)(9,"mat-icon",64),n(10,"check_circle"),i(),a(11,"span",65),n(12),s(13,"transloco"),i()()),r&2&&(o(6),p(" ",c(7,2,"saving_operations.plan_billing_page.features.active_users"),""),o(6),_(c(13,4,"saving_operations.plan_billing_page.features.priority_support")))}function ft(r,d){r&1&&(a(0,"div",63)(1,"mat-icon",64),n(2,"check_circle"),i(),a(3,"span",65)(4,"b"),n(5,"3,000"),i(),n(6),s(7,"transloco"),i()(),a(8,"div",63)(9,"mat-icon",64),n(10,"check_circle"),i(),a(11,"span",65),n(12),s(13,"transloco"),i()()),r&2&&(o(6),p(" ",c(7,2,"saving_operations.plan_billing_page.features.active_users"),""),o(6),_(c(13,4,"saving_operations.plan_billing_page.features.advanced_analytics")))}function vt(r,d){r&1&&(a(0,"div",63)(1,"mat-icon",64),n(2,"check_circle"),i(),a(3,"span",65)(4,"b"),n(5,"10,000"),i(),n(6),s(7,"transloco"),i()(),a(8,"div",63)(9,"mat-icon",64),n(10,"check_circle"),i(),a(11,"span",65),n(12),s(13,"transloco"),i()()),r&2&&(o(6),p(" ",c(7,2,"saving_operations.plan_billing_page.features.users"),""),o(6),_(c(13,4,"saving_operations.plan_billing_page.features.dedicated_infra")))}function St(r,d){if(r&1){let t=C();a(0,"button",66),w("click",function(){S(t);let l=g().$implicit,m=g(3);return y(m.upgradeToPlan(l))}),n(1),s(2,"transloco"),i()}r&2&&(o(),p(" ",c(2,1,"saving_operations.plan_billing_page.upgrade")," "))}function yt(r,d){r&1&&(a(0,"mat-icon",68),n(1,"refresh"),i(),n(2),s(3,"transloco")),r&2&&(o(2),p(" ",c(3,1,"saving_operations.plan_billing_page.processing")," "))}function Ct(r,d){r&1&&(n(0),s(1,"transloco")),r&2&&p(" ",c(1,1,"saving_operations.plan_billing_page.get_started")," ")}function wt(r,d){if(r&1){let t=C();a(0,"button",67),w("click",function(){S(t);let l=g().$implicit,m=g(3);return y(m.onSubscribe(l.id))}),f(1,yt,4,3)(2,Ct,2,3),i()}if(r&2){let t=g().$implicit,e=g(3);B("disabled",e.subscribing&&e.subscribingPlanId===t.id),o(),b(e.subscribing&&e.subscribingPlanId===t.id?1:2)}}function Pt(r,d){if(r&1&&(a(0,"div",51)(1,"div",53)(2,"h4",54),n(3),i(),a(4,"p",55),n(5),i(),f(6,_t,5,2,"div",56),a(7,"div",57),f(8,xt,16,6)(9,bt,17,9)(10,ht,14,6)(11,ft,14,6)(12,vt,14,6),i()(),a(13,"div",58),f(14,St,3,3,"button",59)(15,wt,3,2,"button",60),i()()),r&2){let t=d.$implicit,e=g(3);o(3),p(" ",e.getPlanDisplayName(t.metadata.zelfPlan)," "),o(2),_(t.description||t.name),o(),b(e.getCheapestPrice(t)?6:-1),o(2),b(t.metadata.zelfPlan==="zelfBasic"?8:t.metadata.zelfPlan==="zelfStartUp"?9:t.metadata.zelfPlan==="zelfBusiness"?10:t.metadata.zelfPlan==="zelfGold"?11:t.metadata.zelfPlan==="zelfEnterprise"?12:-1),o(6),b(e.hasSubscription?14:15)}}function Et(r,d){if(r&1&&(a(0,"div",10),f(1,ut,9,6,"div",48)(2,gt,3,3,"h3",49),a(3,"div",50),I(4,Pt,16,5,"div",51,$().trackByFn,!0),i()()),r&2){let t=g(2);o(),b(t.hasSubscription?1:2),o(3),k(t.hasSubscription?t.getUpgradePlans():t.plans)}}function Bt(r,d){if(r&1&&(a(0,"div",73)(1,"div")(2,"div",74),n(3),i(),a(4,"div",75),n(5),i()(),a(6,"div",76)(7,"span",77),n(8),i(),a(9,"div",78),n(10),i()()()),r&2){let t=d.$implicit,e=g(3);o(3),_(t.description),o(2),P("",e.formatDate(t.date)," \u2022 ",t.id,""),o(2),B("ngClass",e.getStatusBadgeColor(t.status)),o(),p(" ",t.status," "),o(2),_(e.formatPrice(t.amount,t.currency))}}function It(r,d){if(r&1&&(a(0,"div",11)(1,"div",69)(2,"div",48)(3,"h3",70)(4,"mat-icon",71),n(5,"receipt_long"),i(),n(6),s(7,"transloco"),i()(),a(8,"div",72),I(9,Bt,11,6,"div",73,st),i()()()),r&2){let t=g(2);o(6),p(" ",c(7,1,"saving_operations.plan_billing_page.billing_history.title")," "),o(3),k(t.billingHistory)}}function kt(r,d){if(r&1&&f(0,mt,59,34)(1,Et,6,1,"div",10)(2,It,11,3,"div",11),r&2){let t=g();b(t.hasSubscription&&t.getCurrentPlan()?0:-1),o(),b(!t.hasSubscription||t.hasSubscription&&t.showPlanComparison?1:-1),o(),b(t.billingHistory&&t.billingHistory.length>0?2:-1)}}var Yt=(()=>{class r{constructor(t,e,l,m,h,rt){this._formBuilder=t,this._subscriptionPlansService=e,this._cdr=l,this._translocoService=m,this._activatedRoute=h,this._router=rt,this.plans=[],this.loading=!1,this.subscribing=!1,this.error=null,this.hasSubscription=!1,this.mySubscription=null,this.showPlanComparison=!1,this.selectedUpgradePlan=null,this.showBillingHistory=!1,this.billingHistory=[],this.initialLoading=!0,this.subscribingPlanId=null}ngOnInit(){return u(this,null,function*(){this.checkSubscriptionStatus(),this.planBillingForm=this._formBuilder.group({plan:[""],cardHolder:["Brian Hughes"],cardNumber:[""],cardExpiration:[""],cardCVC:[""],country:["usa"],zip:[""]});try{let t=this._activatedRoute.snapshot.queryParamMap.get("session_id");t&&(yield this.handleSessionVerification(t)),yield this.loadMyPlan(),yield this.loadSubscriptionPlans()}catch(t){console.error("Error initializing plan billing:",t)}finally{this.initialLoading=!1,this._cdr.detectChanges()}})}handleSessionVerification(t){return u(this,null,function*(){this.initialLoading=!0,this._cdr.detectChanges(),yield new Promise(e=>setTimeout(e,3e3));try{console.log("Verifying session...",t),yield this._subscriptionPlansService.verifySession(t)}catch(e){console.error("Session verification failed",e),this.error="Failed to verify subscription. Please contact support."}})}loadMyPlan(){return u(this,null,function*(){try{this.mySubscription=yield this._subscriptionPlansService.getMySubscription(),this.hasSubscription=this.mySubscription&&this.mySubscription.subscription&&this.mySubscription.subscription.status==="active",this._cdr.detectChanges()}catch(t){console.error("Failed to load subscription:",t),this.hasSubscription=!1}})}loadSubscriptionPlans(){return u(this,null,function*(){this.loading=!0,this.error=null;try{let t=yield this._subscriptionPlansService.getSubscriptionPlans();this.plans=t.sort((e,l)=>{let m=this.getCheapestPrice(e)?.unit_amount||0,h=this.getCheapestPrice(l)?.unit_amount||0;return m-h}),t.length>0&&this.planBillingForm.patchValue({plan:t[0].id}),this._cdr.detectChanges()}catch(t){this.error=`Failed to load subscription plans: ${t.message||"Unknown error"}`}finally{this.loading=!1,this._cdr.detectChanges()}})}checkSubscriptionStatus(){try{let t=localStorage.getItem("subscription");this.hasSubscription=t!==null&&t!=="null"&&t!==""}catch{this.hasSubscription=!1}}trackByFn(t,e){return e.id||t}formatPrice(t,e){return new Intl.NumberFormat("en-US",{style:"currency",currency:e.toUpperCase()}).format(t/100)}getCheapestPrice(t){if(!t.prices||t.prices.length===0)return null;let e=t.prices.filter(l=>l.active&&l.unit_amount>0).sort((l,m)=>l.unit_amount-m.unit_amount);return e.length>0?e[0]:null}getPlanDisplayName(t){return{zelfBasic:"BASIC",ZelfGold:"GOLD",zelfBusiness:"BUSINESS",zelfStartUp:"STARTUP",zelfEnterprise:"ENTERPRISE"}[t]||t.toUpperCase()}selectPlan(t){this.planBillingForm.patchValue({plan:t}),this._cdr.detectChanges()}isPlanSelected(t){return this.planBillingForm.get("plan")?.value===t}onSubscribe(t){return u(this,null,function*(){if(!t)return;let e=this.plans.find(m=>m.id===t);if(!e)return;let l=this.getCheapestPrice(e);if(l){this.subscribing=!0,this.subscribingPlanId=t,this.error=null,this._cdr.detectChanges();try{let m={productId:e.id,priceId:l.id,customerEmail:null},h=yield this._subscriptionPlansService.subscribe(m);if(h&&h.success&&h.url){window.location.href=h.url;return}throw new Error("Failed to create checkout session")}catch(m){this.error=`Failed to create checkout session: ${m.message||"Unknown error"}`}finally{this.subscribing=!1,this.subscribingPlanId=null,this._cdr.detectChanges()}}})}getCurrentPlan(){return!this.mySubscription||!this.mySubscription.product?null:this.mySubscription.product}getCurrentSubscription(){return!this.mySubscription||!this.mySubscription.subscription?null:this.mySubscription.subscription}formatDate(t){return new Date(t*1e3).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}getStatusColor(t){switch(t){case"active":return"text-green-600";case"canceled":return"text-red-600";case"past_due":return"text-yellow-600";case"unpaid":return"text-red-600";default:return"text-gray-600"}}getStatusBadgeColor(t){switch(t){case"active":return"bg-green-100 text-green-800";case"canceled":return"bg-red-100 text-red-800";case"past_due":return"bg-yellow-100 text-yellow-800";case"unpaid":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}showUpgradeComparison(t){this.selectedUpgradePlan=t,this.showPlanComparison=!0,this._cdr.detectChanges()}hidePlanComparison(){this.showPlanComparison=!1,this.selectedUpgradePlan=null,this._cdr.detectChanges()}getUpgradePlans(){if(!this.mySubscription||!this.mySubscription.subscription)return this.plans;let t=this.mySubscription.subscription.plan.amount;return this.plans.filter(e=>{let l=this.getCheapestPrice(e);return l&&l.unit_amount>t})}openStripePortal(){return u(this,null,function*(){try{let t=yield this._subscriptionPlansService.createStripePortalSession();if(t&&t.success&&t.url){window.location.href=t.url;return}throw new Error("Failed to create portal session")}catch(t){this.error=`Failed to open billing portal: ${t.message||"Unknown error"}`,this._cdr.detectChanges()}})}cancelSubscription(){return u(this,null,function*(){if(confirm("Are you sure you want to cancel your subscription? This action cannot be undone."))try{let t=this.getCurrentSubscription();if(!t)throw new Error("No active subscription found");let e=yield this._subscriptionPlansService.cancelSubscription(t.id);if(e&&e.success)yield this.loadMyPlan(),alert("Subscription cancelled successfully.");else throw new Error(e?.message||"Failed to cancel subscription")}catch(t){this.error=`Failed to cancel subscription: ${t.message||"Unknown error"}`,this._cdr.detectChanges()}})}upgradeToPlan(t){return u(this,null,function*(){try{let e=this.getCurrentSubscription();if(!e)throw new Error("No active subscription found");let l=this.getCheapestPrice(t);if(!l)throw new Error("No valid price found for this plan");let m=yield this._subscriptionPlansService.upgradeSubscription(e.id,l.id);if(m&&m.success&&m.url){window.location.href=m.url;return}throw new Error("Failed to create upgrade session")}catch(e){this.error=`Failed to upgrade plan: ${e.message||"Unknown error"}`,this._cdr.detectChanges()}})}toggleBillingHistory(){this.showBillingHistory=!this.showBillingHistory,this.showBillingHistory&&this.billingHistory.length===0&&this.loadBillingHistory(),this._cdr.detectChanges()}loadBillingHistory(){return u(this,null,function*(){try{this.billingHistory=[{id:"in_1SIBhPFO6i3ofqGHMzmmHGNA",amount:99900,currency:"usd",status:"paid",date:1760461667,description:"Zelf Business - Monthly subscription"}],this._cdr.detectChanges()}catch(t){console.error("Failed to load billing history:",t)}})}getPlanUsage(){if(!this.mySubscription||!this.mySubscription.domainConfig)return null;let t=this.mySubscription.domainConfig;return{activeUsers:this.getActiveUserLimit(),encryptions:this.getEncryptionLimit(),storage:t.storage||{},features:t.features||[]}}getActiveUserLimit(){let t=this.getCurrentPlan();if(!t)return 0;switch(t.metadata.zelfPlan){case"zelfBasic":return 50;case"zelfStartUp":return 500;case"zelfBusiness":return 1250;case"zelfGold":return 3e3;case"zelfEnterprise":return 1e4;default:return 0}}getEncryptionLimit(){let t=this.getCurrentPlan();return t?t.metadata.zelfPlan==="zelfBasic"?50:"Unlimited":0}static{this.\u0275fac=function(e){return new(e||r)(v(X),v(at),v(R),v(Z),v(D),v(N))}}static{this.\u0275cmp=M({type:r,selectors:[["settings-plan-billing"]],decls:5,vars:3,consts:[[1,"flex","flex-col","min-h-screen","bg-gray-50/50","dark:bg-gray-900","w-full"],[1,"flex-auto","p-6","sm:p-10","w-full","max-w-screen-xl"],[1,"flex","flex-col","items-center","justify-center","min-h-[400px]"],[1,"mb-6","animate-fade-in"],[1,"animate-spin","text-5xl","text-blue-600","mb-4"],[1,"text-xl","font-semibold","text-gray-800","dark:text-gray-200"],[1,"text-gray-500","mt-2"],[1,"bg-red-50","border","border-red-200","text-red-800","rounded-2xl","p-4","flex","items-center","gap-3","dark:bg-red-900/20","dark:border-red-800","dark:text-red-300"],[1,"icon-size-5"],[1,"font-medium"],[1,"mb-8"],[1,"bg-white","dark:bg-slate-800","rounded-3xl","shadow-xl","overflow-hidden","border","border-gray-100","dark:border-gray-700/50"],[1,"bg-gradient-to-br","from-indigo-600","to-violet-700","rounded-3xl","shadow-xl","overflow-hidden","mb-8","text-white","relative"],[1,"absolute","inset-0","opacity-10"],["viewBox","0 0 100 100","preserveAspectRatio","none",1,"h-full","w-full"],["d","M0 100 C 20 0 50 0 100 100 Z","fill","white"],[1,"p-8","sm:p-10","relative","z-10"],[1,"flex","flex-col","md:flex-row","md:items-center","justify-between","gap-6"],[1,"flex","items-center","gap-3","mb-2"],[1,"px-3","py-1","bg-white/20","backdrop-blur-sm","rounded-full","text-sm","font-bold","border","border-white/20","uppercase","tracking-wider"],[1,"text-indigo-200","text-sm","font-medium"],[1,"text-4xl","font-extrabold","mb-2"],[1,"text-indigo-100","text-lg","max-w-xl"],[1,"text-left","md:text-right","bg-white/10","backdrop-blur-md","rounded-2xl","p-4","border","border-white/10"],[1,"text-5xl","font-bold","mb-1"],[1,"text-indigo-200","font-medium"],[1,"h-px","bg-white/20","my-8"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8"],[1,"text-sm","font-bold","uppercase","tracking-wider","text-indigo-200","mb-4"],[1,"space-y-3"],[1,"flex","justify-between","items-center","group"],[1,"text-indigo-100"],[1,"font-bold","border-b","border-dashed","border-white/30"],[1,"font-medium","bg-white/10","px-2","py-0.5","rounded","text-sm"],[1,"font-mono","text-sm","opacity-70"],[1,"flex","flex-wrap","gap-3"],["mat-flat-button","",1,"bg-white","text-indigo-900","hover:bg-gray-100","font-bold","rounded-xl","px-6","py-3","border-0","shadow-lg","transition-transform","active:scale-95",3,"click"],[1,"mr-2"],[1,"bg-white","dark:bg-slate-800","rounded-3xl","shadow-xl","overflow-hidden","mb-8","border","border-gray-100","dark:border-gray-700/50"],[1,"p-8","sm:p-10"],[1,"flex","items-center","gap-3","mb-6"],[1,"w-10","h-10","rounded-full","bg-blue-100","dark:bg-blue-900/30","flex","items-center","justify-center","text-blue-600","dark:text-blue-400"],[1,"text-xl","font-bold","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-6"],[1,"bg-gray-50","dark:bg-gray-900/50","rounded-2xl","p-5","border","border-gray-100","dark:border-gray-800"],[1,"text-gray-500","dark:text-gray-400","text-sm","font-medium","mb-1"],[1,"text-2xl","font-bold","text-gray-900","dark:text-white"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900","dark:text-white","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"bg-white","dark:bg-slate-800","rounded-3xl","shadow-lg","border-2","border-transparent","hover:border-blue-300","transition-all","duration-300","relative","overflow-hidden","group","flex","flex-col"],["mat-button","","color","warn",3,"click"],[1,"p-8","flex-1"],[1,"text-xl","font-bold","text-gray-900","dark:text-white","mb-2"],[1,"text-gray-500","dark:text-gray-400","text-sm","mb-6","min-h-[40px]"],[1,"flex","items-baseline","mb-6"],[1,"space-y-3","mb-8"],[1,"p-6","bg-gray-50","dark:bg-gray-900/30","border-t","border-gray-100","dark:border-gray-700/50","mt-auto"],["mat-flat-button","","color","primary",1,"w-full","rounded-xl","py-6"],["mat-flat-button","","color","primary",1,"w-full","rounded-xl","py-6","font-bold","text-lg",3,"disabled"],[1,"text-4xl","font-extrabold","text-gray-900","dark:text-white"],[1,"text-gray-500","ml-2"],[1,"flex","items-start","gap-3"],[1,"text-green-500","icon-size-5","shrink-0"],[1,"text-sm","text-gray-600","dark:text-gray-300"],["mat-flat-button","","color","primary",1,"w-full","rounded-xl","py-6",3,"click"],["mat-flat-button","","color","primary",1,"w-full","rounded-xl","py-6","font-bold","text-lg",3,"click","disabled"],[1,"animate-spin","mr-2"],[1,"p-8"],[1,"text-xl","font-bold","text-gray-900","dark:text-white","flex","items-center","gap-2"],[1,"text-gray-400"],[1,"divide-y","divide-gray-100","dark:divide-gray-800"],[1,"py-4","flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-4"],[1,"font-bold","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500"],[1,"flex","items-center","gap-4"],[1,"px-3","py-1","rounded-full","text-xs","font-bold","uppercase",3,"ngClass"],[1,"font-bold","text-lg"]],template:function(e,l){e&1&&(a(0,"div",0)(1,"div",1),f(2,ct,9,6,"div",2)(3,pt,6,1,"div",3)(4,kt,3,3),i()()),e&2&&(o(2),b(l.initialLoading?2:-1),o(),b(l.error?3:-1),o(),b(!l.initialLoading&&!l.error?4:-1))},dependencies:[V,H,Y,tt,it,O,G,L,et,nt,q,A,W,K,J],encapsulation:2,changeDetection:0})}}return r})();export{Yt as SettingsPlanBillingComponent};
