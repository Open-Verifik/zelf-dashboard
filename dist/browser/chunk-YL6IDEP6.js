import{a as qe}from"./chunk-B22LW5WC.js";import{h as Re}from"./chunk-PBWUUBVL.js";import{a as Ve}from"./chunk-SJYQFXR4.js";import{a as X,b as Se,c as Pe,e as G,f as Ee,h as Ie,k as Be,n as Ae}from"./chunk-5KSDO7GD.js";import"./chunk-6I4K3TIG.js";import{b as Oe,c as Ne}from"./chunk-3GYBXV36.js";import"./chunk-Q6XQEBQC.js";import"./chunk-E6ENPQNB.js";import{c as Ce,d as Z,g as q,h as Y,j as K}from"./chunk-QGFQ6LQC.js";import{a as we,d as Me}from"./chunk-62GRJCFO.js";import{b as je,f as Fe,k as Le,y as Ue}from"./chunk-YTO5EUI3.js";import{E as be,I as ve,M as W,a as _e,ga as Te,ha as De,t as ke,u as ye}from"./chunk-2TJ6ILEC.js";import{b as ge,d as xe}from"./chunk-GYFW3PAY.js";import{b as ue,p as fe}from"./chunk-CDEEPH4V.js";import{$b as ce,Ab as k,Ca as ie,Ga as N,Gc as l,Hb as se,Hc as d,Ib as F,Nc as U,Pb as y,Tb as o,Ub as a,Vb as L,W as R,Zb as M,aa as ee,ba as te,cb as ne,da as $,dc as C,ec as le,f as b,fc as g,ga as x,gb as r,hb as v,jb as ae,jc as z,kc as H,lc as Q,ob as f,qc as s,ra as E,rc as h,sa as I,sc as u,tc as T,ub as w,vb as oe,vc as de,wb as j,wc as me,xa as O,xc as pe,yb as re,yc as he}from"./chunk-6IDHI5WA.js";import{a as P,g as A}from"./chunk-TSRGIXR5.js";function Ze(t,m){if(t&1){let e=M();o(0,"div",1)(1,"button",2),C("click",function(){E(e);let i=g();return I(i.action())}),s(2),a()()}if(t&2){let e=g();r(2),u(" ",e.data.action," ")}}var Ye=["label"];function Ke(t,m){}var Xe=Math.pow(2,31)-1,D=class{_overlayRef;instance;containerInstance;_afterDismissed=new b;_afterOpened=new b;_onAction=new b;_durationTimeoutId;_dismissedByAction=!1;constructor(m,e){this._overlayRef=e,this.containerInstance=m,m._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(m){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(m,Xe))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},$e=new $("MatSnackBarData"),B=class{politeness="assertive";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},Ge=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=j({type:t,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return t})(),Je=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=j({type:t,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return t})(),et=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=j({type:t,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return t})(),ze=(()=>{class t{snackBarRef=x(D);data=x($e);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=w({type:t,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(n,i){n&1&&(o(0,"div",0),s(1),a(),k(2,Ze,3,1,"div",1)),n&2&&(r(),u(" ",i.data.message,`
`),r(),y(i.hasAction?2:-1))},dependencies:[we,Ge,Je,et],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0})}return t})(),tt={snackBarState:Ce("state",[Y("void, hidden",q({transform:"scale(0.8)",opacity:0})),Y("visible",q({transform:"scale(1)",opacity:1})),K("* => visible",Z("150ms cubic-bezier(0, 0, 0.2, 1)")),K("* => void, * => hidden",Z("75ms cubic-bezier(0.4, 0.0, 1, 1)",q({opacity:0})))])},it=(()=>{class t extends Pe{_ngZone=x(ie);_elementRef=x(N);_changeDetectorRef=x(U);_platform=x(_e);snackBarConfig=x(B);_document=x(ue);_trackedModals=new Set;_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new b;_onExit=new b;_onEnter=new b;_animationState="void";_live;_label;_role;_liveElementId=x(ve).getId("mat-snack-bar-container-live-");constructor(){super();let e=this.snackBarConfig;e.politeness==="assertive"&&!e.announcementMessage?this._live="assertive":e.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();let n=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),n}attachTemplatePortal(e){this._assertNotAttached();let n=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),n}attachDomPortal=e=>{this._assertNotAttached();let n=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),n};onAnimationEnd(e){let{fromState:n,toState:i}=e;if((i==="void"&&n!=="void"||i==="hidden")&&this._completeExit(),i==="visible"){let c=this._onEnter;this._ngZone.run(()=>{c.next(),c.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,n=this.snackBarConfig.panelClass;n&&(Array.isArray(n)?n.forEach(p=>e.classList.add(p)):e.classList.add(n)),this._exposeToModals();let i=this._label.nativeElement,c="mdc-snackbar__label";i.classList.toggle(c,!i.querySelector(`.${c}`))}_exposeToModals(){let e=this._liveElementId,n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let i=0;i<n.length;i++){let c=n[i],p=c.getAttribute("aria-owns");this._trackedModals.add(c),p?p.indexOf(e)===-1&&c.setAttribute("aria-owns",p+" "+e):c.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let n=e.getAttribute("aria-owns");if(n){let i=n.replace(this._liveElementId,"").trim();i.length>0?e.setAttribute("aria-owns",i):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{let e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),n=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&n){let i=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(i=document.activeElement),e.removeAttribute("aria-hidden"),n.appendChild(e),i?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=w({type:t,selectors:[["mat-snack-bar-container"]],viewQuery:function(n,i){if(n&1&&(z(G,7),z(Ye,7)),n&2){let c;H(c=Q())&&(i._portalOutlet=c.first),H(c=Q())&&(i._label=c.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:1,hostBindings:function(n,i){n&1&&le("@state.done",function(p){return i.onAnimationEnd(p)}),n&2&&ce("@state",i._animationState)},features:[re],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(n,i){n&1&&(o(0,"div",1)(1,"div",2,0)(3,"div",3),k(4,Ke,0,0,"ng-template",4),a(),L(5,"div"),a()()),n&2&&(r(5),se("aria-live",i._live)("role",i._role)("id",i._liveElementId))},dependencies:[G],styles:[".mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-snackbar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mdc-snackbar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mdc-snackbar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mdc-snackbar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mdc-snackbar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}"],encapsulation:2,data:{animation:[tt.snackBarState]}})}return t})();function nt(){return new B}var at=new $("mat-snack-bar-default-options",{providedIn:"root",factory:nt}),J=(()=>{class t{_overlay=x(Be);_live=x(be);_injector=x(O);_breakpointObserver=x(ke);_parentSnackBar=x(t,{optional:!0,skipSelf:!0});_defaultConfig=x(at);_snackBarRefAtThisLevel=null;simpleSnackBarComponent=ze;snackBarContainerComponent=it;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,n){return this._attach(e,n)}openFromTemplate(e,n){return this._attach(e,n)}open(e,n="",i){let c=P(P({},this._defaultConfig),i);return c.data={message:e,action:n},c.announcementMessage===e&&(c.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,c)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,n){let i=n&&n.viewContainerRef&&n.viewContainerRef.injector,c=O.create({parent:i||this._injector,providers:[{provide:B,useValue:n}]}),p=new X(this.snackBarContainerComponent,n.viewContainerRef,c),_=e.attach(p);return _.instance.snackBarConfig=n,_.instance}_attach(e,n){let i=P(P(P({},new B),this._defaultConfig),n),c=this._createOverlay(i),p=this._attachSnackBarContainer(c,i),_=new D(p,c);if(e instanceof ae){let S=new Se(e,null,{$implicit:i.data,snackBarRef:_});_.instance=p.attachTemplatePortal(S)}else{let S=this._createInjector(i,_),V=new X(e,void 0,S),Qe=p.attachComponentPortal(V);_.instance=Qe.instance}return this._breakpointObserver.observe(ye.HandsetPortrait).pipe(R(c.detachments())).subscribe(S=>{c.overlayElement.classList.toggle(this.handsetCssClass,S.matches)}),i.announcementMessage&&p._onAnnounce.subscribe(()=>{this._live.announce(i.announcementMessage,i.politeness)}),this._animateSnackBar(_,i),this._openedSnackBarRef=_,this._openedSnackBarRef}_animateSnackBar(e,n){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),n.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),n.duration&&n.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(n.duration))}_createOverlay(e){let n=new Ie;n.direction=e.direction;let i=this._overlay.position().global(),c=e.direction==="rtl",p=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!c||e.horizontalPosition==="end"&&c,_=!p&&e.horizontalPosition!=="center";return p?i.left("0"):_?i.right("0"):i.centerHorizontally(),e.verticalPosition==="top"?i.top("0"):i.bottom("0"),n.positionStrategy=i,this._overlay.create(n)}_createInjector(e,n){let i=e&&e.viewContainerRef&&e.viewContainerRef.injector;return O.create({parent:i||this._injector,providers:[{provide:D,useValue:n},{provide:$e,useValue:e.data}]})}static \u0275fac=function(n){return new(n||t)};static \u0275prov=ee({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var He=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=oe({type:t});static \u0275inj=te({providers:[J],imports:[Ae,Ee,Me,W,ze,W]})}return t})();function rt(t,m){if(t&1&&(o(0,"p",8),s(1),a()),t&2){let e=g();r(),u("$",e.price(),"")}}function st(t,m){if(t&1&&(o(0,"p",8),s(1),a()),t&2){let e=g();r(),T("",e.amountToPay()," ",e.paymentMethod(),"")}}function ct(t,m){if(t&1&&(o(0,"div",17)(1,"span",15),s(2),l(3,"transloco"),a(),o(4,"span",19),s(5),a()()),t&2){let e=g();r(2),h(d(3,2,"checkout.paymentMethod")),r(3),h(e.paymentMethod())}}function lt(t,m){t&1&&(o(0,"span",54),s(1,"\u23F3"),a(),o(2,"span"),s(3),l(4,"transloco"),a()),t&2&&(r(3),h(d(4,1,"checkout.sending")))}function dt(t,m){t&1&&(s(0),l(1,"transloco")),t&2&&u(" ",d(1,1,"checkout.sendReceipt")," ")}function mt(t,m){if(t&1){let e=M();o(0,"div",23)(1,"div",42)(2,"div",43)(3,"div",44)(4,"mat-icon",45),s(5,"celebration"),a()(),o(6,"div",14)(7,"h3",46),s(8),l(9,"transloco"),a(),o(10,"p",47),s(11),l(12,"transloco"),o(13,"strong",48),s(14),a(),s(15),l(16,"transloco"),a(),o(17,"p",49),s(18),l(19,"transloco"),a()()()(),o(20,"div",50)(21,"p",15),s(22),l(23,"transloco"),a(),o(24,"div",51)(25,"input",52),l(26,"transloco"),he("ngModelChange",function(i){E(e);let c=g();return pe(c.receiptEmail,i)||(c.receiptEmail=i),I(i)}),a(),o(27,"button",53),C("click",function(){E(e);let i=g();return I(i.sendReceipt())}),k(28,lt,5,3)(29,dt,2,3),a()()()()}if(t&2){let e=g();r(8),u(" ",d(9,10,"checkout.congratulations")," "),r(3),u(" ",d(12,12,"checkout.tagActive")," "),r(3),h(e.getFullTagName()),r(),u(" ",d(16,14,"checkout.isNowActive")," "),r(3),h(d(19,16,"checkout.enjoyBenefits")),r(4),h(d(23,18,"checkout.keepReceipt")),r(3),F("placeholder",d(26,20,"checkout.enterYourEmail")),me("ngModel",e.receiptEmail),r(2),F("disabled",e.isSendingReceipt()),r(),y(e.isSendingReceipt()?28:29)}}function pt(t,m){t&1&&(s(0),l(1,"transloco")),t&2&&u(" ",d(1,1,"checkout.coinbasePaymentUrl")," ")}function ht(t,m){t&1&&(s(0),l(1,"transloco")),t&2&&u(" ",d(1,1,"checkout.uniquePaymentAddress")," ")}function ut(t,m){if(t&1){let e=M();o(0,"button",55),C("click",function(){E(e);let i=g();return I(i.openCoinbaseLink())}),s(1),l(2,"transloco"),a()}t&2&&(r(),u(" \u2197 ",d(2,1,"checkout.openLink")," "))}function ft(t,m){if(t&1&&(o(0,"p",35),s(1),a()),t&2){let e=g();r(),u("$",e.price(),"")}}function gt(t,m){if(t&1&&(o(0,"p",35),s(1),a()),t&2){let e=g();r(),T("",e.amountToPay()," ",e.paymentMethod(),"")}}function xt(t,m){t&1&&(o(0,"span",37)(1,"mat-icon",56),s(2,"check_circle"),a(),s(3),l(4,"transloco"),a()),t&2&&(r(3),u(" ",d(4,1,"checkout.success")," "))}function _t(t,m){t&1&&(o(0,"span",38)(1,"span",54),s(2,"\u23F3"),a(),s(3),l(4,"transloco"),a()),t&2&&(r(3),u(" ",d(4,1,"checkout.checking")," "))}function kt(t,m){t&1&&(o(0,"span",39),s(1),l(2,"transloco"),a()),t&2&&(r(),u(" ",d(2,1,"checkout.pending")," "))}function yt(t,m){t&1&&(o(0,"p",40),s(1),l(2,"transloco"),a()),t&2&&(r(),h(d(2,1,"checkout.checkingPaymentStatus")))}function bt(t,m){t&1&&(o(0,"p",41),s(1),l(2,"transloco"),a()),t&2&&(r(),h(d(2,1,"checkout.paymentConfirmed")))}function vt(t,m){if(t&1&&(o(0,"p",57),s(1),a()),t&2){let e=g(2);r(),u("$",e.amountReceived(),"")}}function Ct(t,m){if(t&1&&(o(0,"p",57),s(1),a()),t&2){let e=g(2);r(),T("",e.amountReceived()," ",e.paymentMethod(),"")}}function St(t,m){if(t&1&&k(0,vt,2,1,"p",57)(1,Ct,2,2,"p",57),t&2){let e=g();y(e.paymentMethod()==="COINBASE"?0:1)}}function Pt(t,m){t&1&&(o(0,"p",35),s(1,"$0.00"),a())}function Et(t,m){if(t&1&&(o(0,"p",35),s(1),a()),t&2){let e=g(2);r(),u("0 ",e.paymentMethod(),"")}}function It(t,m){if(t&1&&k(0,Pt,2,0,"p",35)(1,Et,2,1,"p",35),t&2){let e=g();y(e.paymentMethod()==="COINBASE"?0:1)}}var mi=(()=>{class t{constructor(e,n,i,c,p,_,S,V){this.cdr=e,this.router=n,this.route=i,this.elementRef=c,this.snackBar=p,this.tagsService=_,this._fuseConfigService=S,this.sessionService=V,this.tagName=f(""),this.domain=f(""),this.duration=f(1),this.price=f(""),this.paymentMethod=f("ETH"),this.ethAddress=f(""),this.amountToPay=f(""),this.qrcodeUrl=f(""),this.coinbaseUrl=f(""),this.coinbaseExpiresAt=f(""),this.isCheckingPayment=f(!1),this.isPaymentConfirmed=f(!1),this.amountReceived=f(""),this.lastCheckTime=f(null),this.receiptEmail=f(""),this.isSendingReceipt=f(!1),this.isDarkMode=f(!1),this.qrCodeInstance=null,this.qrContainerEl=null,this.paymentCheckInterval=null,this.isCheckInProgress=!1,this._unsubscribeAll=new b}ngOnInit(){return A(this,null,function*(){yield this.sessionService.initializePaymentSession(),this.loadQueryParams(),this._fuseConfigService.config$.pipe(R(this._unsubscribeAll)).subscribe(e=>{let n=e.scheme==="dark"||e.scheme==="auto"&&window.matchMedia("(prefers-color-scheme: dark)").matches;this.isDarkMode.set(n),this.generateQRCode()})})}loadQueryParams(){this.route.queryParams.subscribe(e=>{this.tagName.set(e.tagname||""),this.domain.set(e.domain||""),this.duration.set(parseInt(e.duration,10)||1),this.price.set(e.price||""),this.paymentMethod.set(e.paymentMethod||"ETH"),this.ethAddress.set(e.ethAddress||""),this.amountToPay.set(e.amountToPay||""),this.coinbaseUrl.set(e.coinbaseUrl||""),this.coinbaseExpiresAt.set(e.coinbaseExpiresAt||""),this.generateQRCode(),this.startPaymentChecking(),this.cdr.markForCheck()})}startPaymentChecking(){this.paymentCheckInterval&&clearInterval(this.paymentCheckInterval),this.paymentCheckInterval=setInterval(()=>{this.checkPaymentStatus()},1e4),this.checkPaymentStatus()}checkPaymentStatus(){return A(this,null,function*(){if(this.isCheckInProgress){console.log("Payment check already in progress, skipping...");return}let e=localStorage.getItem("signedDataPrice");if(e){this.isCheckInProgress=!0,this.isCheckingPayment.set(!0),this.lastCheckTime.set(new Date);try{let n=this.getNetworkFromPaymentMethod(),i=yield this.tagsService.checkPaymentConfirmation({tagName:this.tagName(),domain:this.domain(),token:e,network:n});if(i&&i.data&&i.data.confirmed===!0){this.paymentCheckInterval&&(clearInterval(this.paymentCheckInterval),this.paymentCheckInterval=null),this.isPaymentConfirmed.set(!0);let c=i.data.amountReceived||i.data.paymentConfirmation?.amountReceived||"0";this.amountReceived.set(c),this.snackBar.open("Payment confirmed successfully!","Close",{duration:5e3})}}catch(n){console.error("Error checking payment status:",n)}finally{this.isCheckInProgress=!1,this.isCheckingPayment.set(!1),this.cdr.markForCheck()}}})}getNetworkFromPaymentMethod(){let e=this.paymentMethod();return e==="COINBASE"?"coinbase":e||"ETH"}ngOnDestroy(){this.paymentCheckInterval&&clearInterval(this.paymentCheckInterval),this._unsubscribeAll.next(),this._unsubscribeAll.complete()}generateQRCode(){return A(this,null,function*(){let e;if(this.paymentMethod()==="COINBASE"&&this.coinbaseUrl()?e=this.coinbaseUrl():e=this.ethAddress(),!e||(this.qrContainerEl||(this.qrContainerEl=this.elementRef.nativeElement.querySelector("#qrContainer")),!this.qrContainerEl))return;let{default:n}=yield import("./chunk-4WTU2G65.js");this.qrContainerEl&&(this.qrContainerEl.innerHTML=""),this.qrCodeInstance=new n({width:256,height:256,type:"svg",data:e,qrOptions:{errorCorrectionLevel:"M"},dotsOptions:{type:"dots",color:this.isDarkMode()?"#ffffff":"#111827"},cornersSquareOptions:{type:"extra-rounded",color:this.isDarkMode()?"#ffffff":"#111827"},cornersDotOptions:{type:"dot",color:this.isDarkMode()?"#ffffff":"#111827"},backgroundOptions:{color:"transparent"}}),this.qrCodeInstance.append(this.qrContainerEl)})}getFullTagName(){return`${this.tagName()}.${this.domain()}`.toUpperCase()}getDurationLabel(){let e=this.duration();return e===999?"Lifetime":e===1?"1 Year":`${e} Years`}getPriceInUSD(){let e=this.price();return typeof e=="number"?`$${e} USD`:`$${e} USD`}getPricingDocsUrl(){return(navigator?.language||"en").toLowerCase().startsWith("es")?"https://docs.zelf.world/docs-es/airdrop/precios-por-dominio":"https://docs.zelf.world/docs/airdrop/pricing-per-domain"}copyAddress(){let e=this.paymentMethod()==="COINBASE"&&this.coinbaseUrl()?this.coinbaseUrl():this.ethAddress();navigator.clipboard.writeText(e).then(()=>{this.snackBar.open("Address copied to clipboard","Close",{duration:2500})})}openCoinbaseLink(){this.paymentMethod()==="COINBASE"&&this.coinbaseUrl()&&window.open(this.coinbaseUrl(),"_blank","noopener,noreferrer")}getAddressToDisplay(){return this.paymentMethod()==="COINBASE"&&this.coinbaseUrl()?this.coinbaseUrl():this.ethAddress()}getExpirationDate(){if(this.paymentMethod()==="COINBASE"&&this.coinbaseExpiresAt()){let e=new Date(this.coinbaseExpiresAt()),n=new Date,i=e.getTime()-n.getTime(),c=Math.floor(i/6e4);if(c>0){let p=Math.floor(c/60),_=c%60;return p>0?`${p}h ${_}m`:`${c} minutes`}return"Expired"}return"30 minutes"}copyAmount(){let e=this.paymentMethod()==="COINBASE"?`$${this.price()}`:this.amountToPay();navigator.clipboard.writeText(e).then(()=>{this.snackBar.open("Amount copied to clipboard","Close",{duration:2500})})}goBack(){if(this.isPaymentConfirmed()){localStorage.removeItem("signedDataPrice");let e=`payment_options_${this.tagName()}_.${this.domain()}_${this.duration()}`;localStorage.removeItem(e),console.log("Deleted payment options from localStorage:",e),this.router.navigate(["/portfolio/payment"])}else this.router.navigate(["/portfolio/payment"],{queryParams:{tagname:this.tagName(),domain:this.domain(),duration:this.duration()}})}sendReceipt(){return A(this,null,function*(){let e=this.receiptEmail().trim();if(!e){this.snackBar.open("Please enter your email address","Close",{duration:3e3});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)){this.snackBar.open("Please enter a valid email address","Close",{duration:3e3});return}let i=localStorage.getItem("signedDataPrice");if(!i){this.snackBar.open("Payment data not found","Close",{duration:3e3});return}this.isSendingReceipt.set(!0);try{let c=this.getNetworkFromPaymentMethod(),p=yield this.tagsService.emailReceipt({tagName:this.tagName(),domain:this.domain(),email:e,token:i,network:c});p&&p.data&&(this.snackBar.open("Receipt sent successfully to your email!","Close",{duration:5e3}),this.receiptEmail.set(""))}catch(c){console.error("Error sending receipt:",c),this.snackBar.open("Failed to send receipt. Please try again later.","Close",{duration:5e3})}finally{this.isSendingReceipt.set(!1),this.cdr.markForCheck()}})}static{this.\u0275fac=function(n){return new(n||t)(v(U),v(xe),v(ge),v(N),v(J),v(qe),v(Re),v(Ve))}}static{this.\u0275cmp=w({type:t,selectors:[["portfolio-payment-checkout"]],decls:108,vars:69,consts:[[1,"w-full","p-6","sm:px-6","lg:px-8"],[1,"mb-6"],[1,"flex","items-center","gap-2","text-gray-600","dark:text-gray-400","hover:text-gray-900","dark:hover:text-gray-100","transition",3,"click"],[1,"text-lg"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-lg","p-8","border","border-gray-200","dark:border-gray-700"],[1,"text-2xl","font-bold","mb-6","text-gray-900","dark:text-gray-100"],[1,"text-xs","text-gray-500","dark:text-gray-400","mb-2"],[1,"text-4xl","font-bold","text-gray-900","dark:text-gray-100","mb-3"],[1,"text-sm","text-gray-600","dark:text-gray-300"],[1,"mb-6","pb-4","border-b","border-gray-200","dark:border-gray-700"],[1,"flex","items-center","gap-3","px-4","py-3","bg-gray-50","dark:bg-gray-700/50","rounded-lg"],[1,"flex-shrink-0","w-6","h-6","rounded-full","bg-blue-100","dark:bg-blue-900/30","flex","items-center","justify-center"],[1,"text-blue-600","dark:text-blue-400","text-xs"],[1,"flex-1"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300"],["target","_blank","rel","noopener noreferrer",1,"text-sm","text-blue-600","dark:text-blue-400","hover:underline",3,"href"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-900","dark:text-gray-100"],[1,"text-sm","font-bold","text-gray-900","dark:text-gray-100"],[1,"text-sm","text-gray-500","dark:text-gray-400","mb-2"],[1,"inline-block","px-4","py-2","bg-gray-100","dark:bg-gray-700","text-gray-700","dark:text-gray-300","text-sm","rounded-lg"],[1,"pt-4","border-t","border-gray-200","dark:border-gray-700"],[1,"space-y-6"],[1,"text-2xl","font-bold","mb-6","text-gray-900","dark:text-gray-100","text-center"],[1,"mb-6","flex","justify-center"],["id","qrContainer",1,"p-4","rounded-xl","border-2","border-gray-200","dark:border-gray-700","bg-gradient-to-b","from-white","to-gray-50","dark:from-gray-800","dark:to-gray-900"],[1,"space-y-4"],[1,"text-lg","font-semibold","mb-4","text-gray-900","dark:text-gray-100"],[1,"text-sm","text-gray-500","dark:text-gray-400","mb-2","flex","items-center","gap-2"],[1,"text-xs","bg-gray-100","dark:bg-gray-700","hover:bg-gray-200","dark:hover:bg-gray-600","px-2","py-1","rounded","transition",3,"click"],[1,"text-xs","bg-blue-100","dark:bg-blue-700","hover:bg-blue-200","dark:hover:bg-blue-600","text-blue-700","dark:text-blue-300","px-2","py-1","rounded","transition"],[1,"flex","items-center","gap-2","p-3","bg-gray-50","dark:bg-gray-700/50","rounded-lg"],[1,"text-xs","break-all","text-gray-900","dark:text-gray-100","flex-1"],[1,"p-3","bg-gray-50","dark:bg-gray-700/50","rounded-lg"],[1,"text-lg","font-bold","text-gray-900","dark:text-gray-100"],[1,"text-sm","text-gray-900","dark:text-gray-100"],[1,"inline-flex","px-3","py-1","bg-green-100","dark:bg-green-900","text-green-800","dark:text-green-300","text-sm","font-medium","rounded","items-center","gap-2"],[1,"inline-flex","px-3","py-1","bg-blue-100","dark:bg-blue-900","text-blue-800","dark:text-blue-300","text-sm","font-medium","rounded","items-center","gap-2"],[1,"inline-block","px-3","py-1","bg-yellow-100","dark:bg-yellow-900","text-yellow-800","dark:text-yellow-300","text-sm","font-medium","rounded"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1"],[1,"text-xs","text-green-600","dark:text-green-400","mt-1"],[1,"bg-gradient-to-br","from-green-50","to-emerald-50","dark:from-green-900/20","dark:to-emerald-900/20","rounded-lg","p-6","border","border-green-200","dark:border-green-800"],[1,"flex","items-start","gap-4"],[1,"flex-shrink-0","w-12","h-12","rounded-full","bg-green-100","dark:bg-green-900/30","flex","items-center","justify-center"],[1,"text-green-600","dark:text-green-400","text-2xl"],[1,"text-lg","font-bold","text-gray-900","dark:text-gray-100","mb-2"],[1,"text-sm","text-gray-700","dark:text-gray-300","mb-1"],[1,"uppercase"],[1,"text-xs","text-gray-600","dark:text-gray-400","italic"],[1,"space-y-3"],[1,"flex","gap-2"],["type","email",1,"flex-1","px-4","py-2","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-white","dark:bg-gray-700","text-gray-900","dark:text-gray-100","placeholder-gray-500","dark:placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500","dark:focus:ring-blue-400",3,"ngModelChange","placeholder","ngModel"],[1,"px-6","py-2","bg-blue-600","hover:bg-blue-700","dark:bg-blue-500","dark:hover:bg-blue-600","text-white","font-medium","rounded-lg","transition","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"click","disabled"],[1,"animate-spin"],[1,"text-xs","bg-blue-100","dark:bg-blue-700","hover:bg-blue-200","dark:hover:bg-blue-600","text-blue-700","dark:text-blue-300","px-2","py-1","rounded","transition",3,"click"],[1,"text-xs"],[1,"text-lg","font-bold","text-green-600","dark:text-green-400"]],template:function(n,i){if(n&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),C("click",function(){return i.goBack()}),o(3,"mat-icon",3),s(4,"arrow_back"),a(),o(5,"span"),s(6),l(7,"transloco"),a()()(),o(8,"div",4)(9,"div",5)(10,"h2",6),s(11),l(12,"transloco"),a(),o(13,"div",1)(14,"p",7),s(15),l(16,"transloco"),a(),o(17,"p",8),s(18),a(),o(19,"p",9),s(20),l(21,"transloco"),l(22,"transloco"),l(23,"transloco"),a()(),o(24,"div",10)(25,"div",11)(26,"div",12)(27,"mat-icon",13),s(28,"info"),a()(),o(29,"div",14)(30,"p",15),s(31),l(32,"transloco"),a()(),o(33,"a",16),s(34),l(35,"transloco"),a()()(),o(36,"div",10)(37,"div",17)(38,"span",18),s(39),l(40,"transloco"),a(),o(41,"span",19),s(42),a()()(),o(43,"div",1)(44,"p",20),s(45),l(46,"transloco"),a(),k(47,rt,2,1,"p",8)(48,st,2,2,"p",8),o(49,"div",21),s(50),a()(),o(51,"div",22),k(52,ct,6,4,"div",17)(53,mt,30,22,"div",23),a()(),o(54,"div",5)(55,"h2",24),s(56),l(57,"transloco"),a(),o(58,"div",25),L(59,"div",26),a(),o(60,"div",27)(61,"h3",28),s(62,"Payment details"),a(),o(63,"div")(64,"p",29),k(65,pt,2,3)(66,ht,2,3),o(67,"button",30),C("click",function(){return i.copyAddress()}),s(68),l(69,"transloco"),a(),k(70,ut,3,3,"button",31),a(),o(71,"div",32)(72,"code",33),s(73),a()()(),o(74,"div")(75,"p",29),s(76),l(77,"transloco"),o(78,"button",30),C("click",function(){return i.copyAmount()}),s(79),l(80,"transloco"),a()(),o(81,"div",34),k(82,ft,2,1,"p",35)(83,gt,2,2,"p",35),a()(),o(84,"div")(85,"p",20),s(86),l(87,"transloco"),a(),o(88,"div",34)(89,"p",36),s(90),a()()(),o(91,"div")(92,"p",20),s(93),l(94,"transloco"),a(),o(95,"div",34),k(96,xt,5,3,"span",37)(97,_t,5,3,"span",38)(98,kt,3,3,"span",39),a(),k(99,yt,3,3,"p",40)(100,bt,3,3,"p",41),a(),o(101,"div")(102,"p",20),s(103),l(104,"transloco"),a(),o(105,"div",34),k(106,St,2,1)(107,It,2,1),a()()()()()()),n&2){let c;r(6),h(d(7,35,"checkout.backToPaymentOptions")),r(5),h(d(12,37,"checkout.orderDetails")),r(4),h(d(16,39,"checkout.domainToPurchase")),r(3),h(i.getFullTagName()),r(2),de(" ",(c=i.tagName())==null?null:c.length," ",d(21,41,"checkout.charactersLength"),", ",i.getDurationLabel()," ",d(22,43,"checkout.lease"),", ",d(23,45,"checkout.totalCost")," ",i.getPriceInUSD()," "),r(11),h(d(32,47,"checkout.domainPriceLength")),r(2),F("href",i.getPricingDocsUrl(),ne),r(),h(d(35,49,"checkout.knowMore")),r(5),h(d(40,51,"checkout.leaseAgreement")),r(3),h(i.getDurationLabel()),r(3),h(d(46,53,"checkout.total")),r(2),y(i.paymentMethod()==="COINBASE"?47:48),r(3),u(" ",i.getPriceInUSD()," "),r(2),y(i.isPaymentConfirmed()?53:52),r(4),T(" ",d(57,55,"checkout.payWith")," ",i.paymentMethod()," "),r(9),y(i.paymentMethod()==="COINBASE"?65:66),r(3),u(" ",d(69,57,"checkout.copy")," "),r(2),y(i.paymentMethod()==="COINBASE"&&i.coinbaseUrl()?70:-1),r(3),h(i.getAddressToDisplay()),r(3),u(" ",d(77,59,"checkout.amountToPay")," "),r(3),u(" ",d(80,61,"checkout.copy")," "),r(3),y(i.paymentMethod()==="COINBASE"?82:83),r(4),h(d(87,63,"checkout.expiresIn")),r(4),h(i.getExpirationDate()),r(3),h(d(94,65,"checkout.transactionStatus")),r(3),y(i.isPaymentConfirmed()?96:i.isCheckingPayment()?97:98),r(3),y(i.isCheckingPayment()?99:i.isPaymentConfirmed()?100:-1),r(4),h(d(104,67,"checkout.amountDetected")),r(3),y(i.isPaymentConfirmed()&&i.amountReceived()?106:107)}},dependencies:[fe,Ue,je,Fe,Le,De,Te,He,Ne,Oe],encapsulation:2,changeDetection:0})}}return t})();export{mi as PortfolioPaymentCheckoutComponent};
