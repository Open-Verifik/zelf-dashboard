import{a as ee}from"./chunk-THNQFQI5.js";import{a as V,c as q}from"./chunk-3GYBXV36.js";import{b as Q,c as X}from"./chunk-35LKULUD.js";import{b as T,c as M,e as F,j as A,k as N}from"./chunk-7FNFDU6H.js";import{a as L}from"./chunk-Q6XQEBQC.js";import"./chunk-QGFQ6LQC.js";import{a as Z,b as $}from"./chunk-SG5SNBLM.js";import{a as J,d as K}from"./chunk-62GRJCFO.js";import{b as B,d as v,f as z,g as W,l as G,o as R,p as U,x as H,y as Y,z as O}from"./chunk-YTO5EUI3.js";import{ga as j,ha as D}from"./chunk-2TJ6ILEC.js";import{d as P}from"./chunk-GYFW3PAY.js";import{h as C,j as E,p as I}from"./chunk-CDEEPH4V.js";import{Ab as u,Cc as x,Ib as s,Nc as k,Tb as t,Ub as e,Vb as f,dc as h,fc as w,gb as o,hb as c,qc as i,rc as _,sc as p,ub as b}from"./chunk-6IDHI5WA.js";import"./chunk-TSRGIXR5.js";var te=(r,l)=>({"bg-green-100 text-green-800 border border-green-200":r,"bg-red-100 text-red-800 border border-red-200":l}),ie=(r,l)=>({"text-green-600":r,"text-red-600":l});function re(r,l){if(r&1&&(t(0,"div",43)(1,"div",13)(2,"mat-icon",44),i(3),e(),t(4,"span"),i(5),e()()()),r&2){let a=w();s("ngClass",x(4,te,a.alertType==="success",a.alertType==="error")),o(2),s("ngClass",x(7,ie,a.alertType==="success",a.alertType==="error")),o(),p(" ",a.alertType==="success"?"check_circle":"error"," "),o(2),_(a.alertMessage)}}function ne(r,l){r&1&&(t(0,"div",45),i(1,"No JWT token found in localStorage"),e())}function ae(r,l){if(r&1&&(t(0,"div",46),i(1),e()),r&2){let a=w();o(),p(" ",a.showJwt?a.jwtToken:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"," ")}}function oe(r,l){r&1&&(t(0,"mat-error"),i(1," New password is required "),e())}function se(r,l){r&1&&(t(0,"mat-error"),i(1," Password must be at least 8 characters long "),e())}function le(r,l){r&1&&(t(0,"mat-error"),i(1," Confirm password is required "),e())}function de(r,l){r&1&&(t(0,"mat-error"),i(1," Passwords do not match "),e())}function me(r,l){r&1&&f(0,"mat-spinner",47)}var Fe=(()=>{class r{constructor(a,d,n,m,g,y){this._formBuilder=a,this._httpWrapper=d,this._cdr=n,this._router=m,this._saveConfirmationService=g,this._translocoService=y,this.showAlert=!1,this.alertMessage="",this.alertType="success",this.isLoading=!1,this.isLoadingApiKey=!1,this.apiKey="",this.showApiKey=!1,this.jwtToken="",this.showJwt=!1}ngOnInit(){this.securityForm=this._formBuilder.group({newPassword:["",[v.required,v.minLength(8)]],confirmPassword:["",[v.required]]},{validators:this.passwordMatchValidator}),this.loadJwtToken(),this.loadApiKeyFromStorage()}ngAfterViewInit(){this.loadJwtToken(),this.loadApiKeyFromStorage()}passwordMatchValidator(a){let d=a.get("newPassword"),n=a.get("confirmPassword");return d&&n&&d.value!==n.value?(n.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):(n?.hasError("passwordMismatch")&&n.setErrors(null),null)}loadJwtToken(){this.jwtToken=localStorage.getItem("accessToken")||"",this._cdr.detectChanges()}loadApiKeyFromStorage(){this.apiKey=sessionStorage.getItem("apiKey")||"",this._cdr.detectChanges()}loadApiKey(){let a={operation:"loadApiKey",faceBase64:"",masterPassword:""};this._saveConfirmationService.setSaveData({domain:null,domainConfig:null,redirectUrl:"/settings/security",operation:{title:this._translocoService.translate("saving_operations.load_api_key.title"),description:this._translocoService.translate("saving_operations.load_api_key.description"),action:this._translocoService.translate("saving_operations.load_api_key.action"),itemName:this._translocoService.translate("saving_operations.load_api_key.itemName")},securityData:a}),this._router.navigate(["/save-confirmation"],{queryParams:{redirect:"/settings/security"}})}toggleApiKeyVisibility(){this.showApiKey=!this.showApiKey,this._cdr.detectChanges()}toggleJwtVisibility(){this.showJwt=!this.showJwt,this._cdr.detectChanges()}savePassword(){if(this.securityForm.invalid){this.showError("Please fill in all required fields correctly");return}let a=this.securityForm.value,d={newPassword:a.newPassword,confirmPassword:a.confirmPassword,operation:"changePassword",faceBase64:"",masterPassword:""};this._saveConfirmationService.setSaveData({domain:null,domainConfig:null,redirectUrl:"/settings/security",operation:{title:this._translocoService.translate("saving_operations.password_change.title"),description:this._translocoService.translate("saving_operations.password_change.description"),action:this._translocoService.translate("saving_operations.password_change.action"),itemName:this._translocoService.translate("saving_operations.password_change.itemName")},securityData:d}),this._router.navigate(["/save-confirmation"],{queryParams:{redirect:"/settings/security"}})}cancel(){this.securityForm.reset(),this.showAlert=!1,this._cdr.detectChanges()}showSuccess(a){this.alertMessage=a,this.alertType="success",this.showAlert=!0,setTimeout(()=>{this.showAlert=!1,this._cdr.detectChanges()},5e3),this._cdr.detectChanges()}showError(a){this.alertMessage=a,this.alertType="error",this.showAlert=!0,setTimeout(()=>{this.showAlert=!1,this._cdr.detectChanges()},5e3),this._cdr.detectChanges()}static{this.\u0275fac=function(d){return new(d||r)(c(H),c(L),c(k),c(P),c(ee),c(V))}}static{this.\u0275cmp=b({type:r,selectors:[["settings-security"]],decls:82,vars:21,consts:[[1,"w-full","max-w-6xl"],["class","mb-6 p-4 rounded-lg",3,"ngClass",4,"ngIf"],[3,"formGroup"],[1,"mb-8"],[1,"text-2xl","font-bold","text-gray-900","dark:text-white","mb-2"],[1,"text-gray-600","dark:text-gray-300"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-sm","border","border-gray-200","dark:border-gray-700","p-6","mb-6"],[1,"flex","items-center","mb-4"],[1,"text-blue-600","dark:text-blue-400","mr-2"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"space-y-4"],[1,"border","border-gray-200","dark:border-gray-600","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"flex","items-center"],[1,"text-purple-600","dark:text-purple-400","mr-2"],[1,"font-medium","text-gray-900","dark:text-white"],["type","button",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","dark:border-gray-600","text-sm","font-medium","rounded-md","text-gray-700","dark:text-gray-300","bg-white","dark:bg-gray-700","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],[1,"text-sm","mr-1"],[1,"mt-2"],["class","text-sm text-gray-500 dark:text-gray-400",4,"ngIf"],["class","font-mono text-sm bg-gray-100 dark:bg-gray-700 p-2 rounded border break-all",4,"ngIf"],[1,"text-sm","text-gray-600","dark:text-gray-300","mt-2"],[1,"text-orange-600","dark:text-orange-400","mr-2"],[1,"mb-4","p-4","bg-yellow-50","dark:bg-yellow-900/20","rounded-lg"],[1,"flex"],[1,"flex-shrink-0"],[1,"text-yellow-400"],[1,"ml-3"],[1,"text-sm","font-medium","text-yellow-800","dark:text-yellow-200"],[1,"mt-2","text-sm","text-yellow-700","dark:text-yellow-300"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"fuse-mat-emphasized-affix","w-full",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["type","password","matInput","",3,"formControlName"],[4,"ngIf"],[1,"mt-4","p-4","bg-blue-50","dark:bg-blue-900/20","rounded-lg"],[1,"text-blue-400"],[1,"text-sm","font-medium","text-blue-800","dark:text-blue-200"],[1,"mt-2","text-sm","text-blue-700","dark:text-blue-300"],[1,"flex","items-center","justify-end","space-x-4"],["mat-stroked-button","","type","button",3,"click","disabled"],["mat-flat-button","","type","button",3,"click","color","disabled"],["diameter","20","class","mr-2",4,"ngIf"],[1,"mb-6","p-4","rounded-lg",3,"ngClass"],[1,"mr-2",3,"ngClass"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"font-mono","text-sm","bg-gray-100","dark:bg-gray-700","p-2","rounded","border","break-all"],["diameter","20",1,"mr-2"]],template:function(d,n){if(d&1&&(t(0,"div",0),u(1,re,6,10,"div",1),t(2,"form",2)(3,"div",3)(4,"h1",4),i(5,"Security Settings"),e(),t(6,"p",5),i(7,"Manage your account security and authentication settings"),e()(),t(8,"div",6)(9,"div",7)(10,"mat-icon",8),i(11,"vpn_key"),e(),t(12,"h2",9),i(13,"API Keys & Tokens"),e()(),t(14,"div",10)(15,"div",11)(16,"div",12)(17,"div",13)(18,"mat-icon",14),i(19,"security"),e(),t(20,"h3",15),i(21,"JWT Token"),e()(),t(22,"button",16),h("click",function(){return n.toggleJwtVisibility()}),t(23,"mat-icon",17),i(24),e(),i(25),e()(),t(26,"div",18),u(27,ne,2,0,"div",19)(28,ae,2,1,"div",20),e(),t(29,"p",21),i(30," Your JWT token provides secure access to your account. It's automatically managed by the system. "),e()()()(),t(31,"div",6)(32,"div",7)(33,"mat-icon",22),i(34,"lock"),e(),t(35,"h2",9),i(36,"Change Password"),e()(),t(37,"div",23)(38,"div",24)(39,"div",25)(40,"mat-icon",26),i(41,"info"),e()(),t(42,"div",27)(43,"h3",28),i(44,"Password Change Policy"),e(),t(45,"div",29)(46,"p"),i(47,"You can only change your password once within 24 hours for security reasons."),e()()()()(),t(48,"div",30)(49,"div")(50,"mat-form-field",31)(51,"mat-label"),i(52,"New Password"),e(),f(53,"mat-icon",32)(54,"input",33),u(55,oe,2,0,"mat-error",34)(56,se,2,0,"mat-error",34),e()(),t(57,"div")(58,"mat-form-field",31)(59,"mat-label"),i(60,"Confirm Password"),e(),f(61,"mat-icon",32)(62,"input",33),u(63,le,2,0,"mat-error",34)(64,de,2,0,"mat-error",34),e()()(),t(65,"div",35)(66,"div",24)(67,"div",25)(68,"mat-icon",36),i(69,"info"),e()(),t(70,"div",27)(71,"h3",37),i(72,"Password Requirements"),e(),t(73,"div",38)(74,"p"),i(75,"Minimum 8 characters. Must include numbers, letters and special characters."),e()()()()()(),t(76,"div",39)(77,"button",40),h("click",function(){return n.cancel()}),i(78,"Cancel"),e(),t(79,"button",41),h("click",function(){return n.savePassword()}),u(80,me,1,0,"mat-spinner",42),i(81),e()()()()),d&2){let m,g,y,S;o(),s("ngIf",n.showAlert),o(),s("formGroup",n.securityForm),o(22),_(n.showJwt?"visibility_off":"visibility"),o(),p(" ",n.showJwt?"Hide":"Show"," "),o(2),s("ngIf",!n.jwtToken),o(),s("ngIf",n.jwtToken),o(22),s("subscriptSizing","dynamic"),o(3),s("svgIcon","heroicons_solid:key"),o(),s("formControlName","newPassword"),o(),s("ngIf",(m=n.securityForm.get("newPassword"))==null?null:m.hasError("required")),o(),s("ngIf",(g=n.securityForm.get("newPassword"))==null?null:g.hasError("minlength")),o(2),s("subscriptSizing","dynamic"),o(3),s("svgIcon","heroicons_solid:key"),o(),s("formControlName","confirmPassword"),o(),s("ngIf",(y=n.securityForm.get("confirmPassword"))==null?null:y.hasError("required")),o(),s("ngIf",(S=n.securityForm.get("confirmPassword"))==null?null:S.hasError("passwordMismatch")),o(13),s("disabled",n.isLoading),o(2),s("color","primary")("disabled",n.isLoading||n.securityForm.invalid),o(),s("ngIf",n.isLoading),o(),p(" ",n.isLoading?"Processing...":"Save Changes"," ")}},dependencies:[I,C,E,Y,G,B,z,W,O,R,U,N,A,T,M,F,D,j,X,Q,K,J,$,Z,q],encapsulation:2,changeDetection:0})}}return r})();export{Fe as SettingsSecurityComponent};
