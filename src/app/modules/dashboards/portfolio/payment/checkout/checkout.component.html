<div class="w-full px-4 sm:px-6 lg:px-8">
	<!-- Back Button -->
	<div class="mb-6">
		<button
			(click)="goBack()"
			class="flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition"
		>
			<mat-icon class="text-lg">arrow_back</mat-icon>
			<span>{{ "checkout.backToPaymentOptions" | transloco }}</span>
		</button>
	</div>

	<!-- Main Content -->
	<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
		<!-- Left Side: Order Details -->
		<div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 border border-gray-200 dark:border-gray-700">
			<h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100">{{ "checkout.orderDetails" | transloco }}</h2>

			<!-- {{ "checkout.domainToPurchase" | transloco }} -->
			<div class="mb-6">
				<p class="text-xs text-gray-500 dark:text-gray-400 mb-2">{{ "checkout.domainToPurchase" | transloco }}</p>
				<p class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-3">{{ getFullTagName() }}</p>
				<p class="text-sm text-gray-600 dark:text-gray-300">
					{{ tagName()?.length }} {{ "checkout.charactersLength" | transloco }}, {{ getDurationLabel() }}
					{{ "checkout.lease" | transloco }}, {{ "checkout.totalCost" | transloco }}
					{{ getPriceInUSD() }}
				</p>
			</div>

			<!-- Year/Duration Info Box -->
			<div class="mb-6 pb-4 border-b border-gray-200 dark:border-gray-700">
				<div class="flex items-center gap-3 px-4 py-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
					<div class="flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center">
						<mat-icon class="text-blue-600 dark:text-blue-400 text-xs">info</mat-icon>
					</div>
					<div class="flex-1">
						<p class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ "checkout.domainPriceLength" | transloco }}</p>
					</div>
					<a
						[href]="getPricingDocsUrl()"
						target="_blank"
						rel="noopener noreferrer"
						class="text-sm text-blue-600 dark:text-blue-400 hover:underline"
						>{{ "checkout.knowMore" | transloco }}</a
					>
				</div>
			</div>

			<!-- Year/Duration -->
			<div class="mb-6 pb-4 border-b border-gray-200 dark:border-gray-700">
				<div class="flex items-center justify-between">
					<span class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ "checkout.leaseAgreement" | transloco }}</span>
					<span class="text-sm font-bold text-gray-900 dark:text-gray-100">{{ getDurationLabel() }}</span>
				</div>
			</div>

			<!-- {{ "checkout.total" | transloco }} -->
			<div class="mb-6">
				<p class="text-sm text-gray-500 dark:text-gray-400 mb-2">{{ "checkout.total" | transloco }}</p>
				@if (paymentMethod() === "COINBASE") {
					<p class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-3">${{ price() }}</p>
				} @else {
					<p class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-3">{{ amountToPay() }} {{ paymentMethod() }}</p>
				}
				<div class="inline-block px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm rounded-lg">
					{{ getPriceInUSD() }}
				</div>
			</div>

			<!-- Purchase Rate or Success Message -->
			<div class="pt-4 border-t border-gray-200 dark:border-gray-700">
				@if (!isPaymentConfirmed()) {
					<div class="flex items-center justify-between">
						<span class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ "checkout.paymentMethod" | transloco }}</span>
						<span class="text-sm font-bold text-gray-900 dark:text-gray-100">{{ paymentMethod() }}</span>
					</div>
				} @else {
					<div class="space-y-6">
						<!-- Congratulations Message -->
						<div
							class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg p-6 border border-green-200 dark:border-green-800"
						>
							<div class="flex items-start gap-4">
								<div class="flex-shrink-0 w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center">
									<mat-icon class="text-green-600 dark:text-green-400 text-2xl">celebration</mat-icon>
								</div>
								<div class="flex-1">
									<h3 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2">
										{{ "checkout.congratulations" | transloco }}
									</h3>
									<p class="text-sm text-gray-700 dark:text-gray-300 mb-1">
										{{ "checkout.tagActive" | transloco }} <strong class="uppercase">{{ getFullTagName() }}</strong>
										{{ "checkout.isNowActive" | transloco }}
									</p>
									<p class="text-xs text-gray-600 dark:text-gray-400 italic">{{ "checkout.enjoyBenefits" | transloco }}</p>
								</div>
							</div>
						</div>

						<!-- Email Receipt Form -->
						<div class="space-y-3">
							<p class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ "checkout.keepReceipt" | transloco }}</p>
							<div class="flex gap-2">
								<input
									type="email"
									[placeholder]="'checkout.enterYourEmail' | transloco"
									[(ngModel)]="receiptEmail"
									class="flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400"
								/>
								<button
									(click)="sendReceipt()"
									[disabled]="isSendingReceipt()"
									class="px-6 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-medium rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
								>
									@if (isSendingReceipt()) {
										<span class="animate-spin">⏳</span>
										<span>{{ "checkout.sending" | transloco }}</span>
									} @else {
										{{ "checkout.sendReceipt" | transloco }}
									}
								</button>
							</div>
						</div>
					</div>
				}
			</div>
		</div>

		<!-- Right Side: Payment QR Code and Details -->
		<div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 border border-gray-200 dark:border-gray-700">
			<h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100 text-center">
				{{ "checkout.payWith" | transloco }} {{ paymentMethod() }}
			</h2>

			<!-- QR Code (Styled) -->
			<div class="mb-6 flex justify-center">
				<div
					id="qrContainer"
					class="p-4 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-gradient-to-b from-white to-gray-50 dark:from-gray-800 dark:to-gray-900"
				></div>
			</div>

			<!-- Payment Details -->
			<div class="space-y-4">
				<h3 class="text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100">Payment details</h3>

				<!-- {{ "checkout.uniquePaymentAddress" | transloco }} -->
				<div>
					<p class="text-sm text-gray-500 dark:text-gray-400 mb-2 flex items-center gap-2">
						@if (paymentMethod() === "COINBASE") {
							{{ "checkout.coinbasePaymentUrl" | transloco }}
						} @else {
							{{ "checkout.uniquePaymentAddress" | transloco }}
						}
						<button
							(click)="copyAddress()"
							class="text-xs bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 px-2 py-1 rounded transition"
						>
							{{ "checkout.copy" | transloco }}
						</button>
						@if (paymentMethod() === "COINBASE" && coinbaseUrl()) {
							<button
								(click)="openCoinbaseLink()"
								class="text-xs bg-blue-100 dark:bg-blue-700 hover:bg-blue-200 dark:hover:bg-blue-600 text-blue-700 dark:text-blue-300 px-2 py-1 rounded transition"
							>
								↗ {{ "checkout.openLink" | transloco }}
							</button>
						}
					</p>
					<div class="flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
						<code class="text-xs break-all text-gray-900 dark:text-gray-100 flex-1">{{ getAddressToDisplay() }}</code>
					</div>
				</div>

				<!-- {{ "checkout.amountToPay" | transloco }} -->
				<div>
					<p class="text-sm text-gray-500 dark:text-gray-400 mb-2 flex items-center gap-2">
						{{ "checkout.amountToPay" | transloco }}
						<button
							(click)="copyAmount()"
							class="text-xs bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 px-2 py-1 rounded transition"
						>
							{{ "checkout.copy" | transloco }}
						</button>
					</p>
					<div class="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
						@if (paymentMethod() === "COINBASE") {
							<p class="text-lg font-bold text-gray-900 dark:text-gray-100">${{ price() }}</p>
						} @else {
							<p class="text-lg font-bold text-gray-900 dark:text-gray-100">{{ amountToPay() }} {{ paymentMethod() }}</p>
						}
					</div>
				</div>

				<!-- {{ "checkout.expiresIn" | transloco }} -->
				<div>
					<p class="text-sm text-gray-500 dark:text-gray-400 mb-2">{{ "checkout.expiresIn" | transloco }}</p>
					<div class="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
						<p class="text-sm text-gray-900 dark:text-gray-100">{{ getExpirationDate() }}</p>
					</div>
				</div>

				<!-- {{ "checkout.transactionStatus" | transloco }} -->
				<div>
					<p class="text-sm text-gray-500 dark:text-gray-400 mb-2">{{ "checkout.transactionStatus" | transloco }}</p>
					<div class="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
						@if (isPaymentConfirmed()) {
							<span
								class="inline-flex px-3 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300 text-sm font-medium rounded items-center gap-2"
							>
								<mat-icon class="text-xs">check_circle</mat-icon>
								{{ "checkout.success" | transloco }}
							</span>
						} @else if (isCheckingPayment()) {
							<span
								class="inline-flex px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 text-sm font-medium rounded items-center gap-2"
							>
								<span class="animate-spin">⏳</span>
								{{ "checkout.checking" | transloco }}
							</span>
						} @else {
							<span
								class="inline-block px-3 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300 text-sm font-medium rounded"
							>
								{{ "checkout.pending" | transloco }}
							</span>
						}
					</div>
					@if (isCheckingPayment()) {
						<p class="text-xs text-gray-500 dark:text-gray-400 mt-1">{{ "checkout.checkingPaymentStatus" | transloco }}</p>
					} @else if (isPaymentConfirmed()) {
						<p class="text-xs text-green-600 dark:text-green-400 mt-1">{{ "checkout.paymentConfirmed" | transloco }}</p>
					}
				</div>

				<!-- {{ "checkout.amountDetected" | transloco }} -->
				<div>
					<p class="text-sm text-gray-500 dark:text-gray-400 mb-2">{{ "checkout.amountDetected" | transloco }}</p>
					<div class="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
						@if (isPaymentConfirmed() && amountReceived()) {
							@if (paymentMethod() === "COINBASE") {
								<p class="text-lg font-bold text-green-600 dark:text-green-400">${{ amountReceived() }}</p>
							} @else {
								<p class="text-lg font-bold text-green-600 dark:text-green-400">{{ amountReceived() }} {{ paymentMethod() }}</p>
							}
						} @else {
							@if (paymentMethod() === "COINBASE") {
								<p class="text-lg font-bold text-gray-900 dark:text-gray-100">$0.00</p>
							} @else {
								<p class="text-lg font-bold text-gray-900 dark:text-gray-100">0 {{ paymentMethod() }}</p>
							}
						}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
